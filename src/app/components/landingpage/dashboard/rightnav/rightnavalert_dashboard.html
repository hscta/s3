<!DOCTYPE html>

<style>
    .md-button{
        text-transform:capitalize;
    }
    .alert-md-content{height:590px;overflow-y:scroll;}
    .container-margin{margin-bottom: 0; padding:0; height:31px}

    .md-title {font-size:13px !important;}

    .panel-content{padding:4px 4px;}

    .ignition-on-bg {
        background:#2acc60 !important;
    }
    .ignition-off-bg {
        background:#6476a2 !important;
    }
</style>

<style>
    .sidenav {
        height: 100%;
        width: 0;
        position: fixed;
        z-index: 1;
        top: 0;
        right: 0;
        overflow-x: hidden;
        transition: 0.5s;
        padding-top: 60px;
    }

    #main {
        transition: margin-right .5s;
    }

    @media screen and (max-height: 450px) {
        .sidenav {padding-top: 15px;}
    }


    .sidenav .id-body {
        width:250px;
        /*transition: 0.3s*/
    }

</style>

<div id="mySidenav" class="sidenav">
    <div class="id-body" id="right_side_nav_content">
        <div class="row">
            <div class="col s12" style="padding:0;">
                <ul class="tabs">
                    <li class="tab col s3"><a class="active" href="#active">Active</a></li>
                    <li class="tab col s3"><a  href="#history">History</a></li>
                    <li class="tab col s3"><a href="#alarms">Alarms</a></li>
                </ul>
            </div>
            <div id="active" class="col s12">
                <span class="spinner -sp-blue -sp-big" ng-if="!vm.activeTabData"></span>
                <div class="expansionNav coolbar" style="top:110px;" ng-if="vm.activeTabData">
                    <!--first wrapper-->
                    <div class="en_main" ng-if="mainKey != 'active' && vm.navFilter(main)"
                         ng-class="{'active':main.active}"  ng-repeat="(mainKey, main) in vm.activeTabData " ng-init="main.active = true">
                        <div class="en_label " ng-class="{'{{main.class}}':true}"  ng-click="vm.itemClicked(main,1)" style="background:#4FC3F7 !important;">
                            {{mainKey}}
                            <div class="enl_item enl_add">
                                <i class="fa fa-plus" ng-if="!main.active"></i>
                                <i class="fa fa-minus" ng-if="main.active"></i>
                            </div>
                            <div class="enl_item enl_count">{{vm.returnLength(main,1)}}</div>
                        </div>
                        <!--middle wrapper-->
                        <div class="en-wrapper">
                            <div class="en_mid"  ng-repeat="(midKey, mid) in main " ng-if="midKey != 'active' && vm.navFilter(mid)"  ng-init="mid.active = true"
                                 ng-class="{'en-closed':!main.active}" style="height:{{vm.returnHeight(mid);}}">
                                <div class="en_label"  ng-click="vm.itemClicked(mid,2)" style="background:#B3E5FC!important; "  >
                                    {{midKey}}
                                    <div class="enl_item enl_add">
                                        <i class="fa fa-plus" ng-if="!mid.active"></i>
                                        <i class="fa fa-minus" ng-if="mid.active"></i>
                                    </div>
                                    <div class="enl_item enl_count">{{vm.returnLength(mid,2)}}</div>
                                </div>
                                <!--final wrapper-->
                                <div class="en-wrapper">
                                    <div class="en_last" ng-repeat="(carKey, car) in mid" ng-if="carKey != 'active' && vm.navFilter(car)"
                                         ng-class="{'active':car.active && mid.active,'en-closed':!mid.active, 'noExit':car.stillActive}">
                                        <div class="en_head"
                                             ng-click="vm.itemClicked(car,3); " ng-class="{'resolvedHeader':car.resolved}">
                                            {{carKey}}
                                            <!--<div class="enl_item enl_add">-->
                                            <!--<i class="fa fa-plus" ng-if="!car.active"></i>-->
                                            <!--<i class="fa fa-minus" ng-if="car.active"></i>-->
                                            <!--</div>-->
                                            <div class="enl_item enl_entry" ng-class="{'redBG':!car.triggerType,'greenBG':car.triggerType}">
                                                <i class="fa fa-arrow-down" class="" ng-if="car.triggerType"></i>
                                                <i class="fa fa-arrow-up" ng-if="!car.triggerType"></i>
                                            </div>
                                            <div class="enl_item enl_time"
                                                 ng-class="{ 'ignition-on-bg': vm.vehicleData[carKey].ignitionstatus==1 ,
                                                 'ignition-off-bg': vm.vehicleData[carKey].ignitionstatus==0  }"
                                            >{{ vm.getTimeDiff(car) }}</div>
                                        </div>
                                        <div class="en_body">
                                            <div class="enb_full" ng-if="car.triggerType">
                                                <i class="fa fa-arrow-down greenColor"></i> Entry : {{car.entry | date : 'd MMM, h:mm a'}}
                                            </div>
                                            <div class="enb_full" ng-if="!car.triggerType">
                                                <i class="fa fa-arrow-up redColor"></i> Exit : {{car.entry | date : 'd MMM, h:mm a'}}
                                            </div>
                                            <!--<div class="enb_full" ng-if="!car.stillActive">-->
                                            <!--<i class="fa fa-arrow-up redColor" ></i> Exit : {{car.exit | date : 'd MMM, h:mm a'}}-->
                                            <!--</div>-->
                                            <div class="enb_full">
                                                <textarea class="coolbar"placeholder="Put Your Message" ng-keydown="vm.resolutionKeyEvent($event,car)"></textarea>
                                                <div class="enb_button_list">
                                                    <button class="blueBG" ng-if="car.state != vm.SAVING" ng-click="vm.saveRep(car)"><i class="fa fa-save"></i></button>
                                                    <button class="greyBG"  ng-if="car.state == vm.SAVING" >
                                                        <span class="spinner"></span>
                                                    </button>
                                                    <button class="greenBG"  ng-if="!car.resolved && car.state != vm.RESOLVING" ng-click="vm.resolve(car)">
                                                        <i class="fa fa-check"></i>
                                                    </button>
                                                    <button class="redBG"  ng-if="car.resolved && car.state != vm.RESOLVING" ng-click="vm.resolve(car)">
                                                        <i class="fa fa-times"></i>
                                                    </button>
                                                    <button class="greyBG"  ng-if="car.state == vm.RESOLVING" >
                                                        <span class="spinner"></span>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="history" class="col s12">
                <div class="expansionNav coolbar" style="top:110px;" ng-if="vm.activeTabData">
                    <!--first wrapper-->
                    <div class="en_main" ng-if="vm.navFilter(main)"
                         ng-class="{'active':main.active}"  ng-repeat="main in vm.reports " ng-init="main.active = true">
                        <div class="en_label " ng-class="{'{{main.class}}':true}"  ng-click="vm.itemClicked(main,1)" style="background:#4FC3F7 !important;">
                            {{main.reportName}}
                            <div class="enl_item enl_add">
                                <i class="fa fa-plus" ng-if="!main.active"></i>
                                <i class="fa fa-minus" ng-if="main.active"></i>
                            </div>
                        </div>
                        <div class="en-wrapper">
                            <div ng-repeat="fence in main.fences" style="width: 100%;float:left">
                                <div class="en_mid"  ng-repeat="(midKey, mid) in fence" ng-if="midKey != 'id' && midKey != 'name' && midKey != 'active' && mid.length > 0"
                                     ng-class="{'en-closed':!main.active,'en-semi-closed':!mid.active}" style="height:{{(mid.length * 30) + 67}}px"
                                     ng-init="mid.active = true;">
                                    <div class="en_label"  ng-click="vm.itemClicked(mid,2)" style="background:#B3E5FC!important;">
                                        {{ midKey}}
                                        <div class="enl_item enl_add">
                                            <i class="fa fa-plus" ng-if="!mid.active"></i>
                                            <i class="fa fa-minus" ng-if="mid.active"></i>
                                        </div>
                                        <div class="enl_item enl_count">{{vm.returnLength(mid,2)}}</div>
                                    </div>
                                    <div class="en-wrapper">
                                        <table class="en_entryexit">
                                            <tr>
                                                <th><i class="fa fa-chevron-down greenColor"></i> Entry Time</th>
                                                <th><i class="fa fa-chevron-up redColor"></i> Exit Time</th>
                                            </tr>
                                            <tr ng-repeat="vehicle in mid">
                                                <td>{{vehicle.fentry | date : 'd MMM, h:mm a'}}</td>
                                                <td>{{vehicle.fexit | date : 'd MMM, h:mm a'}}</td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="alarms" class="col s12">
                <div class="expansionNav coolbar" style="top:110px;" ng-if="vm.activeAlarmData">
                    <!--first wrapper-->
                    <div class="en_main" ng-if="vm.navFilter(main)"
                         ng-class="{'active':main.active}"  ng-repeat="(mainKey, main)  in vm.activeAlarmData " ng-init="main.active = true">
                        <div class="en_label " ng-class="{'{{main.class}}':true}"  ng-click="vm.itemClicked(main,1)" style="background:#4FC3F7 !important;">
                            {{ mainKey | limitTo: 30 }}{{mainKey.length > 30 ? '...' : ''}}
                            <div class="enl_item enl_add">
                                <i class="fa fa-plus" ng-if="!main.active"></i>
                                <i class="fa fa-minus" ng-if="main.active"></i>
                            </div>
                        </div>
                        <div class="en-wrapper">
                            <div class="en_mid"  ng-repeat="(midKey, mid) in main" ng-if="midKey != 'id' && midKey != 'name' && midKey != 'active'"
                                 ng-class="{'en-closed':!main.active,'en-semi-closed':!mid.active}" style="height:110px">
                                <div class="en_label"  ng-click="vm.itemClicked(mid,2)" style="background:#B3E5FC!important;">
                                    {{ midKey }}
                                    <div class="enl_item enl_add">
                                        <i class="fa fa-plus" ng-if="!mid.active"></i>
                                        <i class="fa fa-minus" ng-if="mid.active"></i>
                                    </div>
                                    <!--<div class="enl_item enl_count">{{vm.returnLength(mid,2)}}</div>-->
                                </div>
                                <div class="en-alarm-final">
                                    <div class="en-af-item">Time : {{mid.timestamp | date : 'd MMM, h:mm a'}}</div>
                                    <div class="en-af-item">Mode : {{mid.opermode }}</div>
                                    <div class="en-af-item">Loc : {{mid.latitude }},{{mid.longitude }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<script>
    $(document).ready(function(){
        $('ul.tabs').tabs();
    });
</script>
