!function(){"use strict";angular.module("uiplatform",["ngAnimate","ngCookies","ngSanitize","ngMessages","ngAria","ngResource","ngMaterial","ui.bootstrap","ui.router","ui.tree","toastr","google.places","uiGmapgoogle-maps","material.components.expansionPanels","ui.tree-filter","angular-bind-html-compile","ct.ui.router.extras","datatables"])}(),function(){"use strict";angular.module("uiplatform").service("multiMapTestService",["$log","intellicarAPI","$q","$timeout",function(e,t,n,a){e.log("multiMapTestService");var i=this,o=12.9176383,r=77.6480335;i.center={latitude:o,longitude:r},i.zoom=12,i.bounds={},i.marker={id:0,coords:{latitude:o,longitude:r},options:{draggable:!0},events:{dragend:function(t,n,a){e.log("marker dragend");var o=t.getPosition().lat(),r=t.getPosition().lng();e.log(o),e.log(r),i.marker.options={draggable:!0,labelContent:"lat: "+i.marker.coords.latitude+" lon: "+i.marker.coords.longitude,labelAnchor:"100 0",labelClass:"marker-labels"}}}},i.getCenter=function(){return i.center},i.getZoom=function(){return i.zoom},i.getMarker=function(){return i.marker},i.getBounds=function(){return i.bounds},i.updateCenter=function(){i.center={latitude:i.marker.coords.latitude,longitude:i.marker.coords.longitude},a(i.updateCenter,1e3)},i.updateZoom=function(){12==i.zoom?i.zoom=14:i.zoom=12,a(i.updateZoom,5e3)},i.updateMarker=function(){i.marker.coords={latitude:i.marker.coords.latitude+.001,longitude:i.marker.coords.longitude+.001},a(i.updateMarker,1e3)},i.updateMarker(),i.updateCenter(),i.updateZoom()}])}(),function(){function e(e,t,n,a,i){n.log("MultiMapTestController");var o=this;o.loadMap=function(){o.inMap={},o.inMap.zoom=a.getZoom(),o.inMap.center=a.getCenter(),o.inMap.bounds=a.getBounds(),o.marker=a.getMarker()},o.updateZoom=function(){o.inMap.zoom=a.getZoom(),i(o.updateZoom,4e3)},o.options={};var r=function(e,t,n){var a=t.southwest.latitude,i=t.northeast.latitude-a,o=t.southwest.longitude,r=t.northeast.longitude-o;null==n&&(n="id");var s=a+Math.random()*i,l=o+Math.random()*r,c={latitude:s,longitude:l,title:"m"+e};return c[n]=e,c};o.randomMarkers=[],e.$watch(function(){return o.inMap.bounds},function(e,t){if(!t.southwest&&e.southwest){for(var n=[],a=0;50>a;a++)n.push(r(a,o.inMap.bounds));o.randomMarkers=n}},!0),o.loadMap()}e.$inject=["$scope","$rootScope","$log","multiMapTestService","$timeout"],angular.module("uiplatform").controller("MultiMapTestController",e)}(),function(){"use strict";angular.module("uiplatform").service("mapTestService",["$log","intellicarAPI","$q","$timeout",function(e,t,n,a){e.log("mapTestService");var i=this,o=12.9176383,r=77.6480335;i.center={latitude:o,longitude:r},i.zoom=12,i.marker={id:0,coords:{latitude:o,longitude:r},options:{draggable:!0},events:{dragend:function(t){e.log("marker dragend");var n=t.getPosition().lat(),a=t.getPosition().lng();e.log(n),e.log(a),i.marker.options={draggable:!0,labelContent:"lat: "+i.marker.coords.latitude+" lon: "+i.marker.coords.longitude,labelAnchor:"100 0",labelClass:"marker-labels"}}}},i.getCenter=function(){return i.center},i.getZoom=function(){return i.zoom},i.getMarker=function(){return i.marker},i.updateCenter=function(){i.center={latitude:i.marker.coords.latitude,longitude:i.marker.coords.longitude},a(i.updateCenter,1e3)},i.updateZoom=function(){12==i.zoom?i.zoom=14:i.zoom=12,a(i.updateZoom,5e3)},i.updateMarker=function(){i.marker.coords={latitude:i.marker.coords.latitude+.001,longitude:i.marker.coords.longitude+.001},a(i.updateMarker,1e3)},i.updateMarker(),i.updateCenter(),i.updateZoom()}])}(),function(){function e(e,t,n,a,i){n.log("MapTestController");var o=this;o.loadMap=function(){o.inMap={},o.inMap.zoom=a.getZoom(),o.inMap.center=a.getCenter(),o.marker=a.getMarker()},o.updateZoom=function(){o.inMap.zoom=a.getZoom(),i(o.updateZoom,4e3)},o.loadMap(),o.updateZoom()}e.$inject=["$scope","$rootScope","$log","mapTestService","$timeout"],angular.module("uiplatform").controller("MapTestController",e)}(),function(){"use strict";function e(e,t,n,a,i){var o=this;o.startupData=null,t.log("vehicleMgmtService"),o.handleGetMyVehicles=function(e){return t.log(e),o.startupData=e,o.startupData},o.handleGetMyVehiclesFailure=function(){},o.getData=function(e){return t.log("vehicle getData"),t.log(e),a.groupService.getMyVehiclesMap(i.getCurrentGroup()).then(o.handleGetMyVehicles,o.handleGetMyVehiclesFailure)}}e.$inject=["$rootScope","$log","$q","intellicarAPI","settingsService"],angular.module("uiplatform").service("vehicleMgmtService",e)}(),function(){function e(e,t,n,a,i,o){n.log("VehicleMgmtController"),i.setTab(a.appConstants.VEHICLE);var r=this;r.assets=[],r.groupBtnStatus=!1,r.isdiplay=!1,r.showBtn=!1,r.currentGroupAsset=i.lastGroup,r.handleStartupData=function(e){n.log(e),r.assets=[];for(var t in e)r.assets.push(e[t]);i.getCurrentGroupPath()&&(r.showBtn=!0)},r.handleStartupDataFailure=function(e){n.log(e)},r.init=function(e){o.getData(i.getCurrentGroup()).then(r.handleStartupData,r.handleStartupDataFailure)},r.showNewVehicleField=function(){n.log("show/hide"),r.isdiplay=!r.isdiplay,r.msg=""},i.getCurrentGroup()&&(r.assets=[],r.init())}e.$inject=["$scope","$rootScope","$log","intellicarAPI","settingsService","vehicleMgmtService"],angular.module("uiplatform").controller("VehicleMgmtController",e)}(),function(){"use strict";function e(e,t,n,a,i,o){var r=this;t.log("userMgmtService"),r.handleResponse=function(e){return t.log("userMgmtService handleResponse"),n.resolve(e)},r.handleFailure=function(e){return t.log("userMgmtService handleFailure"),n.reject(e)},r.getData=function(e){return t.log("user getData"),o.setCurrentGroup(e),i.groupService.getMyUsersMap(o.getCurrentGroup())},r.createUser=function(e){var t={pgrouppath:o.getCurrentGroupPath(),name:e.name,usermeta:{password:e.password}};return i.userService.createUser(t)}}e.$inject=["$rootScope","$log","$q","$state","intellicarAPI","settingsService"],angular.module("uiplatform").service("userMgmtService",e)}(),function(){function e(e,t,n,a,i,o,r,s,l){n.log("UserMgmtController"),r.setTab(i.appConstants.USER);var c=this;c.assets=[],c.newUser={},c.groupBtnStatus=!1,c.isdiplay=!1,c.showBtn=!1,c.currentGroupAsset=r.lastGroup,c.ASSIGN_GROUP_PERM=10,c.ASSIGN_ROLE_PERM=5,e.groupData={heading:"",options:{width:70,height:70},datas:[{heading:"",list:[],buttons:[{iconType:"fa",icon:"trash",color:"#e74c3c",fColor:"#fff",onClick:function(e,t){t(e,function(t){n.log("deasssign"),n.log(e),t(1)})}}]},{heading:"",list:[],buttons:[{iconType:"fa",icon:"plus",color:"#2ecc71",fColor:"#fff",onClick:function(e,t){t(e,function(t){n.log("Asssign"),n.log(e);var a=e.item.assetpath,i={grouppath:c.selectedGrouppath,userpath:a};n.log(i),t(-1)})}}]}]},c.init=function(){c.assets=[];for(var e in s)c.assets.push(s[e]);n.log(c.assets),r.getCurrentGroupPath()&&(c.showBtn=!0);for(var t in s)s[t].permissions.indexOf(c.ASSIGN_GROUP_PERM)>=0?s[t].assignGroup=!0:s[t].assignGroup=!1,s[t].permissions.indexOf(c.ASSIGN_ROLE_PERM)>=0?s[t].assignRole=!0:s[t].assignRole=!1;c.currentGroupAsset&&(0!=c.currentGroupAsset.permissions.indexOf(c.ASSIGN_GROUP_PERM)&&(c.currentGroupAsset.assignGroup=!0),0!=c.currentGroupAsset.permissions.indexOf(c.ASSIGN_ROLE_PERM)&&(c.currentGroupAsset.assignRole=!0)),n.log(s)},c.createUser=function(){return c.newUser.password!==c.confirmPassword?void(c.errorMsg="Passwords do not match"):void o.createUser(c.newUser).then(function(e){n.log(e),c.newUser={},c.confirmPassword="",t.$broadcast("EVENT_MGMT_TREE_CHANGE",{}),c.errorMsg="User created successfully."},function(e){n.log("CREATE USER FAILED"),n.log(e),c.errorMsg="Failed to create user."})},c.showNewUserField=function(){n.log("show/hide"),c.errorMsg="",c.isdiplay=!c.isdiplay},c.assignGroups=function(t){n.log(t),e.groupData.heading="Assign Groups to Users";var a={grouppath:t.assetpath};c.getUsers(a)},c.getUsers=function(t){e.groupData.datas[1].heading="Assignable Groups",e.groupData.datas[0].heading="Assigned Groups";var n=i.userService.getMyUsersMapList({}),a=i.groupService.getMyUsersMapList(t);return l.all([n,a]).then(c.handleUsersResponse,c.handleFailure)},c.handleUsersResponse=function(e){n.log(e),c.setData(e,c.ASSIGN_USER_PERM)},c.assignRoles=function(t){n.log(t),e.groupData.heading="Assign Roles to "+t.name,c.selectedGrouppath=t.assetpath;var a={grouppath:t.assetpath};e.groupData.datas[1].buttons=[{iconType:"fa",icon:"plus",color:"#2ecc71",fColor:"#fff",onClick:function(e,t){t(e,function(t){n.log("Asssign Role"),n.log(e);var a=e.item.assetpath;({grouppath:c.selectedGrouppath,userpath:a});t(-1)})}}],c.getRoles(a)},c.getRoles=function(e){var t=i.userService.getMyRolesList({}),n=i.groupService.getMyRolesList(e);return l.all([t,n]).then(c.handleRolesResponse,c.handleFailure)},c.handleRolesResponse=function(t){c.setData(t,c.ASSIGN_ROLE_PERM),e.groupData.datas[1].heading="Assignable Roles",e.groupData.datas[0].heading="Assigned Roles"},c.setData=function(t,a){e.groupData.datas[0].list=[],e.groupData.datas[1].list=[],e.groupData.datas[0].list=t[1];var i=(t[1],!1);for(var o in t[0]){for(var r in t[1]){if(t[0][o].assetpath==t[1][r].assetpath){i=!0;break}i=!1}i||t[0][o].permissions.indexOf(a)>=0&&e.groupData.datas[1].list.push(t[0][o])}n.log(e.groupData.datas),e.groupData.visible=!0},c.init()}e.$inject=["$scope","$rootScope","$log","$state","intellicarAPI","userMgmtService","settingsService","startupData","$q"],angular.module("uiplatform").controller("UserMgmtController",e)}(),function(){"use strict";function e(e,t,n){e.log("settingsService");var a=this;a.setTabListener=null,a.currentGroup=null,a.tabs=[n.appConstants.VEHICLE,n.appConstants.GROUP,n.appConstants.USER,n.appConstants.ROLE,n.appConstants.DEVICE],a.getTabIndex=function(e){var t=a.tabs.indexOf(e);return-1==t?0:t},a.setTab=function(e){a.setTabListener(a.getTabIndex(e))},a.addSetTabListener=function(e){a.setTabListener=e},a.setCurrentGroupPath=function(e){a.currentGroup={grouppath:e}},a.setCurrentGroup=function(e){var t=null;null!=e&&null!=e.info&&(t=e.info.ui_asset_type==n.appConstants.GROUP?e.info.assetpath:e.info.pgrouppath),a.currentGroup={grouppath:t}},a.getCurrentGroup=function(){return a.currentGroup},a.getRequestedGroupPath=function(e){var t=null;return null!=e&&null!=e.info&&(t=e.info.ui_asset_type==n.appConstants.GROUP?e.info.assetpath:e.info.pgrouppath),t},a.getCurrentGroupPath=function(){return a.currentGroup&&"grouppath"in a.currentGroup?a.currentGroup.grouppath:null},a.handleAssetClick=function(i){var o="group";o=-1!=a.tabs.indexOf(i.id)?i.id:i.info.ui_asset_type;var r=n.stateService.STATE_HOME_MANAGEMENT_DOT+o;-1==a.tabs.indexOf(i.id)?t.go(r,i):e.log("Not changing state")}}e.$inject=["$log","$state","intellicarAPI"],angular.module("uiplatform").service("settingsService",e)}(),function(){function e(e,t,n,a,i,o){n.log("SettingsController");var r=this;r.tabs=i.tabs,r.getTabState=function(e){return o.stateService.STATE_HOME_MANAGEMENT_DOT+e},t.$on("$stateChangeStart",function(e,t,i,s,l,c){n.log(i);var d=o.stateService.getStateTree(t.name).leaf;if(d!=o.appConstants.GROUP||"tabClick"in i){for(var m in r.tabs)if(d==r.tabs[m]){r.selectedTab=m;break}}else if(!("tabClick"in i)&&r.tabs[r.selectedTab]!=o.appConstants.GROUP){var p=o.stateService.getStateTree(t.name).parent+o.stateService.dotState(r.tabs[r.selectedTab]);e.preventDefault(),a.go(p,i)}}),r.tabClick=function(e){var t=i.getCurrentGroup();if(null!=t){n.log(t);var o={info:{pgrouppath:t.grouppath,assetpath:t.grouppath,ui_asset_type:e,tabClick:!0,permissions:[]}};a.go(r.getTabState(e),o)}},r.setTab=function(e){r.selectedTab=e},r.init=function(){i.addSetTabListener(r.setTab)},r.init()}e.$inject=["$scope","$rootScope","$log","$state","settingsService","intellicarAPI"],angular.module("uiplatform").controller("SettingsController",e)}(),function(){"use strict";function e(e,t,n,a,i,o){var r=this;t.log("groupMgmtService"),r.getData=function(e){return t.log("group getData"),o.setCurrentGroup(e),i.groupService.getMyGroupsMap(o.getCurrentGroup())},r.createGroup=function(e){var t={pgrouppath:o.getCurrentGroupPath(),name:e.name};return i.groupService.createGroup(t)}}e.$inject=["$rootScope","$log","$q","$state","intellicarAPI","settingsService"],angular.module("uiplatform").service("groupMgmtService",e)}(),function(){function e(e,t,n,a,i,o,r,s,l,c){n.log("GroupMgmtController"),r.setTab(a.appConstants.GROUP);var d=this;d.assets=[],d.newGroup={},d.groupBtnStatus=!1,d.isdiplay=!1,d.showBtn=!1,d.ASSIGN_USER_PERM=10,d.ASSIGN_ROLE_PERM=5,d.currentGroupAsset=r.lastGroup,d.handleMyVehiclesFailure=function(e){n.log("GroupMgmtController handleMyVehiclesFailure")},d.handleFailure=function(e){n.log("handleFailure"),n.log(e)},d.createGroup=function(){d.groupBtnStatus=!0,i.createGroup(d.newGroup).then(function(e){n.log(e),d.newGroup={},t.$broadcast("EVENT_MGMT_TREE_CHANGE",{}),d.groupBtnStatus=!1,d.msg="Group created Successfully.",i.getData(c).then(function(e){d.panelData(e)})},function(e){n.log("CREATE GROUP FAILED"),n.log(e),d.groupBtnStatus=!1,d.msg="Failed to create group."})},d.showNewGroupField=function(){n.log("show/hide"),d.isdiplay=!d.isdiplay,d.msg=""},e.groupData={heading:"Add User to the Group",options:{width:70,height:70},datas:[{heading:"Assigned Users",list:[],buttons:[{iconType:"fa",icon:"trash",color:"#e74c3c",fColor:"#fff",onClick:function(e,t){t(e,function(t){n.log("deasssign"),n.log(e),o(function(){t(1)},1e3)})}}]},{heading:"Assignable Users",list:[],buttons:[{iconType:"fa",icon:"plus",color:"#2ecc71",fColor:"#fff",onClick:function(e,t){t(e,function(t){n.log("Asssign"),n.log(e);var a=e.item.assetpath,i={grouppath:d.selectedGrouppath,userpath:a};n.log(i),o(function(){t(-1)},1e3)})}}]}]},d.assignUserSuccess=function(e){n.log(e)},d.assignUsers=function(t){n.log(t),e.groupData.heading="Add Users to the "+t.name+" group",d.selectedGrouppath=t.assetpath,e.groupData.datas[1].heading="Assignable Users",e.groupData.datas[0].heading="Assigned Users",e.groupData.datas[0].list=[],e.groupData.datas[1].list=[],e.groupData.visible=!0;var a={grouppath:t.assetpath};d.getUsers(a)},d.assignRoles=function(t){n.log(t),e.groupData.heading="Add Roles to the "+t.name+" group",d.selectedGrouppath=t.assetpath,e.groupData.datas[0].buttons=[{iconType:"fa",icon:"trash",color:"#e74c3c",fColor:"#fff",onClick:function(e,t){t(e,function(t){var n=e.item.assetpath,i={grouppath:d.selectedGrouppath,rolepath:n};a.groupService.deAssignRole(i).then(d.deAssignRoleSuccess,d.handleFailure),d.processGui=t(-1)})}}],e.groupData.datas[1].buttons=[{iconType:"fa",icon:"plus",color:"#2ecc71",fColor:"#fff",onClick:function(e,t){t(e,function(t){n.log("Asssign Role"),n.log(e);var i=e.item.assetpath,o={grouppath:d.selectedGrouppath,rolepath:i};a.groupService.assignRole(o).then(d.assignRoleSuccess,d.handleFailure),d.processGui=t(-1),n.log(o)})}}],e.groupData.datas[1].heading="Assignable Roles",e.groupData.datas[0].heading="Assigned Roles",e.groupData.datas[0].list=[],e.groupData.datas[1].list=[],e.groupData.visible=!0;var i={grouppath:t.assetpath};d.getRoles(i)},d.deAssignRoleSuccess=function(e){n.log(e),d.processGui},d.assignRoleSuccess=function(e){n.log(e),d.processGui},d.getUsers=function(e){var t=a.userService.getMyUsersMapList({}),n=a.groupService.getAssignedUsersMapList(e);return l.all([t,n]).then(d.handleUsersResponse,d.handleFailure)},d.handleUsersResponse=function(e){n.log(e),d.setData(e,d.ASSIGN_USER_PERM)},d.getRoles=function(e){var t=a.userService.getMyRolesList({}),n=a.groupService.getAssignedRolesList(e);return l.all([t,n]).then(d.handleRolesResponse,d.handleFailure)},d.handleRolesResponse=function(e){d.setData(e,d.ASSIGN_ROLE_PERM)},d.setData=function(t,a){e.groupData.datas[0].list=t[1];var i=(t[1],!1);for(var o in t[0]){for(var r in t[1]){if(t[0][o].assetpath==t[1][r].assetpath){i=!0;break}i=!1}i||t[0][o].permissions.indexOf(a)>=0&&e.groupData.datas[1].list.push(t[0][o])}n.log(e.groupData.datas)},d.panelData=function(e){d.assets=[];for(var t in e)d.assets.push(e[t]);r.getCurrentGroupPath()&&(d.showBtn=!0)},d.init=function(){n.log(s);for(var e in s)s[e].assignUser=!1,-1!=s[e].permissions.indexOf(d.ASSIGN_USER_PERM)&&(s[e].assignUser=!0),s[e].assignRole=!1,-1!=s[e].permissions.indexOf(d.ASSIGN_ROLE_PERM)&&(s[e].assignRole=!0);d.panelData(s),n.log(c),d.currentGroupAsset&&(0!=d.currentGroupAsset.permissions.indexOf(d.ASSIGN_USER_PERM)&&(d.currentGroupAsset.assignUser=!0),0!=d.currentGroupAsset.permissions.indexOf(d.ASSIGN_ROLE_PERM)&&(d.currentGroupAsset.assignRole=!0))},d.init()}e.$inject=["$scope","$rootScope","$log","intellicarAPI","groupMgmtService","$timeout","settingsService","startupData","$q","$stateParams"],angular.module("uiplatform").controller("GroupMgmtController",e)}(),function(){"use strict";function e(e,t,n,a,i,o){var r=this;t.log("roleMgmtService"),r.getData=function(e){return t.log("role getData"),o.setCurrentGroup(e),i.groupService.getMyRolesMap(o.getCurrentGroup())}}e.$inject=["$rootScope","$log","$q","$state","intellicarAPI","settingsService"],angular.module("uiplatform").service("roleMgmtService",e)}(),function(){function e(e,t,n,a,i,o,r,s,l,c){n.log("RoleMgmtController"),o.setTab(i.appConstants.ROLE);var d=this;d.assets=[],d.groupBtnStatus=!1,d.isdiplay=!1,d.showBtn=!1,d.currentGroupAsset=o.lastGroup,d.ASSIGN_PERMISSION=12,d.assignPermissionSuccess=function(e){n.log(e)},d.showNewRoleField=function(){n.log("show/hide"),d.isdiplay=!d.isdiplay},d.addPermission=function(e){var t={grouppath:"/1/1"},a=i.treeDataService.getManagementTree(t);n.log(a),d.selectedGrouppath=e.assetpath;var t={grouppath:e.assetpath};d.getPermissions(t)},d.getPermissions=function(e){var t=i.permissionService.permissionMap({}),n=i.permissionService.permissionMap({});return a.all([t,n]).then(d.handleUsersResponse,d.handleFailure)},d.handleUsersResponse=function(e){n.log(e),d.setData(e,d.ASSIGN_PERMISSION)},d.setData=function(e,t){},d.createRole=function(){n.log(d.currentGroupAsset),name=d.newRoleName,pgrouppath=d.currentGroupAsset.assetpath;var e={name:name,pgrouppath:pgrouppath};i.roleService.createRole(e).then(d.createRoleSuccess,d.handleFailure)},d.createRoleSuccess=function(e){n.log(e)},d.init=function(){d.assets=[];for(var e in r)r[e].permissions.indexOf(d.ASSIGN_PERMISSION)>=0?r[e].assignPermission=!0:r[e].assignPermission=!1,d.assets.push(r[e]);o.getCurrentGroupPath()&&(d.showBtn=!0),d.currentGroupAsset&&(0!=d.currentGroupAsset.permissions.indexOf(d.ASSIGN_USER_PERM)&&(d.currentGroupAsset.assignUser=!0),0!=d.currentGroupAsset.permissions.indexOf(d.ASSIGN_ROLE_PERM)&&(d.currentGroupAsset.assignRole=!0))},d.init()}e.$inject=["$scope","$rootScope","$log","$q","intellicarAPI","settingsService","startupData","roleMgmtService","permissionService","$mdDialog"],angular.module("uiplatform").controller("RoleMgmtController",e)}(),function(){"use strict";function e(e,t,n,a,i,o){var r=this;t.log("deviceMgmtService"),r.handleResponse=function(e){"device response";t.log(e)},r.handleFailure=function(e){"device failure response";t.log(e)},r.getData=function(e){return t.log("device getData"),o.setCurrentGroup(e),i.groupService.getMyDevicesMap(o.getCurrentGroup())}}e.$inject=["$rootScope","$log","$q","$state","intellicarAPI","settingsService"],angular.module("uiplatform").service("deviceMgmtService",e)}(),function(){function e(e,t,n,a,i){t.log("DeviceMgmtController"),i.setTab(a.appConstants.DEVICE);var o=this;o.assets=[],o.groupBtnStatus=!1,o.isdiplay=!1,o.showBtn=!1,o.currentGroupAsset=i.lastGroup,o.handleStartupData=function(e){t.log(e)},o.handleStartupDataFailure=function(e){t.log(e)},o.onLoad=function(){t.log(n),o.assets=[];for(var e in n)o.assets.push(n[e]);t.log(o.assets),i.getCurrentGroupPath()&&(o.showBtn=!0)},o.showNewDeviceField=function(){t.log("show/hide"),o.isdiplay=!o.isdiplay,o.msg=""},o.onLoad()}e.$inject=["$scope","$log","startupData","intellicarAPI","settingsService"],angular.module("uiplatform").controller("DeviceMgmtController",e)}(),function(){"use strict";function e(e,t,n,a,i,o){t.log("startupService")}e.$inject=["$rootScope","$log","$q","$state","intellicarAPI","settingsService"],angular.module("uiplatform").service("startupService",e)}(),function(){function e(e,t,n,a){e.log("rightNavMgmtService");var i=this;i.init=function(){},i.init()}e.$inject=["$log","$timeout","intellicarAPI","$q"],angular.module("uiplatform").service("rightNavMgmtService",e)}(),function(){function e(e,t,n,a,i,o){e.log("RightNavMgmtController");var r=this;r.init=function(){},r.toggleRightSidebar=function(t,n){e.log("dashboard right nav "),n.right_nav_toggle?(document.getElementById("mySidenav").style.width="320px",document.getElementById("main").style.marginRight="320px"):(document.getElementById("mySidenav").style.width="0",document.getElementById("main").style.marginRight="0")},t.$on("toggleRightSidebar",r.toggleRightSidebar),r.init()}e.$inject=["$log","$scope","$timeout","rightNavMgmtService","intellicarAPI","$q"],angular.module("uiplatform").controller("RightNavMgmtController",e)}(),function(){"use strict";angular.module("uiplatform").service("leftNavDashboardService",["$log","intellicarAPI","$q",function(e,t,n){e.log("leftNavDashboardService");var a=this;a.listeners={},a.handleResponse=function(t){e.log(t)},a.handleFailure=function(t){return e.log("leftNavDashboardService handleFailure "),e.log(t),n.reject(t)},a.getDashboardTree=function(e){return t.treeDataService.getDashboardTree(e)},a.getMyVehicles=function(e){return t.userService.getMyVehiclesMap(e)},a.addListener=function(e,t){a.listeners[e]=t}}])}(),function(){function e(e,t,n,a,i,o,r){e.treeFilter=r("uiTreeFilter"),n.log("LeftNavDashboardController");var s=this;s.state=o,s.tree_search_pattern="",s.search_results,s.handleDashboardTree=function(e){s.tree_data=e},s.handleFailure=function(e){n.log("handleFailure"),n.log(e)},s.handleMyVehicles=function(e){for(var t in e)s.subscribe(e[t],!0)},s.getMyVehicles=function(){i.getMyVehicles({}).then(s.handleMyVehicles,s.handleFailure)},s.test=function(){console.log("clicked")},s.toggleCheck=function(e){"checked"===e.checkStatus?e.checkStatus="unchecked":e.checkStatus="checked",e.items.length?s.propagateCheckFromParent(e.items,e.checkStatus):s.subscribeCheckStatus(e),s.verifyAllParentsCheckStatus(s.tree_data)},s.propagateCheckFromParent=function(e,t){for(var n=0;n<e.length;++n){var a=e[n];a.checkStatus=t,a.items.length?s.propagateCheckFromParent(a.items,t):s.subscribeCheckStatus(a)}},s.subscribeCheckStatus=function(e){var t="gps";"checked"===e.checkStatus?a.mqttService.subscribeAsset(e.info,t):a.mqttService.unsubscribeAsset(e.info,t)},s.subscribe=function(e,t){var n="gps",i=a.helperService.getAssetPath(e),o=[{path:i}];t?a.mqttService.subscribe(o,n):a.mqttService.unsubscribe(o,n)},s.verifyAllParentsCheckStatus=function(e){for(var t="",n=0;n<e.length;++n){var a=e[n];if(a.items.length&&(a.checkStatus=s.verifyAllParentsCheckStatus(a.items)),""===t&&(t=a.checkStatus),t!=a.checkStatus)return"partlyChecked"}return t},s.expandAll=function(){s.tree_search_pattern.length<=0?e.$broadcast("angular-ui-tree:expand-all"):e.$broadcast("angular-ui-tree:collapse-all")},s.expand_tree=function(){n.log("expand"),e.$broadcast("angular-ui-tree:collapse-all")},s.init=function(){},s.init()}e.$inject=["$scope","$rootScope","$log","intellicarAPI","leftNavDashboardService","$state","$filter"],angular.module("uiplatform").controller("LeftNavDashboardController",e)}(),function(){"use strict";angular.module("uiplatform").service("leftNavManagementService",["$log","$q","intellicarAPI",function(e,t,n){e.log("leftNavManagementService");var a=this;a.listeners={},a.tree_data=[],a.addListener=function(e,t){e in a.listeners||(a.listeners[e]=[]),-1===a.listeners[e].indexOf(t)&&a.listeners[e].push(t)},a.callListeners=function(e,t){if(t in a.listeners)for(var n in a.listeners[t])a.listeners[t][n](e,t)},a.handleResponse=function(e){return t.resolve(e)},a.handleFailure=function(n){return e.log("leftNavManagementService handleFailure "),e.log(n),t.reject(n)},a.getManagementTreeWithUser=function(e){return n.treeDataService.getManagementTreeWithUser(e).then(a.handleResponse,a.handleFailure)},a.getManagementTreeNoUser=function(e){return n.treeDataService.getManagementTreeNoUser(e).then(a.handleResponse,a.handleFailure)}}])}(),function(){function e(e,t,n,a,i,o,r,s,l,c){n.log("LeftNavManagementController");var d=this;d.state=r,d.tree_search_pattern="",d.search_results,n.log(a),t.treeFilter=s("uiTreeFilter"),d.availableFields=["title","description"],d.supportedFields=["title","description"],d.handleResponse=function(e){return n.log(e),d.tree_data=e,d.tree_data},d.handleResponseFailure=function(e){n.log("handleResponseFailure"),n.log(e)},d.setFirstGroup=function(e){n.log(e),e.length&&(i.lastGroupPath=e[0].info.assetpath,l.lastGroup=e[0].info)},d.handleAssetClick=function(e,t,a,r){n.log("handle asset click",t),e.ui_asset_type||"group"!==e.info.ui_asset_type||(d.selectedAsset=e.id,e.loading=!0,i.lastGroupPath=e.info.assetpath,l.lastGroup=e.info,"/1/1"==e.info.assetpath?o.getManagementTreeWithUser({grouppath:e.info.assetpath}).then(d.handleResponse,d.handleResponseFailure):o.getManagementTreeNoUser({grouppath:e.info.assetpath}).then(d.handleResponse,d.handleResponseFailure)),l.setCurrentGroup(e),l.handleAssetClick(e)},d.expand_tree=function(){n.log("expand");d.filterTree(d.tree_data)},d.filterTree=function(e){for(var t=0;t<e.length;t++)e[t].collapsed=!0,e[t].items.length&&d.filterTree(e[t].items)},d.toggleLeftSidebar=function(e,t){t.left_nav_toggle?(document.getElementById("myLeftSidenav").style.width="320px",document.getElementById("main").style.marginLeft="320px"):(document.getElementById("myLeftSidenav").style.width="0",document.getElementById("main").style.marginLeft="0")},d.init=function(e){n.log(a),a=a.toString(),o.getManagementTreeWithUser({grouppath:a}).then(d.handleResponse,d.handleResponseFailure).then(d.setFirstGroup,d.handleResponseFailure)},d.init(),t.$on("toggleLeftSidebar",d.toggleLeftSidebar),t.$on("EVENT_MGMT_TREE_CHANGE",d.init)}e.$inject=["$rootScope","$scope","$log","startupTreeData","groupService","leftNavManagementService","$state","$filter","settingsService","$timeout"],angular.module("uiplatform").controller("LeftNavManagementController",e)}(),function(){angular.module("uiplatform").service("rightNavAlertDashboardService",["$log","intellicarAPI","$q",function(e,t,n){e.log("rightNavDashboardAlertService");var a=this;a.listeners={},a.handleResponse=function(t){e.log(t)},a.handleFailure=function(t){return e.log("rightNavDashboardService handleFailure "),e.log(t),n.reject(t)},a.getDashboardAlerts=function(e){return t.treeDataService.getDashboardTree(e)};var i={},o={};a.getReportData=function(){return i},a.getAlarmData=function(){return o},a.updateFenceReport=function(e){if(null!=e){var t=(e[0],e[1]),n=t.vehicleno;for(var a in i){var o=i[a];for(var r in o){var s=o[r];for(var l in s){var c=s[l];if(c.vehicleno==n){delete c;break}}}}if(t.activeFences&&t.activeFences.length)for(var d in t.activeFences){var m=t.activeFences[d],p=m.activeinfo;for(var u in p){var g=p[u],h=p[u].reportName,v=p[u].fenceName;h in i||(i[h]={}),v in i[h]||(i[h][v]={}),n in i[h][v]||("38"==g.reportTypePath.substr(g.reportTypePath.length-2)?g.triggerType=!0:g.triggerType=!1,g.vehicleno=n,i[h][v][n]=g)}}}},a.addListener=function(e,t){e in a.listeners||(a.listeners[e]=[]),-1===a.listeners[e].indexOf(t)&&a.listeners[e].push(t)},a.callListeners=function(e,t){if(t in a.listeners)for(var n in a.listeners[t])a.listeners[t][n](e,t)},a.updateAlarms=function(e,t){if(null!=e){var n=e[1],a=n.alarmreason,i=n.vehicleno;for(var r in o)for(var s in o[r])if(i==s){delete s;break}a in o||(o[a]={}),o[a][i]={},o[a][i].timestamp=n.timestamp,o[a][i].latitude=n.latitude,o[a][i].longitude=n.longitude,o[a][i].opermode=n.opermode,o[a][i].vehiclepath=n.vehiclepath,o[a][i].deviceid=n.deviceid}},a.init=function(){t.mqttService.addListener("rtfence",a.updateFenceReport),t.mqttService.addListener("rtalarm",a.updateAlarms)},a.init()}])}(),function(){function e(e,t,n,a,i,o,r,s,l,c){function d(e){return"border-top: 2px solid "+e+"; "}e.log("RightNavDashboardController");var m=this;m.alertDetails=[],m.vehicleData={},m.searchAlertStr="",m.reports={},m.handleFailure=function(t){e.log("handleFailure"),e.log(t)},m.getMyGeofenceReports=function(e){m.reports=i.getMyGeofenceReports();for(var t in m.reports){var n=[];n.push({fencereport:t,vehicles:[]});for(var a in m.reports[t].assg)n[0].vehicles.push(m.reports[t].assg[a].assetpath);s.mqttService.subscribe(n,"rtfence")}m.currRep=m.reports[0]},m.getDashboardAlerts=function(e){m.formatAlertData(e)};var p=0;m.formatAlertData=function(e){for(var t={},n=0;n<e.length;n++)t={},t.name=e[n].info.name,t.assetpath=e[n].info.assetpath,t.id=p++,m.alertDetails.push(t),e[n].items.length&&m.formatAlertData(e[n].items)},m.getDashboardAlertsFailure=function(t){e.log("getDashboardTreeFailure"),e.log(t)},m.alertResolve2=function(t){e.log(t);for(var n=0;n<m.alertDetails.length;n++)if(t==m.alertDetails[n].id)return e.log("matched"),void m.alertDetails.splice(n,1)},m.alertClick=function(e){a.alertClick(e)},m.initialize=function(){a.getDashboardAlerts({}).then(m.getDashboardAlerts,m.getDashboardAlertsFailure)},m.collapseAlertPanel=function(e){e.collapse()},m.navAlerts=[{category:"Hub Report",alarms:[{id:"8910"},{odometer:"40"},{ignition:"On"},{mobility:"moblized"}]},{category:"Geofence",alarms:[{id:"1234"},{odometer:"20"},{ignition:"On"},{mobility:"moblized"}]},{category:"Device pullout",alarms:[{id:"4567"},{odometer:"32"},{ignition:"off"},{mobility:"moblized"}]},{category:"City limit",alarms:[{id:"8910"},{odometer:"40"},{ignition:"On"},{mobility:"moblized"}]}],m.activeFilter="all",m.finalTabHeightHalf=37,m.finalTabHeight=162,m.isOpened=function(e,t){},m.resolveFilter=!0,m.resolveFilterAll=!0,m.getColorCounter=0,m.getColor="border-top: 1px solid #f00;",m.getColors=function(){return m.getColorCounter++,1==m.getColorCounter?d("#2ecc71"):2==m.getColorCounter?d("#34495e"):3==m.getColorCounter?d("#3498db"):4==m.getColorCounter?d("#9b59b6"):5==m.getColorCounter?d("#1abc9c"):6==m.getColorCounter?d("#f1c40f"):7==m.getColorCounter?d("#e67e22"):8==m.getColorCounter?d("#e74c3c"):9==m.getColorCounter?d("#d35400"):void 0},m.itemClicked=function(e,t){e.active=!e.active,3==t&&r.highlightMarker(o.vehiclesByNumber[e.vehicleno].assetpath)},m.updateFenceReport=function(e){},a.pushDataToController=function(e){m.activeTabData=e};var u={hours:"h",hour:"h",minutes:"min",minute:"min",days:"d",day:"d",an:"1","a few seconds":"1 min",a:"1"},g=new RegExp(Object.keys(u).join("|"),"gi");m.getTimeDiff=function(e){var t=e.entry,n=e.exit;return 0>=t-n&&(e.stillActive=!0,n=new Date),t/=1e3,n/=1e3,t=moment.unix(t),n=moment.unix(n),moment.duration(n.diff(t)).humanize().replace(g,function(e){return u[e]})},m.returnLength=function(e,t){var n=0;if(1==t){for(key in e)for(key2 in e[key])"active"!=key2&&n++;return n}if(2==t){for(key in e)"active"!=key&&n++;return n}};var h=0,v=0;m.returnHeight=function(e){if(e.active){h=v=0;for(veh in e)"active"!=veh&&(e[veh].active?v++:h++);return 37*h+137*v+37+"px"}return"37px"},m.navFilter=function(e){return!0},m.RESOLVED="RESOLVED",m.UNRESOLVED="UNRESOLVED",m.RESOLVING="RESOLVING",m.SAVING="SAVING",m.SAVED="SAVED",m.resolutionKeyEvent=function(e,t){return e.ctrlKey&&83==e.which?(e.preventDefault(),m.saveRep(t),!1):e.ctrlKey&&13==e.which?(e.preventDefault(),m.resolve(t),!1):void 0},m.resolve=function(e){e.state!=m.RESOLVING&&(e.resolved?(e.state=m.RESOLVING,n(function(){e.state=m.RESOLVED,e.resolved=!1,e.resolveStr="resolved"},2e3)):(e.state=m.RESOLVING,n(function(){e.state=m.UNRESOLVED,e.resolved=!0,e.resolveStr="unresolved"},2e3)))},m.saveRep=function(e){e.state!=m.SAVING&&(e.state=m.SAVING,n(function(){e.state=m.SAVED},2e3))},m.mapServiceUpdate=function(e){e.vehicleno in m.vehicleData||(m.vehicleData[e.vehicleno]={}),m.vehicleData[e.vehicleno].ignitionstatus=e.ignitionstatus},m.updateFenceReport=function(e){},m.historyGeofenceReports=function(e){var t=new Date,n=t.setHours(t.getHours()-24),a=(new Date).getTime(),i=[];m.reports=[];for(var o in e){var r={};r.reportName=e[o].name,r.reportId=o,r.vehiclesAssetPath=[],
r.vehicles=[],r.fences=[];for(var c in e[o].assg){var d={id:e[o].assg[c].assetpath,name:e[o].assg[c].name};4==e[o].assg[c].assgfromassetid?(r.vehiclesAssetPath.push(e[o].assg[c].assetpath),r.vehicles.push(d)):15==e[o].assg[c].assgfromassetid&&r.fences.push(d)}m.reports.push(r);var p={fencereport:o,vehicles:r.vehiclesAssetPath,starttime:n/1e3,endtime:a/1e3};i.push(s.geofenceService.getReportHistory(p))}return l.all(i).then(m.readHistoryInfo,m.handleFailure)},m.readHistoryInfo=function(e){if(e[0]){var t=e[0].data.data;if(t.length)for(var n in t)for(var a in m.reports)if(m.reports[a].reportId==t[n].reportpath){for(var i in m.reports[a].fences)if(m.reports[a].fences[i].id==t[n].fencepath)for(var o in m.reports[a].vehicles){var r=m.reports[a].vehicles[o];if(r.id==t[n].deviceid){m.reports[a].fences[i][r.name]||(m.reports[a].fences[i][r.name]=[]);var s=parseInt(t[n].fentry),l=parseInt(t[n].fexit);l>s&&l-s>18e4&&m.reports[a].fences[i][r.name].push({fentry:t[n].fentry,fexit:t[n].fexit})}}break}}},m.toggleRightSidebar=function(t,n){e.log("dashboard right nav "),n.right_nav_toggle?(document.getElementById("mySidenav").style.width="0",document.getElementById("main").style.marginRight="0"):(document.getElementById("mySidenav").style.width="320px",document.getElementById("main").style.marginRight="320px")},m.getAddress=function(e,t,n,a){var i={data:[[n,a]]},o=s.geocodeService.getAddress(i);return m.popoverIndex="pops"+e+t,l.resolve(o).then(m.gotAddress,m.handleFailure)},m.gotAddress=function(t){if(t.data.data.length){var n=t.data.data;for(var a in n)n=n[a];var i=n[1];e.log(i),WebuiPopovers.updateContent("."+m.popoverIndex,i)}},t.$on("toggleRightSidebar",m.toggleRightSidebar),m.init=function(){i.addListener("mygeofencereportsinfo",m.getMyGeofenceReports),m.activeTabData=a.getReportData(),m.activeAlarmData=a.getAlarmData(),i.addListener("mygeofencereportsinfo",m.historyGeofenceReports),c(function(){$(".eye-icon").webuiPopover({trigger:"hover",width:300,animation:"pop"})},3e3)},m.init()}e.$inject=["$log","$scope","$timeout","rightNavAlertDashboardService","geofenceReportService","vehicleService","mapService","intellicarAPI","$q","$interval"],angular.module("uiplatform").controller("RightNavDashboardController",e)}(),function(){"use strict";angular.module("uiplatform").service("mapService",["$log","$interval","$q","$timeout","userprefService","intellicarAPI","vehicleService","$mdDialog","dialogService",function(e,t,n,a,i,o,r,s,l){e.log("mapService");var c=this;c.listeners={},c.filterStr="",c.inMap={map:null,mapOptions:{},markers:{clickedMarker:{},markersByPath:{}},circles:[],polygons:[],selectedFenceObj:{latitude:"",longitude:"",name:"",other:""}},c.setInMapLocation=function(e){c.inMap.center=angular.copy(e);var t=new google.maps.LatLng(c.inMap.center.latitude,c.inMap.center.longitude);c.inMap.map.setCenter(t),c.inMap.map.setZoom(11)},c.getPolygonMidPoint=function(e){var t=new google.maps.LatLngBounds;for(var n in e)t.extend(new google.maps.LatLng(e[n].latitude,e[n].longitude));return t.getCenter()},c.showHistory=function(){l.show("home.history",{clickedMarker:c.inMap.markers.clickedMarker})},c.mobilize=function(e){c.inMap.markers.clickedMarker.mobilityRequest=e;var t=s.confirm({controller:"ImmobalizeController",templateUrl:"app/components/landingpage/dashboard/map/immobalize-dialog.html",clickOutsideToClose:!0,escapeToClose:!0,locals:{params:{clickedMarker:c.inMap.markers.clickedMarker}}}).ok("Yes").cancel("No");s.show(t).then(function(){},function(){})},c.mapClickEvent=function(){c.fenceInfoWindowClose(),c.infoWindowClose()},c.getMainMap=function(){return c.inMap},c.loc={USER:"USER",MUMBAI:"MUMBAI",BANGALORE:"BANGALORE",HYDERABAD:"HYDERABAD",PUNE:"PUNE",DELHI:"DELHI",CHENNAI:"CHENNAI",KOLKATA:"KOLKATA"},c.locations=[{id:c.loc.USER,notation:"USR",latlng:{latitude:19.195549,longitude:72.936381}},{id:c.loc.MUMBAI,notation:"MUM",latlng:{latitude:19.195549,longitude:72.936381}},{id:c.loc.BANGALORE,notation:"BLR",latlng:{latitude:12.967995,longitude:77.597953}},{id:c.loc.HYDERABAD,notation:"HYD",latlng:{latitude:17.384125,longitude:78.479447}},{id:c.loc.PUNE,notation:"PUN",latlng:{latitude:18.521445,longitude:73.866031}},{id:c.loc.DELHI,notation:"DEL",latlng:{latitude:28.614132,longitude:77.215449}},{id:c.loc.CHENNAI,notation:"CHE",latlng:{latitude:13.075837,longitude:80.2069}},{id:c.loc.KOLKATA,notation:"KOL",latlng:{latitude:22.6754795,longitude:88.0877022}}],c.currentLocation=c.locations[1],c.setUserPref=function(e){c.currentLocation=c.locations[0],c.currentLocation.latlng=e.station,c.center=c.currentLocation.latlng,c.callListeners(e,"setUserPref")},c.getCurrentLocation=function(){return c.currentLocation},c.center=c.currentLocation.latlng,c.zoom=11,c.bounds={},c.getCenter=function(){return c.center},c.getZoom=function(){return c.zoom},c.getBounds=function(){return c.bounds},c.addListener=function(e,t){e in c.listeners||(c.listeners[e]=[]),-1===c.listeners[e].indexOf(t)&&c.listeners[e].push(t)},c.callListeners=function(e,t){if(t in c.listeners)for(var n in c.listeners[t])c.listeners[t][n](e,t)},c.updateMarker=function(e,t){var n=e.rtgps;c.callListeners(n,t)},c.init=function(){r.addListener("rtgps",c.updateMarker),i.addListener("setUserPref",c.setUserPref)},c.init(),c.mapStyles={},c.mapStyles["default"]=[],c.mapStyles.dark=[{featureType:"all",elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#000000"},{lightness:40}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#000000"},{lightness:16}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:17},{weight:1.2}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#000000"},{lightness:21}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:17}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:29},{weight:.2}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#000000"},{lightness:18}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#000000"},{lightness:16}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#000000"},{lightness:19}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#0f252e"},{lightness:17}]}]}])}(),function(){function e(e,t,n,a,i,o,r,s,l,c,d,m,p,u){function g(e,t){var n=(new Date).getTime(),a=e.timestamp.getTime(),i=c.noCommThreshold;n-a>i&&t&&t(e)}function h(e){var t=f(e);return t==D?"black":t==P?"#bc31ff":t==R?"red":t==F?"blue":t==G?"#f37813":"#31ff36"}function v(e){var t=f(e);return t==F?L:_}function f(e){var t=e.olafilter;return t.match(/parking/g)&&t.match(/parking/g).length>0?D:t.match(/servicestation/g)&&t.match(/servicestation/g).length>0?P:t.match(/competitor/g)&&t.match(/competitor/g).length>0?R:t.match(/citylimit/g)&&t.match(/citylimit/g).length>0?F:t.match(/tollplaza/g)&&t.match(/tollplaza/g).length>0?G:null}function y(e){var t=e.olafilter;return S.geoFilters.parkingLot&&t.match(/parking/g)&&t.match(/parking/g).length>0?!0:S.geoFilters.serviceStation&&t.match(/servicestation/g)&&t.match(/servicestation/g).length>0?!0:S.geoFilters.competitorHub&&t.match(/competitor/g)&&t.match(/competitor/g).length>0?!0:S.geoFilters.competitorHub&&t.match(/tollplaza/g)&&t.match(/tollplaza/g).length>0?!0:S.geoFilters.cityLimits&&t.match(/citylimit/g)&&t.match(/citylimit/g).length>0?!0:!1}function b(){for(idx in S.inCustomMaker)S.markersByPath[S.inCustomMaker[idx].args.marker.vehiclepath].getVisible()?(S.inCustomMaker[idx].show(),S.inCustomMaker[idx].showVehicleNumber()):(S.inCustomMaker[idx].hide(),S.inCustomMaker[idx].hideVehicleNumber())}function k(){w=$(window).height(),M(".alert-md-content",function(e){e.css("height",w-C+"px")}),M("#map",function(e){e.css("height",w-C+"px")})}function M(e,t){var n=setInterval(function(){$(e).length>0&&(t($(e)),clearInterval(n))},200)}t.log("MapController");var S=this,x="DD-MM-YYYY HH:mm",w=$(window).height(),C=95,T=new google.maps.InfoWindow,A=new google.maps.InfoWindow;S.inMap=a.getMainMap(),S.inMarkers=S.inMap.markers.inMarkers,S.markersByPath=S.inMap.markers.markersByPath,S.selectedFenceObj=S.inMap.selectedFenceObj,S.filterStr=a.filterStr,S.excludeFilters=["icon","le","onroad","regno","carbattery","devbattery","odometer","latitude","longitude","altitude","direction","nosatellites","speed","rpm"],S.mainFilters=["Running","Stopped","Active","Immobilized","Not Communicating","Device pullout"],S.markerIconChangeTriggered=!1,S.zoomhappened=!0,S.onRoaded=!0,S.offRoaded=!1,S.leftToolbar=function(){return o.getToolbarVar()},S.loadMap=function(){S.inMap.zoom=a.getZoom(),S.inMap.center=a.getCenter(),S.inMap.bounds=a.getBounds(),S.createMap()},S.setUserPref=function(e){S.inMap.map.setCenter(new google.maps.LatLng(e.station.latitude,e.station.longitude))},S.getMarkerCenter=function(e){return{latitude:e.latitude,longitude:e.longitude}},S.onRoadCheck=function(){S.runFilters(S.filterStr),S.runStats()},S.offRoadCheck=function(){S.runFilters(S.filterStr),S.runStats()},S.checkRoaded=function(e){if(e&&e.meta)if(e.meta.onroad){if(S.onRoaded)return!0}else if(S.offRoaded)return!0;return!1},S.setClickedMarker=function(t){t.vehiclepath in S.markersByPath&&(S.inMap.markers.clickedMarker=c.vehiclesByPath[t.vehiclepath],S.inMap.markers.clickedMarker.hideMobilityControls=-1==c.vehiclesByPath[t.vehiclepath].permissions.indexOf(74),e.clickedMarker=S.inMap.markers.clickedMarker,e.hideMobilityControls=S.inMap.markers.clickedMarker.hideMobilityControls)},S.updateMarker2=function(e){var t=new google.maps.Marker({position:new google.maps.LatLng(e.latitude,e.longitude),icon:S.getIcon(e),vehiclepath:e.vehiclepath});e.vehiclepath in S.markersByPath||(S.markersByPath[e.vehiclepath]=t),google.maps.event.addListener(t,"click",function(e){S.setClickedMarker(this),T.setContent(document.getElementById("marker_infowindow").innerHTML),T.open(map,this)}),t.setMap(S.inMap.map),S.customOverlay(e)},S.updateMarker=function(e){if(e.vehiclepath in S.inCustomMaker&&S.geoFilters.showVehicleNo&&S.inCustomMaker[e.vehiclepath].setPosition(e),e.vehiclepath in S.markersByPath){var t=new google.maps.LatLng(e.latitude,e.longitude);S.markersByPath[e.vehiclepath].setPosition(t),S.updateMarkerIcon(e)}S.applyFilterToMarker(e,S.filterStr)},S.showAllMarkers=function(){for(var e in S.markersByPath){var t=c.vehiclesByPath[e].rtgps;S.markersByPath[e].setVisible(S.checkRoaded(t))}},S.runFilters=function(e){if(S.filterStr=e,a.filterStr=e,T.close(),0==S.filterStr.length)return void S.showAllMarkers();console.log("filter=",S.filterStr);var t=!1,n=null,i=!1,o=null;if(S.filterStr.length>2){for(var r in S.markersByPath){var s=S.applyFilterToMarker(c.vehiclesByPath[r].rtgps,e);if(s){o=S.markersByPath[r];var l=Math.floor(o.getPosition().lat()),d=Math.floor(o.getPosition().lng()),m=Math.floor(S.inMap.map.getCenter().lat()),p=Math.floor(S.inMap.map.getCenter().lng());l!=m||d!=p||t||(Math.abs(o.getPosition().lat()-S.inMap.map.getCenter().lat())>.2&&S.inMap.map.setCenter(o.getPosition()),-1==S.mainFilters.indexOf(S.filterStr)&&(S.inMap.map.setCenter(o.getPosition()),S.inMap.map.setZoom(16)),t=!0),n=o.getPosition()}}for(var r in S.polygonsByPath){if(t)break;var u=S.polygonsByPath[r];if("citylimit"!=u.control.info.tagdata.olafilter&&u.control.info.name.toString().toLowerCase().includes(e.toString().toLowerCase())){i=!0;for(var g in u.path){var h=u.path[g];if(n=new google.maps.LatLng(h.latitude,h.longitude),Math.abs(h.latitude-S.inMap.map.getCenter().lat())<.5&&Math.abs(h.longitude-S.inMap.map.getCenter().lng())<.5){S.inMap.map.setCenter(n),S.inMap.map.setZoom(16),t=!0;break}}}}for(var r in S.circlesByPath){if(t)break;var v=S.circlesByPath[r];if("citylimit"!=v.control.info.tagdata.olafilter&&v.control.info.name.toString().toLowerCase().includes(e.toString().toLowerCase())){i=!0;var h=v.center;if(n=new google.maps.LatLng(h.latitude,h.longitude),Math.abs(h.latitude-S.inMap.map.getCenter().lat())<.5&&Math.abs(h.longitude-S.inMap.map.getCenter().lng())<.5){S.inMap.map.setCenter(n),S.inMap.map.setZoom(16),t=!0;break}}}i&&S.showAllMarkers(),n&&!t&&(S.inMap.map.setCenter(n),-1==S.mainFilters.indexOf(S.filterStr)&&S.inMap.map.setZoom(16))}S.vehicleNumber&&b()},S.applyFilterToMarker=function(e,t){if(null==e)return!1;if(!(e.vehiclepath in S.markersByPath))return!1;var n=!1;return S.matchesAnyMarkerData(e,t)?(n=!0,e.vehiclepath in S.inCustomMaker&&S.geoFilters.showVehicleNo&&S.inCustomMaker[e.vehiclepath].show()):(n=!1,e.vehiclepath in S.inCustomMaker&&S.inCustomMaker[e.vehiclepath].hide()),n=S.checkRoaded(e)&&n,S.markersByPath[e.vehiclepath].setVisible(n),e.vehiclepath in S.inCustomMaker&&(n&&S.geoFilters.showVehicleNo?S.inCustomMaker[e.vehiclepath].show():S.inCustomMaker[e.vehiclepath].hide()),n},S.matchesAnyMarkerData=function(e,t){var n=!1;if(e.constructor==Object||e.constructor==Array){for(var a in e)null!=e[a]&&(n=n||S.matchesAnyMarkerData(e[a],t));return n}if(-1!=S.excludeFilters.indexOf(e))return!1;var i=t.toString().toLowerCase(),o=e.toString().toLowerCase();return o.includes(i)?!0:!1},S.vehicleStats={showall:0,running:0,stopped:0,active:0,noComm:0,devPullout:0,immobilized:0},S.runStats=function(){for(var e in S.vehicleStats)"showall"===e?S.vehicleStats[e]=S.getStats(e):S.vehicleStats[e]=S.getStats(e)},S.getStats=function(e){var t=0;S.vehicleStats.noComm=0,S.vehicleStats.devPullout=0;for(var n in c.vehiclesByPath){var a=c.vehiclesByPath[n].rtgps;S.checkRoaded(a)&&(g(a,function(e){S.vehicleStats.noComm++}),a.carbattery<2&&S.vehicleStats.devPullout++,S.matchesAnyMarkerData(a,e)?t++:"showall"===e&&t++)}return t},S.geoFilters={showAll:!0,parkingLot:!0,serviceStation:!0,competitorHub:!0,tollplaza:!0,cityLimits:!1,carBattery:!1,devBattery:!1,noComm:!1,showVehicleNo:!1},o.setData("geoFilters",S.geoFilters);var D="parking",P="servicestation",R="competitor",F="citylimit",G="tollplaza",_=6,L=3;S.getMyFences=function(e){o.setData("geofences",!0),S.applyFilters({filterType:"showAll"}),S.createPolygons(e.polygons),S.createCircles(e.circles)},S.createPolygons=function(e){var t={};for(var n in e){for(var a=[],i=0;i<e[n].path.length;i++)a.push(new google.maps.LatLng(e[n].path[i].latitude,e[n].path[i].longitude));var o=h(e[n].control.info.tagdata);e[n].strokeColor=o;var r=v(e[n].control.info.tagdata);e[n].strokeWeight=r;var s=new google.maps.Polygon({path:a,strokeColor:e[n].strokeColor,strokeWeight:e[n].strokeWeight,fillColor:e[n].fillColor,fillOpacity:e[n].fillOpacity,info:e[n].control.info});google.maps.event.addListener(s,"click",function(e){S.selectedFenceObj=this,A.setContent(document.getElementById("fence_infowindow").innerHTML),A.setPosition(e.latLng),A.open(S.inMap.map,this)}),y(e[n].control.info.tagdata)&&s.setMap(S.inMap.map),e[n].googleObject=s,t[e[n].control.info.assetpath]=e[n]}S.polygonsByPath=t},S.createCircles=function(e){var t={};for(var n in e){var a=h(e[n].control.info.tagdata);e[n].strokeColor=a;var i=v(e[n].control.info.tagdata);e[n].strokeWeight=i;var o=new google.maps.Circle({strokeColor:e[n].strokeColor,strokeWeight:e[n].strokeWeight,fillColor:e[n].fillColor,fillOpacity:e[n].fillOpacity,center:new google.maps.LatLng(e[n].center.latitude,e[n].center.longitude),radius:e[n].radius,info:e[n].control.info});google.maps.event.addListener(o,"click",function(e){S.selectedFenceObj=this,A.setPosition(e.latLng),A.setContent(document.getElementById("fence_infowindow").innerHTML),A.open(S.inMap.map,this)}),y(e[n].control.info.tagdata)&&o.setMap(S.inMap.map),e[n].googleObject=o,t[e[n].control.info.assetpath]=e[n]}S.circlesByPath=t};var I=3.55,O=9.5;S.applyFilters=function(e,t){var n,a;if(null==t&&(t=1),"carBattery"==e.filterType)for(n in S.markersByPath)a=S.markersByPath[n],S.geoFilters.carBattery?c.vehiclesByPath[n].rtgps.carbattery<O&&S.checkRoaded(c.vehiclesByPath[n].rtgps)&&S.inCustomMaker[a.vehiclepath].highlight("orange"):1==t&&(S.inCustomMaker[a.vehiclepath].unhighlight(),S.applyFilters({filterType:"devBattery"},t-1),S.applyFilters({filterType:"noComm"},t-1));else if("devBattery"==e.filterType)for(n in S.markersByPath)a=S.markersByPath[n],S.geoFilters.devBattery?c.vehiclesByPath[n].rtgps.devbattery<I&&S.checkRoaded(c.vehiclesByPath[n].rtgps)&&S.inCustomMaker[a.vehiclepath].highlight("yellow"):1==t&&(S.inCustomMaker[a.vehiclepath].unhighlight(),S.applyFilters({filterType:"carBattery"},t-1),S.applyFilters({filterType:"noComm"},t-1));else if("noComm"==e.filterType)for(n in S.markersByPath)a=S.markersByPath[n],S.geoFilters.noComm?g(c.vehiclesByPath[n].rtgps,function(){S.checkRoaded(c.vehiclesByPath[n].rtgps)&&S.inCustomMaker[a.vehiclepath].highlight("red")}):1==t&&(S.inCustomMaker[a.vehiclepath].unhighlight(),S.applyFilters({filterType:"devBattery"},t-1),S.applyFilters({filterType:"carBattery"},t-1));else if("showVehicleNo"==e.filterType);else{if("home.history"==m.current.name?S.currentMap=d.historyMap.map:S.currentMap=S.inMap.map,S.circlesByPath)for(var n in S.circlesByPath){var i=S.circlesByPath[n].control.info.tagdata;S.circlesByPath[n].googleObject.setMap(null),y(i)&&(S.circlesByPath[n].strokeWeight=v(i),S.circlesByPath[n].strokeColor=h(i),S.circlesByPath[n].googleObject.setMap(S.currentMap))}if(S.polygonsByPath)for(var n in S.polygonsByPath)i=S.polygonsByPath[n].control.info.tagdata,S.polygonsByPath[n].googleObject.setMap(null),y(i)&&S.polygonsByPath[n].googleObject.setMap(S.currentMap)}},S.addListener=function(){c.addListener("rtgps2",S.updateMarker2),a.addListener("rtgps",S.updateMarker),o.addListener("getMyFences",S.getMyFences),o.addListener("applyFilters",S.applyFilters),a.addListener("setUserPref",S.setUserPref)},S.inCustomMaker={},a.highlightMarker=function(e){S.highlightMarker(e)},S.highlightMarker=function(e){e in S.inCustomMaker?S.inCustomMaker[e].highlightMe():console.log("[CUSTOM OVERLAY] no marker found to highLight!")},S.customOverlay=function(e){e.vehiclepath in S.inCustomMaker||(S.inCustomMaker[e.vehiclepath]=new s.CustomMarker(e.latitude,e.longitude,a.inMap.map,{marker:e}))},S.showVehicleNumber=function(e){if(S.vehicleNumber=e,S.vehicleNumber)b();else for(idx in S.inCustomMaker)S.inCustomMaker[idx].hide(),S.inCustomMaker[idx].hideVehicleNumber()},S.fitBounds=function(e,t){var n=new google.maps.LatLngBounds;for(var a in S.markersByPath){var i=c.vehiclesByPath[a].rtgps;S.markersByPath[a].getVisible()&&S.checkRoaded(i)&&n.extend(S.markersByPath[a].getPosition())}S.inMap.map.fitBounds(n)},o.showVehicleNumber=function(e){S.showVehicleNumber(e)},S.downloadView=function(e,t){var n=[],a=[],i="UNKNOWN";for(var o in S.inMap.markers.markersByPath){var r=S.inMap.markers.markersByPath[o];if(r.getVisible()){var s=c.vehiclesByPath[o].rtgps;n.push({"Vehicle No":s.vehicleno,"Device ID":s.deviceid,"Chassis No":s.meta.chassisno,Make:s.meta.cartype,"Last comm time":moment(s.timestamp).format(x),Odometer:s.odometer,OnRoad:s.meta.onroad,Mobility:s.mobilistatusFilter,Ignition:s.ignitionstatusStr,"Vehicle Battery":s.carbattery,"Device Battery":s.devbattery,Team:s.meta.team,"Leasing Executive":s.meta.le,"Last Location":i,LatLng:s.latitude+","+s.longitude}),a.push([s.latitude,s.longitude])}}u.geocodeService.getAddress(a).then(function(e){for(var t in e)n[t]["Last Location"]=e[t][1];u.importFileservice.JSONToCSVConvertor(n,"ViewReport",!0)},function(e){u.importFileservice.JSONToCSVConvertor(n,"ViewReport",!0)})},S.createMap=function(){var e=document.getElementById("map");S.inMap.mapOptions={center:new google.maps.LatLng(S.inMap.center.latitude,S.inMap.center.longitude),zoom:S.inMap.zoom},S.inMap.map=new google.maps.Map(e,S.inMap.mapOptions),S.inMap.map.addListener("click",function(){T.close(),A.close()});var t=new google.maps.places.SearchBox(document.getElementById("pac-input"));S.inMap.map.controls[google.maps.ControlPosition.TOP_LEFT].push(document.getElementById("pac-input")),google.maps.event.addListener(t,"places_changed",function(){var e=t.getPlaces();if(0!=e.length){var n=new google.maps.LatLngBounds;e.forEach(function(e){e.geometry.viewport?n.union(e.geometry.viewport):n.extend(e.geometry.location)}),S.inMap.map.fitBounds(n)}}),S.lastZoomLevel=S.inMap.map.getZoom()},S.updateMarkerIcon=function(e){S.markersByPath[e.vehiclepath].icon=S.getIcon(e),S.markersByPath[e.vehiclepath].icon.origin=new google.maps.Point(0,S.getDirection(e)),S.markersByPath[e.vehiclepath].setIcon(S.markersByPath[e.vehiclepath].icon)},S.onload=function(){e.$apply(function(){l(document.getElementById("markerWindow"))(e)})},S.fenceWindowLoad=function(){e.$apply(function(){l(document.getElementById("fenceWindow"))(e)})},S.mobilize=function(e){S.inMap.markers.clickedMarker.rtgps.mobilityRequest=e;var t=p.confirm({controller:"ImmobalizeController",templateUrl:"app/components/landingpage/dashboard/map/immobalize-dialog.html",clickOutsideToClose:!0,escapeToClose:!0,locals:{params:{clickedMarker:S.inMap.markers.clickedMarker.rtgps}}}).ok("Yes").cancel("No");p.show(t).then(function(){},function(){})},S.showHistory=function(){d.setData("getHistory",!1),d.historyMap.traceObj=[],a.showHistory()},$(window).resize(function(){k()});var E={DARK:"dark",DEFAULT:"default"};S.triggerMarkerIconChange=function(){Math.abs(S.inMap.map.getZoom()-S.lastZoomLevel)>2&&S.changeMarkerIcon(),S.markerIconChangeTriggered=!1},S.changeMapStyle=function(){var e=S.inMap.map.getZoom();10>e?S.inMap.styleType!=E.DARK&&(S.inMap.styleType=E.DARK,S.inMap.map.setOptions({styles:a.mapStyles[E.DARK]})):S.inMap.styleType!=E.DEFAULT&&(S.inMap.styleType=E.DEFAULT,S.inMap.map.setOptions({styles:a.mapStyles[E.DEFAULT]}))};var B="red",j="green",N="blue";S.getMarkerColor=function(e){return e.mobilistatus?e.ignitionstatus?j:N:B},S.getIconURL=function(e){return["assets/images/markers","extralarge",S.getMarkerColor(e)+"-dot.png"].join("/")};var V=16;S.zoomChanged=function(){V=S.checkZoomLevel(1,8)?8:S.checkZoomLevel(9,10)?16:S.checkZoomLevel(11,12)?24:S.checkZoomLevel(13,14)?32:40,S.changeMarkerIcon(),S.changeMapStyle()},S.changeMarkerIcon=function(){for(var e in S.inMap.markers.markersByPath){var t=S.inMap.markers.markersByPath[e],n=t.icon,a=c.vehiclesByPath[t.vehiclepath].rtgps;n.size=new google.maps.Size(V,V),n.origin=new google.maps.Point(0,S.getDirection(a)),n.scaledSize=new google.maps.Size(V,36*V),n.anchor=new google.maps.Point(V/2,V/2),t.setIcon(n)}},S.getDirection=function(e){if(null==e.direction)return 0;var t=Math.floor(e.direction/10)*V;return t>36*V&&(t=36*V),t},S.getIcon=function(e){return{url:S.getIconURL(e),size:new google.maps.Size(V,V),origin:new google.maps.Point(0,S.getDirection(e)),scaledSize:new google.maps.Size(V,36*V),anchor:new google.maps.Point(V/2,V/2)}},S.checkZoomLevel=function(e,t){return S.inMap.map.getZoom()>=e&&S.inMap.map.getZoom()<=t},S.resizeMap=function(){return google.maps.event.trigger(S.inMap.map,"resize"),!0},S.runStatsAtStart=function(){for(var e=5e3;15e3>e;e+=5e3)r(S.runStats,e);i(S.runStats,15e3)},S.init=function(){S.loadMap(),k(),S.addListener(),S.runStatsAtStart(),T.addListener("domready",function(){S.onload()}),A.addListener("domready",function(){S.fenceWindowLoad()}),i(S.resizeMap,1e3),S.inMap.map.addListener("zoom_changed",function(){S.zoomhappened=!0}),S.inMap.map.addListener("tilesloaded",function(){S.zoomChanged()})},e.$on("downloadView",S.downloadView),e.$on("fitBounds",S.fitBounds),S.init()}function t(e,t,n,a,i,o){e.msg="",e.notify="",e.commandSent=!1,e.vehicleno=a.clickedMarker.vehicleno,e.deviceid=a.clickedMarker.deviceid,e.mobilityRequest=a.clickedMarker.mobilityRequest,e.cancelImmobalize=function(){n.cancel()},e.success=function(t){e.msg=a.clickedMarker.mobilityRequest?"Mobilize request sent":"Immobilize request sent",e.notify=""},e.failure=function(t){e.msg="Request not sent",e.notify="",403==t.status&&(e.notify="You are not authorized to perform this operation")},e.executeMobilityCommand=function(t){var n={vehiclepath:a.clickedMarker.vehiclepath};t.length>0?a.clickedMarker.mobilityRequest?e.mobilize(t[0],n):e.immobilize(t[0],n):a.clickedMarker.mobilityRequest?i.vehicleAPIService.mobilize(n).then(e.success,e.failure):i.vehicleAPIService.immobilize(n).then(e.success,e.failure)},e.immobilize=function(t,n){return a.clickedMarker.mobilistatus||"immobilize"!=t.action?void("immobilize"==t.action?(e.msg="Duplicate request!! Request not sent",e.notify="There is a pending immobilize request sent by "+t.username+" at "+new Date(t.doneat)):"mobilize"==t.action&&i.vehicleAPIService.immobilize(n).then(e.success,e.failure)):(e.msg="Request not sent",void(e.notify="Vehicle already in immobilized state"))},e.mobilize=function(t,n){return a.clickedMarker.mobilistatus&&"mobilize"==t.action?(e.msg="Request not sent",void(e.notify="Vehicle already in mobilized state")):void("mobilize"==t.action?(e.msg="Duplicate request!! Request not sent",e.notify="There is a pending mobilize request sent by "+t.username+" at "+new Date(t.doneat)):"immobilize"==t.action&&i.vehicleAPIService.mobilize(n).then(e.success,e.failure))},e.okImmobilize=function(){if(e.commandSent=!0,-1==o.vehiclesByPath[a.clickedMarker.vehiclepath].permissions.indexOf(74))return e.msg="Request not sent",void(e.notify="You are not authorized to perform this operation");var n={vehiclepath:a.clickedMarker.vehiclepath};i.vehicleAPIService.getMobilityCommandStatus(n).then(e.executeMobilityCommand,function(e){t.log("getMobilityCommandStatus failure")})},e.init=function(){e.commandSent=!1,e.msg=a.clickedMarker.mobilityRequest?"Mobilize ?":"Immobilize ?"},e.init()}e.$inject=["$scope","$log","cpuService","mapService","$interval","geofenceViewService","$timeout","customMapOverlay","$compile","vehicleService","historyService","$state","$mdDialog","intellicarAPI"],t.$inject=["$scope","$log","$mdDialog","params","intellicarAPI","vehicleService"],angular.module("uiplatform").controller("MapController",e).controller("ImmobalizeController",t)}(),function(){function e(e,t,n,a,i,o,r,s){n.log("InnerMapController")}e.$inject=["$rootScope","$scope","$log","$mdToast","historyService","$state","$interval","$filter"],angular.module("uiplatform").controller("InnerMapController",e)}(),function(){"use strict";function e(e,t,n,a,i,o,r,s){var l=this;l.historyData={},l.listeners={},l.setData=function(e,t){l.historyData[e]=t},l.getData=function(e){return e in l.historyData?l.historyData[e]:null},l.historyMap={map:{},mapOptions:{center:new google.maps.LatLng(t.getCenter().latitude,t.getCenter().longitude),zoom:t.getZoom()},traceObj:[],markersByPath:t.inMap.markers.markersByPath,vehiclesByPath:i.vehiclesByPath,trace:{path:[]}},l.geoFenceReports={startTime:"",endTime:"",reportId:"",selectedVehiclesCount:0,selectedFencesCount:0,filteredItems:[],filteredFenceItems:[],myHistoryData:[],jsonReportData:[],reports:[],fenceFilter:"",currRep:[]},l.setInMapLocation=function(e){l.historyMap.mapOptions.center=angular.copy(e);var t=new google.maps.LatLng(l.historyMap.mapOptions.center.latitude,l.historyMap.mapOptions.center.longitude);l.historyMap.map.setCenter(t)},l.addListener=function(e,t){e in l.listeners||(l.listeners[e]=[]),-1===l.listeners[e].indexOf(t)&&l.listeners[e].push(t)},l.callListeners=function(e,t){if(t in l.listeners)for(var n in l.listeners[t])l.listeners[t][n](e,t)},l.clearMap=function(){l.historyMap.startMarker&&l.historyMap.startMarker.setMap(null),l.historyMap.endMarker&&l.historyMap.endMarker.setMap(null),"setMap"in l.historyMap.trace&&l.historyMap.trace.setMap(null),l.traceControls.stopMotion(),l.traceControls.current=0,l.traceControls.moveTimeline()},l.getHistoryData=function(){if(l.clearMap(),!l.historyMap.selectedVehicle)return l.historyMap.errorMsg="Please Select Vehicle",void n.$broadcast("gotHistoryEventFailed");if(!l.historyMap.startTime||!l.historyMap.endTime)return l.historyMap.errorMsg="Enter valid start and end time.",void n.$broadcast("gotHistoryEventFailed");if(!l.historyMap.startTime.length||!l.historyMap.endTime.length)return l.historyMap.errorMsg="Enter valid start and end time",void n.$broadcast("gotHistoryEventFailed");var e=1e3*moment(l.historyMap.startTime).unix(),t=1e3*moment(l.historyMap.endTime).unix();if(t-e>p)return l.historyMap.errorMsg="Maximum time limit is one week.",void n.$broadcast("gotHistoryEventFailed");if(e>=t)return l.historyMap.errorMsg="End time should be >= Start time",void n.$broadcast("gotHistoryEventFailed");var i={vehicle:{vehiclepath:l.historyMap.selectedVehicle.rtgps.deviceid.toString(),starttime:e,endtime:t}},o={vehiclepath:[l.historyMap.selectedVehicle.rtgps.deviceid.toString()],starttime:e,endtime:t},r=a.reportsService.getDeviceLocation(i),c=a.myAlarmService.getAlarmInfo(o),d=a.reportsService.getBatteryInfo(i);s.all([r,c,d]).then(l.drawTrace,l.handleGetLocationFailure)},l.handleGetLocationFailure=function(t){e.log("handleGetLocationFailure"),e.log(t),l.historyMap.trace.path=[]},l.syncBatteryInfo=function(e,t){for(var n=0,a=0;n<e.length&&a<t.length;a++)for(;n<e.length&&a<t.length&&parseInt(e[n].gpstime)<=parseInt(t[a].gpstime);)e[n].carbattery=t[a].carbattery,e[n].devbattery=t[a].devbattery,l.lastBattery=t[a],n++},l.drawTrace=function(e){function t(e,t){return e.gpstime-t.gpstime}l.setData("getHistory",!0),l.historyMap.errorMsg="";var a=[],i=[],o=[];if(null==e)a=l.historyMap.traceData,i=l.historyMap.alarmData;else{if(3!=e.length)return;a=l.historyMap.traceData=e[0],i=l.historyMap.alarmData=e[1],l.syncBatteryInfo(a,e[2])}if(0==a.length)return l.historyMap.errorMsg="No Data",void n.$broadcast("gotHistoryEventFailed");for(var r in a){var s=a[r];if(null!=s.latitude&&null!=s.longitude&&0!=s.latitude&&0!=s.longitude){var c=new google.maps.LatLng(s.latitude,s.longitude);c.odometer=s.odometer,c.heading=s.heading,c.numsat=s.numsat,c.ignstatus=s.ignstatus,c.gpstime=parseInt(s.gpstime),c.speed=parseFloat(s.speed.toFixed(2)),c.carbattery=s.carbattery?parseFloat(s.carbattery.toFixed(2)):l.lastBattery.carbattery,c.devbattery=s.devbattery?parseFloat(s.devbattery.toFixed(2)):l.lastBattery.devbattery,o.push(c)}}o.length>0?(o.sort(t),l.drawPolylines(o,0,o.length),l.historyMap.traceObj=o,null!=l.historyMap.map&&l.historyMap.map.setCenter&&(l.historyMap.trace.setMap(l.historyMap.map),l.historyMap.startMarker.setMap(l.historyMap.map),l.historyMap.endMarker.setMap(l.historyMap.map)),n.$broadcast("gotHistoryEvent",{gotHistoryEvent:!0,path:o,alarm:i})):(l.historyMap.errorMsg="No GPS Signal",n.$broadcast("gotHistoryEventFailed"))},l.drawPolylines=function(e,t,n){e.splice(n+1,e.length-n-1),e.splice(0,t),l.historyMap.startMarker&&l.historyMap.startMarker.setMap(null),l.historyMap.endMarker&&l.historyMap.endMarker.setMap(null),"setMap"in l.historyMap.trace&&l.historyMap.trace.setMap(null),l.historyMap.startMarker=new google.maps.Marker({icon:"assets/images/markers/red-marker.png",position:e[0]});var a=e[e.length-1];l.historyMap.endMarker=new google.maps.Marker({position:a,label:"E",title:"End point"}),l.historyMap.trace=new google.maps.Polyline({path:e,icons:[{icon:{path:google.maps.SymbolPath.FORWARD_CLOSED_ARROW},offset:"100px",repeat:"100px"}],strokeColor:"blue",strokeWeight:2,strokeOpacity:1});var i=new google.maps.LatLngBounds;for(var o in e)i.extend(e[o]);l.historyMap.map.fitBounds(i),l.historyMap.trace.setMap(l.historyMap.map),l.historyMap.startMarker.setMap(l.historyMap.map),l.historyMap.endMarker.setMap(l.historyMap.map)},l.getDefaultTime=function(e,t){var n="YYYY-MM-DD HH:mm";if(e&&t)var a=moment(e).format(n),i=moment(t).format(n);else{var o=6,r=19;moment().unix()-moment().hours(o).unix()<0&&(o-=24,r-=24);var a=moment().hours(o).minutes(0).seconds(0).milliseconds(0).format(n),i=moment().hours(r).minutes(0).seconds(0).milliseconds(0).format(n)}return{startTime:a,endTime:i}};var c=1e3,d=86400*c,m=7*d,p=2*m;l.traceControls={interval:3e4,timeline:[],expandedGraphs:"half",playing:!1,SPEEDS:[2e3,1e3,500,250,125,62,31,15,8],speed:4,current:0,excludedAlarm:["End_of_Over_speed","IGNITION_OFF","IGNITION_ON"],
togglePlay:function(){l.traceControls.isPointer(),l.traceControls.playing?l.traceControls.stopMotion():(l.traceControls.setPointerTransition(!0),l.traceControls.startMotion())},stepForward:function(){l.traceControls.current<l.traceControls.timeline.length-1&&(l.traceControls.current++,l.traceControls.setPointerTransition(!1),l.traceControls.moveTimeline())},stepBackward:function(){l.traceControls.current>0&&(l.traceControls.current--,l.traceControls.setPointerTransition(!1),l.traceControls.moveTimeline())},incrementSpeed:function(){l.traceControls.speed<l.traceControls.SPEEDS.length-1&&(l.traceControls.speed++,l.traceControls.playing&&l.traceControls.startMotion(),l.traceControls.setPointerTransition(!0))},decrementSpeed:function(){l.traceControls.speed>0&&(l.traceControls.speed--,l.traceControls.playing&&l.traceControls.startMotion(),l.traceControls.setPointerTransition(!0))},engine:{}},l.setTime=function(e,t){var n=l.getDefaultTime(e,t);l.historyMap.startTime=n.startTime,l.historyMap.endTime=n.endTime,l.geoFenceReports.startTime=n.startTime,l.geoFenceReports.endTime=n.endTime},l.init=function(){l.setTime()},l.init()}e.$inject=["$log","mapService","$rootScope","intellicarAPI","vehicleService","$timeout","myAlarmService","$q"],angular.module("uiplatform").service("historyService",e)}(),function(){function e(e,t,n,a,i,o,r,s,l,c,d,m){function p(e){function t(){m++,m>=4&&setTimeout(function(){var e=$("<a>").attr("href",i.toDataURL("image/png")).attr("download","img.png").appendTo("body");e[0].click()},100)}function n(n){var i=n.idx,r=n.left,s=n.top,l=$(A.tcGraphs.charts[i].data.svg);A.tcGraphs.charts[i].object.vis.attr("transform","translate(0,0) scale(1, 0.69)"),A.tcGraphs.charts[i].object.visAxis.attr("transform","translate(0,0) scale(1, 0.69)");var c=l.height(),d=l.width();n.childGraph&&(c-=.05*c,r+=20,d-=20,s=l.height()*s+10),n.parent&&(c+=.2*c,s=a.height()-c-20,d=e.width,o.strokeStyle="#777",o.strokeRect(r,s,d,c));var m=(new XMLSerializer).serializeToString(l[0]),p=window.URL||window.webkitURL||window,u=new Image,g=new Blob([m],{type:"image/svg+xml;charset=utf-8"}),h=p.createObjectURL(g);u.onload=function(){o.drawImage(u,r,s,d,c),A.tcGraphs.charts[i].object.vis.attr("transform","translate(0,0) scale(1, 1)"),A.tcGraphs.charts[i].object.visAxis.attr("transform","translate(0,0) scale(1, 1)"),t()},u.src=h}var a=$(".downloadImage"),i=document.createElement("canvas");i.id="downloadImageCanvas",i.width=a.width(),i.height=a.height(),a.append(i);var o=i.getContext("2d");o.fillStyle="#fff",o.fillRect(0,0,a.width(),a.height()),o.drawImage(e.image,10,10,e.width,e.height),n({idx:0,left:10,top:e.height+20,parent:!0}),n({idx:1,left:e.width,top:0,childGraph:!0}),n({idx:2,left:e.width,top:1,childGraph:!0}),n({idx:3,left:e.width,top:2,childGraph:!0});var r=[moment.utc(A.getCurrentPos().gpstime).format("d MMM YY, h:mm:ss A"),"Ignition : "+(A.getCurrentPos().ignstatus?"On":"Off"),"Speed : "+A.getCurrentPos().speed+"kmph","Odometer : "+A.getCurrentPos().odometer+" km",A.traceControls.selectedVehicle.rtgps.meta.cartype];for(var s in r){var l=r.length-s,c=e.width+40;o.font="12px gotham",o.fillStyle="#777";var d=a.height()-20-22*l;o.fillText(r[s],c,d)}var m=0}function u(){A.historyMap=a.historyMap,A.historyMap.map=new google.maps.Map(document.getElementById("history_map"),A.historyMap.mapOptions),A.historyMap.map.addListener("click",function(){}),g(),n(A.resizeMap,1e3)}function g(){A.gotData?header_height=160:header_height=50,h(".mapDView",function(e){var t=e.height();h("#history_map",function(e){e.css("height",t-header_height+"px")})})}function h(e,t){var n=setInterval(function(){$(e).length>0&&(t($(e)),clearInterval(n))},200)}function v(){if(null==A.historyMap.selectedVehicle){var e=Object.keys(r.vehiclesByPath);e.length>0&&(A.historyMap.selectedVehicle=r.vehiclesByPath[e[0]])}}function f(e){var t=e.path,n=e.alarm,a=0;if(t.length<1)return void(A.traceControls.timeline=[]);A.traceControls.selectedVehicle=A.historyMap.selectedVehicle,A.traceControls.panel.clicked=!0;for(var i=[],o=angular.copy(t[0]),r=(angular.copy(t[t.length-1]),o.gpstime),s=0;;){if(s>=t.length)break;if(r>=t[s].gpstime)n.length>a&&Math.abs(n[a].gpstime-t[s].gpstime)<=3e4&&(-1==A.traceControls.excludedAlarm.indexOf(n[a].alarmreason)&&(t[s].alarmData=n[a]),a++),i.push(t[s]),r=t[s].gpstime+A.traceControls.interval,s++;else{var l=y(t[s]);l.gpstime=r,i.push(l),r+=A.traceControls.interval}}A.traceControls.timeline=i,A.traceControls.startIndex=0,A.traceControls.endIndex=A.traceControls.timeline.length}function y(e){var t=angular.copy(e);return t.gpstime=0,t.speed=0,t.odometer=0,t.heading=0,t.ignstatus=0,t}function b(){A.traceControls.pointer=$(".tc_pointer"),A.traceControls.panel={clicked:!0},A.traceControls.panel.element=$(".tc_panel"),$(t).keyup(function(){A.traceControls.setPointerTransition(!0)}),$(t).keydown(function(e){A.traceControls.setPointerTransition(!1),(32==e.keyCode||31==e.keyCode)&&(e.preventDefault(),A.traceControls.togglePlay()),37==e.keyCode?e.ctrlKey?A.traceControls.jumpToAlarm(-1):A.traceControls.jumpToTime(-1):38==e.keyCode?A.traceControls.jumpToTime(10):39==e.keyCode?e.ctrlKey?A.traceControls.jumpToAlarm(1):A.traceControls.jumpToTime(1):40==e.keyCode&&A.traceControls.jumpToTime(-10)})}function k(e){var t=n(function(){if($(".tc_panel, .tcg_item").length>1){n.cancel(t),A.traceControls.expDiv=$(".tcg_item"),A.traceControls.expDivParent=$(".tc_panel");for(var a in A.tcGraphs.charts){if(A.tcGraphs.charts[a].data.parent?(A.tcGraphs.charts[a].data.height=A.traceControls.expDivParent.height(),A.tcGraphs.charts[a].data.width=A.traceControls.expDivParent.width()):(A.tcGraphs.charts[a].data.height=A.traceControls.expDiv.height()-30,A.tcGraphs.charts[a].data.width=A.traceControls.expDiv.width()),A.tcGraphs.charts[a].data.margin||(A.tcGraphs.charts[a].data.margin=A.tcGraphs.margin),A.tcGraphs.charts[a].data.parent){var i={color:"#3498db",values:[]},o={color:"#2ecc71",values:[]};A.tcGraphs.charts[a].data.barCharts=[];var r={},s={},l=!1,c=!1;for(var d in A.traceControls.timeline){var m=A.traceControls.timeline[d].ignstatus,p=!1;A.traceControls.timeline[d].speed>A.traceControls.speedThreshold&&(p=!0),m&&!l?r.x1=d:!m&&l&&(r.x2=d,i.values.push(r),r={}),p&&!c?s.x1=d:!p&&c&&(s.x2=d,o.values.push(s),s={}),l=m,c=p}A.tcGraphs.charts[a].data.barCharts.push(i),A.tcGraphs.charts[a].data.barCharts.push(o)}A.tcGraphs.charts[a].object=new T(A.tcGraphs.charts[a])}$(window).resize(function(){M()}),e&&e()}},200)}function M(){}function S(){k(function(){for(var e in A.tcGraphs.charts)x(A.tcGraphs.charts[e],A.traceControls.timeline),A.tcGraphs.charts[e].object.draw(A.tcGraphs.charts[e].graphs)})}function x(e,t){var n=e.graphs;for(var a in n){n[a].values=[];for(var i in t)n[a].values.push({x:t[i].gpstime,y:t[i][n[a].item]})}}function w(e){A.traceControls.current=C(A.traceControls.timeline,e,"gpstime")}function C(e,t,n){for(var a=0,i=e.length-1,o=a+parseInt((i-a)/2),r=!0,s=0;r;){if(s++,e[o][n]<t)o<e.length-1&&(a=o+1);else if(e[o][n]>t)o>0&&(i=o-1);else if(Math.abs(e[o][n]-t)<=3e4){r=!1;break}if(o=a+parseInt((i-a)/2),s>1e3)break}return o}function T(e){function t(){l.mouseX=d3.mouse(this)[0],0==d3.event.button?A.tcGraphs.mouseclicked||l.mouseX>l.data.margin.left&&l.mouseX<l.data.width-l.data.margin.right&&(A.tcGraphs.mouseclicked=!0,A.tcGraphs.zoomStartX=angular.copy(l.mouseX),A.tcGraphs.zoomStartTemp=parseInt(l.xScale.invert(l.mouseX)),l.selectRect.attr("x",A.tcGraphs.zoomStartX).attr("y",l.data.margin.top).attr("width",0).attr("fill","rgba(255,0,0,0.2)").attr("height",l.data.height-l.data.margin.top-l.data.margin.bottom)):2==d3.event.button&&(d3.event.preventDefault(),A.tcGraphs.restoreGraph())}function n(){if(0==d3.event.button&&A.tcGraphs.mouseclicked)if(A.tcGraphs.mouseclicked=!1,l.mouseX=d3.mouse(this)[0],A.tcGraphs.zoomEndTemp=parseInt(l.xScale.invert(l.mouseX)),Math.abs(A.tcGraphs.zoomEndTemp-A.tcGraphs.zoomStartTemp)>12e4){if(A.tcGraphs.zoomStart=angular.copy(A.tcGraphs.zoomStartTemp),A.tcGraphs.zoomEnd=angular.copy(A.tcGraphs.zoomEndTemp),A.tcGraphs.zoomEnd<A.tcGraphs.zoomStart){var e=A.tcGraphs.zoomStart;A.tcGraphs.zoomStart=angular.copy(A.tcGraphs.zoomEnd),A.tcGraphs.zoomEnd=e}A.tcGraphs.zoom()}else{if(A.traceControls.playing){var t=parseInt(l.xScale.invert(l.mouseX));A.traceControls.updateAllTimelines(t),A.traceControls.moveTimeline()}else A.traceControls.panel.clicked=!A.traceControls.panel.clicked;l.selectRect.attr("y",-1e3),l.timePopRight.attr("transform","translate(0,-1000)")}}function a(){if(l.mouseX=d3.mouse(this)[0],l.mouseY=d3.mouse(this)[1],A.tcGraphs.mouseclicked){var e=angular.copy(l.mouseX);e<l.data.margin.left&&(e=l.data.margin.left),e>l.data.width-l.data.margin.right&&(e=l.data.width-l.data.margin.right);var t=e-A.tcGraphs.zoomStartX;A.tcGraphs.zoomStartX>e&&(t=A.tcGraphs.zoomStartX-e,l.selectRect.attr("x",e)),l.selectRect.attr("width",t);var n=0,a=parseInt(l.xScale.invert(l.mouseX)),i=moment(a).format("DD MMM YY, h:mm:ss A"),o=9*i.length+5;l.mouseX+o+10>l.data.width-l.data.margin.right&&(n=o+15);var r=l.mouseX-n+8;r<10+l.data.margin.left&&(r=10+l.data.margin.left),l.timePopRight.attr("transform","translate("+r+",30)").select("text").text(i),l.timePopRight.select("rect").attr("width",o)}else if(null!=l.xScale&&l.mouseX>=l.data.margin.left&&l.mouseX<=l.data.width-l.data.margin.right&&l.mouseY>=l.data.margin.top&&l.mouseY<=l.data.height-l.data.margin.bottom&&A.traceControls.panel.clicked){var s=parseInt(l.xScale.invert(l.mouseX));A.traceControls.updateAllTimelines(s),A.traceControls.moveTimeline()}}function i(){if(A.tcGraphs.mouseclicked){if(A.tcGraphs.mouseclicked=!1,A.tcGraphs.zoomEnd=parseInt(l.xScale.invert(l.mouseX)),Math.abs(A.tcGraphs.zoomEnd-A.tcGraphs.zoomStart)>12e4){if(A.tcGraphs.zoomEnd<A.tcGraphs.zoomStart){var e=A.tcGraphs.zoomStart;A.tcGraphs.zoomStart=A.tcGraphs.zoomEnd,A.tcGraphs.zoomEnd=e}A.tcGraphs.zoom()}l.selectRect.attr("y",-1e3),l.timePopRight.attr("transform","translate(0,-1000)")}}function o(){d3.selectAll(l.data.svg+" > *").remove(),l.clipRect=l.visP.append("clipPath").attr("x",0).attr("y",0).attr("id","main-clip"+l.data.svg).append("rect").attr("x",l.data.margin.left).attr("y",l.data.margin.top).attr("width",l.data.width-l.data.margin.left-l.data.margin.right).attr("height",l.data.height),l.vis=l.visP.append("svg:g").attr("class","visTrans").attr("clip-path","url(#main-clip"+l.data.svg+")").attr("transform","translate(0,0) "),l.visAxis=l.visP.append("svg:g").attr("class","visTrans").attr("transform","translate(0,0) "),l.xAxis=d3.axisBottom().scale(l.xScale).ticks(5).tickFormat(function(e){return d3.timeFormat("%H:%M")(new Date(e))}),l.y1Axis=d3.axisLeft().scale(l.y1Scale).ticks(6),l.y2Axis=d3.axisRight().scale(l.y2Scale).ticks(6),l.visAxis.append("svg:g").attr("transform","translate(0,"+(l.data.height-l.data.margin.bottom)+")").attr("font-size","80%").attr("font-family","gotham").attr("shape-rendering","crispEdges").call(l.xAxis),l.chart.data.parent||(l.visAxis.append("svg:g").attr("font-size","80%").attr("font-family","gotham").attr("shape-rendering","crispEdges").attr("transform","translate("+l.data.margin.left+",0)").call(l.y1Axis),l.visAxis.append("svg:g").attr("font-size","80%").attr("font-family","gotham").attr("shape-rendering","crispEdges").attr("transform","translate("+(l.data.width-l.data.margin.right)+",0)").call(l.y2Axis)),l.lineGenY1=d3.line().x(function(e){return l.xScale(e.x)}).y(function(e){return l.y1Scale(e.y)}),l.lineGenY2=d3.line().x(function(e){return l.xScale(e.x)}).y(function(e){return l.y2Scale(e.y)});for(var e in l.data.graph)l.vis.append("svg:path").attr("d",r(l.data.graph[e].yAxis,l.data.graph[e].values)).attr("stroke",l.data.graph[e].color).attr("stroke-width",l.data.graph[e].strokeWidth).attr("fill","none");for(var e in l.data.barCharts)for(jdx in l.data.barCharts[e].values){var t=A.traceControls.timeline[l.data.barCharts[e].values[jdx].x1].gpstime,n=A.traceControls.timeline[l.data.barCharts[e].values[jdx].x2].gpstime,a=l.xScale(t),o=l.xScale(n)-a;l.vis.append("rect").attr("x",a).attr("width",o).attr("height",5).attr("clip-path","url(#main-clip"+l.data.svg+")").attr("fill",l.data.barCharts[e].color).attr("y",2+7*e)}l.focusCircle=[],l.focusText=[],l.nameText=[];for(var e in l.chart.graphs)l.focusCircle[e]=l.vis.append("circle").attr("class","click-circle").attr("cx",-1e3).attr("cy",-1e3).attr("fill",l.chart.graphs[e].color).attr("r",5),l.data.parent||(l.nameText[e]=l.vis.append("text").attr("x",l.data.margin.left+10).attr("fill",l.chart.graphs[e].color).attr("font-size","70%").attr("font-family","gotham").attr("y",l.data.margin.top+10+15*e).text(l.chart.graphs[e].key)),l.focusText[e]=l.vis.append("g"),l.focusText[e].append("rect").attr("width",10).attr("height",16).attr("opacity","0.9").attr("fill","#f5f5f5").attr("stroke-width",1).attr("stroke","#ccc").attr("font-family","gotham").attr("y",-8+20*e),l.focusText[e].append("text").attr("x",4).attr("fill",l.chart.graphs[e].color).attr("font-size","70%").attr("font-family","gotham").attr("y",4+20*e);l.focusLine=l.vis.append("line").attr("stroke","#000").attr("opacity",.5).attr("x1",-1e3).attr("x2",-1e3).attr("y1",l.data.margin.top).attr("y2",l.data.height-l.data.margin.top).attr("stroke-width",1).attr("stroke","#ccc"),l.selectRect=l.vis.append("rect").attr("x",A.tcGraphs.zoomStartX).attr("y",-1e3).attr("width",0).attr("fill","rgba(255,0,0,0.2)").attr("height",l.data.height-l.data.margin.top-l.data.margin.bottom),l.timePopRight=l.vis.append("g").attr("transform","translate(0,-1000)"),l.timePopRight.append("rect").attr("width",10).attr("height",22).attr("fill","#f5f5f5").attr("stroke-width",1).attr("stroke","#ccc").attr("font-size","70%").attr("font-family","gotham").attr("y",10),l.timePopRight.append("text").attr("x",8).attr("fill","#444").attr("font-size","120%").attr("font-family","gotham").attr("y",28),l.vis.append("rect").attr("x",l.data.margin.left).attr("y",l.data.margin.top).attr("fill","transparent").attr("width",l.data.width-l.data.margin.left-l.data.margin.right).attr("height",l.data.height-l.data.margin.top-l.data.margin.bottom-1).on("mouseleave",function(){i()}),l.updateLine(A.traceControls.timeline[A.traceControls.current].gpstime,l.chart)}function r(e,t){return 1==e?l.lineGenY1(t):2==e?l.lineGenY2(t):void 0}function s(){l.axisScale={y1:{},y2:{}};for(var e in l.data.graph){var t=l.data.graph[e];null==t.yAxis&&(t.yAxis=1);for(var n in t.values)(t.values[n].x<l.axisScale.xl||null==l.axisScale.xl)&&(l.axisScale.xl=t.values[n].x),(t.values[n].x>l.axisScale.xh||null==l.axisScale.xh)&&(l.axisScale.xh=t.values[n].x),(t.values[n].y<l.axisScale["y"+t.yAxis].yl||null==l.axisScale["y"+t.yAxis].yl)&&(l.axisScale["y"+t.yAxis].yl=t.values[n].y),(t.values[n].y>l.axisScale["y"+t.yAxis].yh||null==l.axisScale["y"+t.yAxis].yh)&&(l.axisScale["y"+t.yAxis].yh=t.values[n].y)}l.axisScale.xh+=0,l.axisScale.y1.yh=parseInt(l.axisScale.y1.yh+.6*l.axisScale.y1.yh),l.axisScale.y2.yh=parseInt(l.axisScale.y2.yh+.6*l.axisScale.y1.yh),l.axisScale.y1.yl=0,l.axisScale.y2.yl=0,l.xScale=d3.scaleLinear().range([l.data.margin.left,l.data.width-l.data.margin.right]).domain([new Date(l.axisScale.xl),new Date(l.axisScale.xh)]),l.y1Scale=d3.scaleLinear().range([l.data.height-l.data.margin.top,l.data.margin.bottom]).domain([l.axisScale.y1.yl,l.axisScale.y1.yh]),l.y2Scale=d3.scaleLinear().range([l.data.height-l.data.margin.top,l.data.margin.bottom]).domain([l.axisScale.y2.yl,l.axisScale.y2.yh])}var l=this;l.data=e.data,l.chart=e,l.visP=d3.select(l.data.svg).attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 "+l.data.width+" "+(l.data.height-30)).classed("svg-content-responsive",!0).on("contextmenu",function(e){d3.event.preventDefault()}).on("mousemove",a).on("mousedown",t).on("mouseup",n),l.updateLine=function(e,t){if(l.xScale){var n=A.traceControls.timeline[A.traceControls.current];l.mouseX=l.xScale(e),l.focusLine.attr("x1",l.mouseX).attr("x2",l.mouseX);for(var a in t.graphs){var i=t.graphs[a].item;1==t.graphs[a].yAxis?l.graphY=l.y1Scale(n[i]):l.graphY=l.y2Scale(n[i]),l.focusCircle[a].attr("cx",l.mouseX).attr("cy",l.graphY);var o=0,r=n[i]+" "+t.graphs[a].unit,s=7*r.length+5;l.mouseX+s+10>l.data.width-l.data.margin.right&&(o=s+15),l.focusText[a].attr("transform","translate("+(l.mouseX-o+8)+",30)").select("text").text(r),l.focusText[a].select("rect").attr("width",s)}}},l.resize=function(e){l.data.height=e.height,l.data.width=e.width,l.draw()},l.draw=function(e){e&&(l.data.graph=e),s(),o()},l.redraw=function(){o()}}var A=this;A.downloadScreenShot=function(){var e=$("#history_map").width(),t=$("#history_map").height(),n=$("#history_map [style*=transform]"),a=n[0];"4"==a.style["z-index"]&&(a=n[1]),a=$(a);var i=[$("#history_map .gmnoprint img")[0],$("#history_map .gm-style .gm-style-pbc .gm-style-pbt"),$("#history_map > div > .gm-style > .gmnoprint > .gm-style-mtc"),$("#history_map > div > .gm-style > .gmnoprint.gm-bundled-control.gm-bundled-control-on-bottom")[0]];for(var o in i)$(i[o]).attr("data-html2canvas-ignore","true");var r=a.css("transform"),s=r.split(","),l=parseFloat(s[4]);isNaN(l)&&(l=0);var c=parseFloat(s[5]);isNaN(c)&&(c=0),a.css({transform:"none",left:l,top:c}),n.length>1&&$(n[1]).css({transform:"none",left:l,top:c}),html2canvas($("#history_map"),{logging:!0,onrendered:function(i){var o=new Image;o.src=i.toDataURL("image/png");var s={height:t,width:e,image:o};p(s),a.css({left:0,top:0,transform:r}),n.length>1&&$(n[1]).css({transform:r,left:0,top:0})},width:e,height:t,useCORS:!0})},e.getMatches=function(e){var t=[];null==e&&(e="");var n;e=e.toLowerCase();for(var a in A.historyMap.markersByPath)n=r.vehiclesByPath[a].rtgps.vehicleno,n=n.toLowerCase(),-1!=n.indexOf(e)&&t.push(r.vehiclesByPath[a]);return t},c.setTab(0);var D=new google.maps.InfoWindow;A.getHistory=function(){A.gotData=!1,A.loadingData=!0,g(),a.setData("getHistory",!1),a.getHistoryData()},$(window).resize(function(){g()}),A.resizeMap=function(){return google.maps.event.trigger(A.historyMap.map,"resize"),!0},A.traceControls=a.traceControls,A.traceControls.jumpToTime=function(e){A.traceControls.current+e<A.traceControls.startIndex?(A.traceControls.current=0,A.traceControls.moveTimeline()):A.traceControls.current+e>A.traceControls.endIndex?(A.traceControls.current=A.traceControls.timeline.length-1,A.traceControls.moveTimeline()):A.traceControls.current+e<A.traceControls.startIndex&&(A.traceControls.current+=e,A.traceControls.moveTimeline())},A.traceControls.jumpToAlarm=function(e){for(var t=A.traceControls.current+e;t<A.traceControls.endIndex&&t>=0;){if(A.traceControls.timeline[t].alarmData){A.traceControls.current=t,A.traceControls.moveTimeline();break}t+=e}},A.traceControls.setPointerTransition=function(e){e?A.traceControls.pointer.css("transition",A.traceControls.SPEEDS[A.traceControls.speed]+"ms linear"):A.traceControls.pointer.css("transition","0ms linear")},A.traceControls.isPointer=function(){A.traceControls.pointer||(A.traceControls.pointer=$(".tc_pointer")),A.traceControls.setPointerTransition(!0)},A.traceControls.stopMotion=function(){A.traceControls.playing&&(A.traceControls.playing=!1,n.cancel(A.traceControls.engine))},A.traceControls.startMotion=function(){A.traceControls.timeline.length>A.traceControls.startIndex&&A.traceControls.current<A.traceControls.endIndex&&(A.traceControls.panel.clicked=!1,A.traceControls.playing=!0,A.traceControls.engine&&n.cancel(A.traceControls.engine),A.traceControls.current++,A.traceControls.moveTimeline(),A.traceControls.engine=n(function(){A.traceControls.current>=A.traceControls.endIndex?(n.cancel(A.traceControls.engine),A.traceControls.playing=!1):A.traceControls.current++,A.traceControls.moveTimeline()},A.traceControls.SPEEDS[A.traceControls.speed]))},A.traceControls.moveTimeline=function(){A.historyMap.startMarker&&A.traceControls.current<A.traceControls.endIndex&&(A.historyMap.startMarker.setPosition(A.traceControls.timeline[A.traceControls.current]),P(A.historyMap.startMarker),A.traceControls.updateAllTimelines(A.traceControls.timeline[A.traceControls.current].gpstime))},A.traceControls.updateAllTimelines=function(e){w(e);for(var t in A.tcGraphs.charts)A.tcGraphs.charts[t].object.updateLine(e,A.tcGraphs.charts[t])};var P=function(e){if(null!=e){var t=A.historyMap.map,n=t.getProjection(),a=n.fromLatLngToPoint(t.getCenter()),i=Math.pow(2,t.getZoom()),o=n.fromLatLngToPoint(e.getPosition()),r=Math.abs((o.x-a.x)*i),s=Math.abs((o.y-a.y)*i),l=Math.floor((o.x-a.x)*i),c=Math.floor((o.y-a.y)*i);(r>500||s>200)&&t.panBy(l,c)}};A.traceControls.mouseMoveEvent=function(e){var t=A.traceControls.timeline.length,n=A.traceControls.panel.element.width(),a=A.traceControls.panel.element.offset().left;0>a&&(a=0),A.traceControls.current=parseInt((e.pageX-a)*t/n)+1,A.traceControls.current>=A.traceControls.timeline.length&&(A.traceControls.current=A.traceControls.timeline.length-1),A.traceControls.moveTimeline()},A.traceControls.speedThreshold=3,A.traceControls.graphBase=0,A.traceControls.barHeight=7,A.traceControls.barMargin=1,A.traceControls.barBase=0,A.traceControls.myCanvas=null,A.traceControls.ctx,A.traceControls.cw,A.traceControls.ch,A.traceControls.wr,A.getPopLeft=function(){return null==A.traceControls.myCanvas?0:A.traceControls.current*A.traceControls.wr+$(A.traceControls.myCanvas).offset().left+"px"},A.gotHistoryEvent=function(e,t){A.gotHistory=a.getData("getHistory"),A.gotData=!0,A.loadingData=!1,g(),f(t),S()},A.gotHistoryEventFailed=function(){A.gotData=!1,A.loadingData=!1,A.gotHistory=a.getData("getHistory"),g()},A.getCurrentPos=function(){return A.traceControls.timeline[A.traceControls.current]},A.historyFenceWindowLoad=function(){e.$apply(function(){m(document.getElementById("historyFenceWindow"))(e)})},A.getMyFencesListener=function(e){e.polygons&&A.createPolygons(e.polygons),e.circles&&A.createCircles(e.circles)},A.createPolygons=function(e){for(var t in e)google.maps.event.addListener(e[t].googleObject,"click",function(e){A.selectedFenceObj=this,D.setContent(document.getElementById("history_fence_infowindow").innerHTML),D.setPosition(e.latLng),D.open(A.historyMap.map,this)})},A.createCircles=function(e){for(var t in e)google.maps.event.addListener(e[t].googleObject,"click",function(e){A.selectedFenceObj=this,D.setPosition(e.latLng),D.setContent(document.getElementById("history_fence_infowindow").innerHTML),D.open(A.historyMap.map,this)}),e[t].googleObject.setMap(A.historyMap.map)},A.toggleExpandedGraphs=function(e){"toggle"==e?"full"==A.traceControls.expandedGraphs?A.traceControls.expandedGraphs="half":A.traceControls.expandedGraphs="full":"close"==e&&(0==A.traceControls.expandedGraphs?A.traceControls.expandedGraphs="half":A.traceControls.expandedGraphs=!1),l(function(){M(),P(A.historyMap.startMarker)},1e3)},A.tcGraphs={mouseclicked:!1,margin:{left:35,right:35,top:20,bottom:20},charts:[{data:{svg:"#visualisation-parent",parent:!0,margin:{left:0,right:0,top:0,bottom:0}},graphs:[{color:"#e74c3c",key:"Speed",type:"line",item:"speed",unit:"kmph",yAxis:1}]},{data:{svg:"#visualisation1"},graphs:[{color:"#e74c3c",key:"Speed",type:"line",item:"speed",unit:"kmph",yAxis:1}]},{data:{svg:"#visualisation2"},graphs:[{color:"#3498db",key:"Vehicle battery",type:"line",item:"carbattery",unit:"v",yAxis:1},{color:"#e74c3c",key:"Device battery",type:"line",item:"devbattery",unit:"v",yAxis:2}]},{data:{svg:"#visualisation3"},graphs:[{color:"#2ecc71",key:"GPS Signal",type:"line",item:"numsat",unit:"",yAxis:1}]}]},A.tcGraphs.zoom=function(e){a.setTime(A.tcGraphs.zoomStart,A.tcGraphs.zoomEnd),A.traceControls.startIndex=C(A.traceControls.timeline,A.tcGraphs.zoomStart,"gpstime"),A.traceControls.current=angular.copy(A.traceControls.startIndex),A.traceControls.endIndex=C(A.traceControls.timeline,A.tcGraphs.zoomEnd,"gpstime");var t=angular.copy(A.traceControls.timeline);if(a.drawPolylines(t,A.traceControls.startIndex,A.traceControls.endIndex),e){var i=e.x1,o=e.x2,r=A.tcGraphs.zoomStart-i,s=A.tcGraphs.zoomEnd-o;n(function(){i+=r/4,o+=s/4;for(var e in A.tcGraphs.charts)A.tcGraphs.charts[e].object.xScale.domain([new Date(i),new Date(o)]),A.tcGraphs.charts[e].object.redraw()},10,4)}else for(var l in A.tcGraphs.charts)A.tcGraphs.charts[l].object.xScale.domain([new Date(A.tcGraphs.zoomStart),new Date(A.tcGraphs.zoomEnd)]),A.tcGraphs.charts[l].object.redraw()},A.tcGraphs.seekGraph=function(e){if(A.tcGraphs.zoomEnd){var t=A.tcGraphs.charts[0].object,n=t.axisScale.xh,a=t.axisScale.xl,i=(A.tcGraphs.zoomEnd-A.tcGraphs.zoomStart)/2;1==e?A.tcGraphs.zoomEnd+i>n&&(i=n-A.tcGraphs.zoomEnd):(A.tcGraphs.zoomStart-i<a&&(i=A.tcGraphs.zoomStart-a),i*=-1),i=parseInt(i);var o={x1:A.tcGraphs.zoomStart,x2:A.tcGraphs.zoomEnd};A.tcGraphs.zoomEnd+=i,A.tcGraphs.zoomStart+=i;var r=A.tcGraphs.zoomStart-o.x1,s=A.tcGraphs.zoomEnd-o.x2;if(3e3>r&&3e3>s&&1==e||r>-3e3&&s>-3e3&&1>e)return;A.tcGraphs.zoom(o)}},A.tcGraphs.restoreGraph=function(){a.setTime(A.tcGraphs.charts[0].object.axisScale.xl,A.tcGraphs.charts[0].object.axisScale.xh),A.tcGraphs.zoomEnd=null,A.traceControls.startIndex=0,A.traceControls.endIndex=A.traceControls.timeline.length,a.drawPolylines(A.traceControls.timeline,A.traceControls.startIndex,A.traceControls.endIndex);for(var e in A.tcGraphs.charts)A.tcGraphs.charts[e].object.xScale.domain([new Date(A.tcGraphs.charts[e].object.axisScale.xl),new Date(A.tcGraphs.charts[e].object.axisScale.xh)]),A.tcGraphs.charts[e].object.redraw()},A.init=function(){u(),b(),k(),e.$on("gotHistoryEvent",A.gotHistoryEvent),e.$on("gotHistoryEventFailed",A.gotHistoryEventFailed),A.gotHistory=a.getData("getHistory");var t=e.getMatches(s.filterStr);t.length>0&&(A.historyMap.selectedVehicle=t[0]),A.gotHistory?a.drawTrace():i&&i.mapObj&&i.mapObj.clickedMarker?A.historyMap.selectedVehicle=i.mapObj.clickedMarker:v(),g(),d.addListener("getMyFences",A.getMyFencesListener),a.addListener("loadMap",u),D.addListener("domready",function(){A.historyFenceWindowLoad()})},A.init()}function t(e,t,n,a,i,o,r){function s(e,t){for(var n in e){var a=e[n].lat()+","+e[n].lng(),i=new Date(e[n].gpstime),o=e[n].ignstatus?"On":"Off",r="<span class='latlng loc"+n+"' data-content='Fetching Address'>"+a+"</span>";t.length&&(r=a=t[n]),u.push([i,e[n].odometer.toString(),e[n].speed.toString(),o,r]),c.jsonHistoryData.push({vehicle_Name:c.historyMap.selectedVehicle.rtgps.vehicleno,time:moment(i).format(p),odometer:e[n].odometer.toString(),speed:e[n].speed.toString(),ignitionStatus:o,location:a})}google.charts.load("current",{packages:["table"]}),google.charts.setOnLoadCallback(l),c.disableDownload=!1,c.showLoading=!1}function l(){d=new google.visualization.Table(g),google.visualization.events.addListener(d,"ready",function(){c.convertLatLngToAddr||($(".latlng").webuiPopover({trigger:"hover",width:300,animation:"pop"}),$(".latlng").hover(function(){var e=$(this).attr("class");e=e.split(" ");var t=$(this).text();c.getAddress(t,e[1]).then(function(e){for(var t in e)if(e[t][1]){var n=e[t][1];return $("."+c.myclass).attr("data-content",n),void WebuiPopovers.updateContent("."+c.myclass,n)}},function(e){n.log(e)})}))}),m=new google.visualization.DataTable,m.addColumn("datetime","Time"),m.addColumn("string","Odometer"),m.addColumn("string","Speed"),m.addColumn("string","IgnitionStatus"),m.addColumn("string","Location"),m.addRows(u);var e=new google.visualization.DateFormat({pattern:"d MMM, h:mm a"});e.format(m,0),d.draw(m,{showRowNumber:!0,page:"enable",width:"100%",height:"100%",pageSize:300,allowHtml:!0,alternatingRowStyle:!0})}n.log("HistoryTableController");var c=this;a.setTab(1);var d,m,p="DD-MM-YYYY HH:mm",u=[],g=document.getElementById("geo-table");c.jsonHistoryData=[],c.historyMap=o.historyMap,c.multiSelect=c.historyMap.multiSelect,c.disableDownload=!0,c.showLoading=!1,c.convertLatLngToAddr=!0,t.getHistory=function(){o.setData("getHistory",!1),u=[],c.jsonHistoryData=[],c.disableDownload=!0,c.showLoading=!0,d&&d.clearChart(g),o.getHistoryData()},e.$on("gotHistoryEvent",function(e,t){null!=g&&c.showTableData()}),c.getAddress=function(e,t){return"string"==typeof e&&(e=[e.split(",")],c.myclass=t),i.geocodeService.getAddress(e)},c.showTableData=function(){var e=c.historyMap.traceObj;u=[];var t=[];for(var a in e)t.push([e[a].lat(),e[a].lng()]);var i=[];null!=e&&(c.convertLatLngToAddr?c.getAddress(t).then(function(t){for(var n in t)i.push(t[n][1]);s(e,i)},function(e){n.log(e)}):s(e,i))},t.downloadFile=function(){i.importFileservice.JSONToCSVConvertor(c.jsonHistoryData,"Vehicles History Report",!0)},c.init=function(){c.historyMap.traceObj.length&&(c.showTableData(),c.disableDownload=!1)},c.init()}e.$inject=["$scope","$window","$interval","historyService","$stateParams","$log","vehicleService","mapService","$timeout","dialogService","geofenceViewService","$compile"],t.$inject=["$rootScope","$scope","$log","dialogService","intellicarAPI","historyService","$q"],angular.module("uiplatform").controller("HistoryController",e).controller("HistoryTableController",t)}(),function(){"use strict";function e(e,t,n,a,i){var o=this;o.toolbar=!0,o.listeners={},o.geoData={},o.circles=[],o.polygons=[],o.fences={circles:o.circles,polygons:o.polygons},o.getToolbarVar=function(){return o.toolbar},o.hide=function(){o.toolbar=!1},o.show=function(){o.toolbar=!0},o.getService=function(e){return"geofences"==e?i:void 0},o.handleFences=function(e){t.log(e)};var r="blue";o.getDefaultCircle=function(){return{center:{},radius:0,strokeColor:r,strokeWeight:2,strokeOpacity:1,fillColor:r,fillOpacity:.2,clickable:!0,visible:!0,control:{}}},o.getDefaultPolygon=function(){return{path:[],strokeColor:r,strokeWeight:3,fillColor:r,fillOpacity:.2,clickable:!0,visible:!0,control:{}}},o.getPolygonFromInfo=function(e){var t=o.getDefaultPolygon();for(var n in e.vertex){var a=e.vertex[n];t.path.push({latitude:a.lat,longitude:a.lng})}return t},o.getCircleFromInfo=function(e){var t=o.getDefaultCircle();return t.center={latitude:e.fencecenter.lat,longitude:e.fencecenter.lng},t.radius=e.fenceradius,t},o.drawFences=function(){return o.fences={circles:o.circles,polygons:o.polygons},o.callListeners("getMyFences",o.fences),o.fences},o.getToDrawFences=function(){return o.fences},o.applyFilters=function(e){o.callListeners("applyFilters",{filterType:e})},o.readFenceInfo=function(e){o.circles=[],o.polygons=[],o.endTime=(new Date).getTime();for(var t in e){var n=e[t];o.createFenceObjects(n)}return o.drawFences()},o.createFenceObjects=function(e){if("info"in e){e.tagdata=JSON.parse(e.tagdata);for(var t in e.info){var n=e.info[t];if(n.settingsdata=JSON.parse(n.settingsdata),"GEOFENCE_BOUNDARY"==n.settingstag)if("polygon"==n.settingsdata.fencetype){var a=o.getPolygonFromInfo(n.settingsdata);a.control.info=e,o.polygons.push(a)}else if("circle"==n.settingsdata.fencetype){var i=o.getCircleFromInfo(n.settingsdata);i.control.info=e,o.circles.push(i)}}}},o.fetchFences=function(e){var t=[];for(var i in e){var r={geofencepath:e[i].assetpath};t.push(a.geofenceService.getFenceInfoMap(r))}return n.all(t).then(o.readFenceInfo,o.handleFailure)},o.handleFailure=function(e){t.log(e)},o.getMyFences=function(){return o.startTime=(new Date).getTime(),a.userService.getMyFencesMap({}).then(o.fetchFences,o.handleFailure)},o.getMyFenceInfos=function(){return o.startTime=(new Date).getTime(),a.userService.getMyFenceInfosMap({}).then(o.readFenceInfo,o.handleFailure)},o.addListener=function(e,t){e in o.listeners||(o.listeners[e]=[]),-1===o.listeners[e].indexOf(t)&&o.listeners[e].push(t)},o.callListeners=function(e,t){if(e in o.listeners)for(var n in o.listeners[e])o.listeners[e][n](t)},o.setData=function(e,t){o.geoData[e]=t},o.getData=function(e){return o.geoData.hasOwnProperty(e)?o.geoData[e]:null},o.downloadView=function(t){e.$broadcast("downloadView",t)},o.fitBounds=function(t){e.$broadcast("fitBounds",t)}}e.$inject=["$rootScope","$log","$q","intellicarAPI","geofenceReportService"],angular.module("uiplatform").service("geofenceViewService",e)}(),function(){function e(e,t,n,a,i,o,r,s,l){function c(e,t){var n=e;if(e=e.split("."),e.length<=1){e=e[0];for(var a in p.leftTB)p.leftTB.hasOwnProperty(a)&&p.leftTB[a].id==e&&(p.leftTB[a].data.active=t,d(p.leftTB[a].id,t));
}else for(var i=0;i<p.leftTB.length;i++)if(p.leftTB[i].id==e[0])for(var a in p.leftTB[i].children)p.leftTB[i].children.hasOwnProperty(a)&&p.leftTB[i].children[a].id==n&&(p.leftTB[i].children[a].data.active=t,d(p.leftTB[i].children[a].id,t))}function d(e,t){e=e.split("."),e=e[e.length-1],p.geoFilters[e]=t}function m(e){e=e.split("."),e=e[e.length-1],s.applyFilters(e)}var p=this;p.leftToolbar=function(){return s.getToolbarVar()},p.toggleBar=function(){p.leftToolbar()?s.hide():s.show()},p.loc=i.loc,p.currentLocation=i.getCurrentLocation().id,p.setInMarkerLocation=function(e){p.currentLocation=e.id,i.setInMapLocation(e.latlng)},p.leftTB=[{id:"geoReport",name:"Reports",iconType:"fa",icon:"fa-bar-chart",type:"button",historymap:!1,data:{type:"stateChange",independent:!0,state:"home.history",active:!0}},{type:"line",historymap:!1},{id:"setLocation",name:!1,iconType:"fa",icon:"fa-map-marker",type:"button",historymap:!0,data:{type:"function",independent:!0,"function":function(e){}},childType:"location",children:i.locations},{id:"setGeoFilter",name:!1,iconType:"png",icon:"assets/images/icon/fence",type:"button",historymap:!0,data:{type:"function",independent:!0,"function":function(e){}},childType:"button",children:[{id:"setGeoFilter.showAll",name:"Show All",iconType:"fa",icon:"fa-eye",type:"toggleButton",historymap:!0,data:{active:!0,type:"function","function":function(e){p.checkGeoFilters.all("setGeoFilter.showAll")}}},{id:"setGeoFilter.parkingLot",name:"Parking Lot",iconType:"md",icon:"local_parking",type:"toggleButton",historymap:!0,data:{active:!0,type:"function","function":function(e){p.checkGeoFilters.set("setGeoFilter.parkingLot",e)}}},{id:"setGeoFilter.serviceStation",name:"Service Station",iconType:"fa",icon:"fa-wrench",type:"toggleButton",historymap:!0,data:{active:!0,type:"function","function":function(e){p.checkGeoFilters.set("setGeoFilter.serviceStation",e)}}},{id:"setGeoFilter.competitorHub",name:"Competitor Hub",iconType:"fa",icon:"fa-ban",type:"toggleButton",historymap:!0,data:{active:!0,type:"function","function":function(e){p.checkGeoFilters.set("setGeoFilter.competitorHub",e)}}},{id:"setGeoFilter.cityLimits",name:"City Limits",iconType:"fa",icon:"fa-road",type:"toggleButton",historymap:!0,data:{active:!1,type:"function","function":function(e){p.checkGeoFilters.set("setGeoFilter.cityLimits",e)}}},{id:"setGeoFilter.getGeo",description:"Use only when new fences are created",name:"Refresh Geofences",iconType:"fa",icon:"fa-globe",type:"button",historymap:!0,data:{active:!0,type:"function","function":function(){}}}]},{id:"batteryFilter",name:!1,iconType:"fa",icon:"fa-exclamation-triangle",type:"button",historymap:!1,data:{type:"function",independent:!0,"function":function(e){}},childType:"button",children:[{id:"batteryFilter.devBattery",name:"Low Device battery",iconType:"fa",icon:"fa-battery-quarter",type:"toggleButton",historymap:!1,data:{active:!1,type:"function",independent:!0,"function":function(e){p.checkGeoFilters.set("batteryFilter.devBattery",e)}}},{id:"batteryFilter.carBattery",name:"Low Vehicle battery",iconType:"png",icon:"assets/images/icon/carBattery",type:"toggleButton",historymap:!1,data:{active:!1,type:"function",independent:!0,"function":function(e){p.checkGeoFilters.set("batteryFilter.carBattery",e)}}},{id:"batteryFilter.noComm",name:"Vehicles not communicating",iconType:"png",icon:"assets/images/icon/signal",type:"toggleButton",historymap:!1,data:{active:!1,type:"function",independent:!0,"function":function(e){p.checkGeoFilters.set("batteryFilter.noComm",e)}}}]},{type:"line",historymap:!1},{id:"showVehicleNo",name:"Vehicle number",iconType:"fa",icon:"fa-car",type:"toggleButton",historymap:!1,data:{active:!1,type:"function",independent:!0,"function":function(e){p.checkGeoFilters.set("showVehicleNo",e),s.showVehicleNumber(e)}}},{id:"fitBounds",name:"Zoom to fit view",iconType:"fa",icon:"fa-crosshairs",type:"button",historymap:!1,data:{active:!1,type:"function",independent:!0,"function":function(e){p.checkGeoFilters.set("fitBounds",!1),s.fitBounds(!1)}}},{type:"line",historymap:!1},{id:"downloadView",name:"Download View",iconType:"fa",icon:"fa-download",type:"toggleButton",historymap:!1,data:{active:!1,type:"function",independent:!0,"function":function(e){p.checkGeoFilters.set("downloadView",!1),s.downloadView(!1)}}}],p.fencesActive=function(){return s.getData("geofences")},p.childClick=function(e,t){"location"==t?(p.currentLocation=e.id,"home.history"==r.current.name?o.setInMapLocation(e.latlng):i.setInMapLocation(e.latlng)):"button"==t&&e()},p.init=function(){s.getMyFenceInfos(),p.geoFilters=s.getData("geoFilters");for(var e in p.geoFilters)p.geoFilters[e]?c(e,!0):c(e,!1)},p.checkGeoFilters={all:function(e){var t=!0;p.geoFilters.showAll&&(t=!1),c("setGeoFilter.showAll",t),c("setGeoFilter.competitorHub",t),c("setGeoFilter.serviceStation",t),c("setGeoFilter.parkingLot",t),m(e)},check:function(){p.geoFilters.parkingLot&&p.geoFilters.serviceStation&&p.geoFilters.competitorHub?c("setGeoFilter.showAll",!0):c("setGeoFilter.showAll",!1)},set:function(e,t){c(e,t),p.checkGeoFilters.check(),m(e)}},p.buttonClick=function(e){"stateChange"==e.data.type?l.show(e.data.state):"function"==e.data.type&&(p.fencesActive()||e.data.independent)&&(e.data.active=!e.data.active,e.data["function"](e.data.active,e.location))},p.init()}e.$inject=["$scope","$log","$timeout","$q","mapService","historyService","$state","geofenceViewService","dialogService"],angular.module("uiplatform").controller("GeofenceViewController",e)}(),function(){"use strict";function e(e,t,n){e.log("geofenceReportService");var a=this;a.listeners={},a.reports={},a.getMyGeofenceReports=function(){return a.reports},a.handleFailure=function(n){return e.log("handleFailure"),t.reject(n)},a.handleGeofenceReportInfoMap=function(n){e.log("geofenceReportService");for(var i in n){var o=n[i];a.reports[o.assetpath]=o}return a.callListeners(a.reports,"mygeofencereportsinfo"),t.resolve(a.reports)},a.handleMyGeofenceReportsMap=function(e){a.reportList=e;var i=[];for(var o in a.reportList){var r={geofencereportpath:a.reportList[o].assetpath};i.push(n.fenceReportService.getGeofenceReportInfoMap(r))}return t.all(i).then(a.handleGeofenceReportInfoMap,a.handleFailure)},a.getMyGeofenceReportsMap=function(){return n.userService.getMyGeofenceReportsMap({}).then(a.handleMyGeofenceReportsMap,a.handleFailure)},a.addListener=function(e,t){e in a.listeners||(a.listeners[e]=[]),-1===a.listeners[e].indexOf(t)&&a.listeners[e].push(t)},a.callListeners=function(e,t){if(t in a.listeners)for(var n in a.listeners[t])a.listeners[t][n](e,t)},a.init=function(){a.getMyGeofenceReportsMap()},a.reportDetails={reportId:1233},a.setReportPath=function(e){a.reportDetails.reportId=e},a.getReportDetails=function(){return a.reportDetails},a.init()}e.$inject=["$log","$q","intellicarAPI"],angular.module("uiplatform").service("geofenceReportService",e)}(),function(){function e(e,t,n,a,i,o,r,s,l,c){function d(){var t=new google.visualization.DataTable;t.addColumn("string","Vehicles"),t.addColumn("string","Fence"),t.addColumn("datetime","Fence Entry"),t.addColumn("datetime","Fence Exit"),t.addRows(s.geoFenceReports.myHistoryData);var n=new google.visualization.DateFormat({pattern:"d MMM, h:mm a"});n.format(t,2),n.format(t,3);var a=new google.visualization.Table(document.getElementById("geo-table"));a.draw(t,{showRowNumber:!0,width:"100%",page:"enable",pageSize:300}),google.visualization.events.addListener(a,"select",function(n){e.log(a.getSelection()),e.log(t.getValue(a.getSelection()[0].row,0));var o=t.getValue(a.getSelection()[0].row,0);if(o){var r=i("filter")(l.inMap.markers.inMarkers,o),d="YYYY-MM-DD HH:mm",m=moment(t.getValue(a.getSelection()[0].row,2)).subtract(1,"hour").format(d),p=moment(t.getValue(a.getSelection()[0].row,3)).add(1,"hour").format(d);s.historyMapObj.startTime=m,s.historyMapObj.endTime=p;var u={clickedMarker:r[0]};c.go("home.history",{mapObj:u})}})}e.log("GeofenceReportController"),n.setTab(2);var m=this,p="DD-MM-YYYY HH:mm";m.fenceReportObj=s.geoFenceReports,m.startTime=m.fenceReportObj.startTime,m.endTime=m.fenceReportObj.endTime,m.disableDownload=!1,m.setSelectedCount=function(e){"vehicle"==e?m.fenceReportObj.filteredItems.length&&(m.fenceReportObj.selectedVehiclesCount=i("filter")(m.fenceReportObj.filteredItems,{checked:!0}).length):m.fenceReportObj.filteredFenceItems.length&&(m.fenceReportObj.selectedFencesCount=i("filter")(m.fenceReportObj.filteredFenceItems,{checked:!0}).length)},m.filterVehicles=function(){m.fenceReportObj.filteredItems=i("filter")(m.fenceReportObj.currRep.vehicles,m.fenceReportObj.vehicleFilter)},m.filterFences=function(){m.fenceReportObj.filteredFenceItems=i("filter")(m.fenceReportObj.currRep.fences,m.fenceReportObj.fenceFilter)},m.getSelectedFences=function(e){m.fenceReportObj.reportId=e.assetpath,m.setReport(e),m.getHistoryReport()},m.setReport=function(e){m.fenceReportObj.currRep={},m.fenceReportObj.currRep.vehicles=[],m.fenceReportObj.currRep.fences=[];for(var t in e.assg){var n={id:e.assg[t].assetpath,name:e.assg[t].name,checked:!0};4==e.assg[t].assgfromassetid?m.fenceReportObj.currRep.vehicles.push(n):15==e.assg[t].assgfromassetid&&m.fenceReportObj.currRep.fences.push(n)}m.fenceReportObj.filteredItems=m.fenceReportObj.currRep.vehicles,m.fenceReportObj.filteredFenceItems=m.fenceReportObj.currRep.fences,m.SelectAllFences=!0,m.selectAllVehicles=!0,m.deSelectAllFences=!1,m.deSelectAllVehicles=!1,m.setSelectedCount("fence"),m.setSelectedCount("vehicle")},m.getHistory=function(e){n.setData(e,"selectedVehicle"),n.show("home.history")},m.handleFailure=function(t){e.log("handleFailure"),e.log(t),m.loadingHistoryData=!1},m.getMyGeofenceReports=function(e){if(m.initialSelect){m.initialSelect=!1,m.fenceReportObj.reports=a.getMyGeofenceReports();for(var t in m.fenceReportObj.reports)return m.getSelectedFences(m.fenceReportObj.reports[t])}},m.getMyGeofenceReportsMap=function(){a.getMyGeofenceReportsMap().then(m.getMyGeofenceReports,m.handleFailure)},m.selectAll=function(e){var t;if("vehicle"==e){for(var n in m.fenceReportObj.filteredItems)t=m.fenceReportObj.filteredItems,m.fenceReportObj.filteredItems[n].checked=m.selectAllVehicles;m.deSelectAllVehicles=!m.selectAllVehicles,m.setSelectedCount("vehicle")}else if("fence"==e){t=m.fenceReportObj.filteredFenceItems;for(var n in m.fenceReportObj.filteredFenceItems)m.fenceReportObj.filteredFenceItems[n].checked=m.selectAllFences;m.fenceReportObj.selectedFencesCount=m.fenceReportObj.filteredFenceItems.length,m.deSelectAllFences=!m.selectAllFences,m.setSelectedCount("fence")}},m.deSelectAll=function(e){if("vehicle"==e){for(var t in m.fenceReportObj.filteredItems)m.fenceReportObj.filteredItems[t].checked=!1;m.selectAllVehicles=!1,m.setSelectedCount("vehicle")}else if("fence"==e){for(var t in m.fenceReportObj.filteredFenceItems)m.fenceReportObj.filteredFenceItems[t].checked=!1;m.selectAllFences=!1,m.setSelectedCount("fence")}},m.verifyCheckStatus=function(e){if("vehicle"==e){var t=i("filter")(m.fenceReportObj.currRep.vehicles,{checked:!0});t.length?m.deSelectAllVehicles=!1:m.deSelectAllVehicles=!0,t.length<m.fenceReportObj.currRep.vehicles.length?m.selectAllVehicles=!1:t.length==m.fenceReportObj.currRep.vehicles.length&&(m.selectAllVehicles=!0)}else if("fence"==e){var t=i("filter")(m.fenceReportObj.currRep.fences,{checked:!0});t.length?m.deSelectAllFences=!1:m.deSelectAllFences=!0,t.length<m.fenceReportObj.currRep.fences.length?m.selectAllFences=!1:t.length==m.fenceReportObj.currRep.fences.length&&(m.selectAllFences=!0)}m.setSelectedCount(e)},m.getHistoryReport=function(){s.geoFenceReports.myHistoryData=[],s.geoFenceReports.jsonReportData=[],m.disableDownload=!0;var e=angular.element(document.querySelector("#geo-table"));if(e.empty(),m.errorMsg="",m.fenceReportObj.startTime&&m.fenceReportObj.endTime){m.selectedVehicles=[],m.selectedFences=[];var n=[];m.vehicleids=[];for(var a in m.fenceReportObj.filteredItems)m.fenceReportObj.filteredItems[a].checked&&(m.selectedVehicles.push(m.fenceReportObj.filteredItems[a]),m.vehicleids.push(m.fenceReportObj.filteredItems[a].id));m.selectedFences=i("filter")(m.fenceReportObj.filteredFenceItems,{checked:!0});var o=new Date(1e3*moment(m.fenceReportObj.startTime).unix()).getTime(),l=new Date(1e3*moment(m.fenceReportObj.endTime).unix()).getTime();if(o>=l)return void(m.errorMsg="End time should be >= Start time");if(!m.vehicleids.length)return void(m.errorMsg="Select atleast one vehicle");m.loadingHistoryData=!0;var c={fencereport:m.fenceReportObj.reportId,vehicles:m.vehicleids,starttime:new Date(o).getTime()/1e3,endtime:new Date(l).getTime()/1e3};return n.push(r.geofenceService.getReportHistory(c)),t.all(n).then(m.readHistoryInfo,m.handleFailure)}return void(m.errorMsg="Enter valid start and end time")},m.downloadFile=function(){r.importFileservice.JSONToCSVConvertor(s.geoFenceReports.jsonReportData,"Vehicles Fence Report",!0)},m.readHistoryInfo=function(e){var t=e[0].data.data;if(!t.length)return m.loadingHistoryData=!1,void(m.disableDownload=!1);for(var n in t){for(var a in m.selectedVehicles)if(t[n].deviceid==m.selectedVehicles[a].id)var i=m.selectedVehicles[a].name;for(var o in m.selectedFences){var r=m.selectedFences[o].name;if(t[n].fencepath==m.selectedFences[o].id){var l=parseInt(t[n].fentry),c=parseInt(t[n].fexit);if(c>l&&c-l>18e4){var d=new Date(l),u=new Date(c);s.geoFenceReports.myHistoryData.push([i,r,d,u]),s.geoFenceReports.jsonReportData.push({vehicle_name:i,fence_name:r,fence_entry:moment(d).format(p),fence_exit:moment(u).format(p)}),m.disableDownload=!1}break}}}m.disableDownload=!1,m.loadingHistoryData=!1,m.showTableData()},m.showTableData=function(){google.charts.load("current",{packages:["table"]}),google.charts.setOnLoadCallback(d)},m.init=function(){s.geoFenceReports.myHistoryData.length?(m.initialSelect=!1,m.showTableData()):m.initialSelect=!0,a.addListener("mygeofencereportsinfo",m.getMyGeofenceReports),m.getMyGeofenceReports(),m.disableDownload=s.geoFenceReports.jsonReportData.length?!1:!0},m.init()}e.$inject=["$log","$q","dialogService","geofenceReportService","$filter","$timeout","intellicarAPI","historyService","mapService","$state"],angular.module("uiplatform").controller("GeofenceReportController",e)}(),function(){function e(e,t,n,a,i,o,r){function s(e){var t=[];for(var n in e)if(t.length>0){var a=!1;for(var i in t)if(t[i].assetpath.split("/").length>e[n].assetpath.split("/").length){t.splice(parseInt(i),0,e[n]),a=!0;break}a||t.push(e[n])}else t.push(e[n]);return t}function l(){n.getGPSLastseen({grouppath:c.selectedGroup.assetpath,recursive:1}).then(c.handleSuccess,c.handleFailure)}var c=this;e.setTab(4),c.showLoading=!1,t.getMyAssignedGroupsMap({}).then(function(e){c.groups=s(e),c.selectedGroup=c.groups[0]}),c.download=function(){l(),c.showLoading=!0,c.errorMsg=null},c.handleFailure=function(e){r.log(e.data.msg),e.data.msg&&(c.errorMsg=e.data.msg),c.showLoading=!1},c.handleSuccess=function(e){function t(e,t){var n=[];for(var a in e)n.push([e[a].lat,e[a].lng]);i.geocodeService.getAddress(n).then(function(e){t(e)})}r.log(e.data.msg),e.data.msg&&(c.errorMsg=e.data.msg);var n="DD-MM-YYYY HH:mm",s=e.data.data,l=[];for(var d in s){var m=moment.unix(s[d].utctime/1e3).format(n)+" ",p="ATTATCHED";s[d].carb<1&&(p="PULLOUT");var u="ACTIVE";1==s[d].mobili&&(u="IMMOBILIZED");var g="Live",h=(new Date).getTime(),v=s[d].utctime,f=a.noCommThreshold;h-v>f&&(g="No Comm");var y=moment.unix(s[d].gpstime/1e3).format(n)+" ";l.push({"VEHICLE NO":s[d].vehicleno,"LAST COMM AT":m,"PULL OUT":p,MOBILITY:u,COMMUNICATION:g,"GPS TIME":y})}t(s,function(e){for(var t in l)l[t].ADDRESS=e[t][1],l[t]["LAT LNG"]=s[t].lat+", "+s[t].lat;i.importFileservice.JSONToCSVConvertor(l,"Vehicles History Report",!0),o(function(){c.showLoading=!1},1e3)}),c.showLoading=!1}}e.$inject=["dialogService","userService","reportsService","vehicleService","intellicarAPI","$timeout","$log"],angular.module("uiplatform").controller("DownloadHistoryController",e)}(),function(){"use strict";function e(e,t,n){function a(){$(".int-dialog").fadeIn(300),i.dialogShow=!0}e.log("dialogService");var i=this;i.dialogShow=!1;var o=["home.geofence","home.historyData","home.history","home.alarm","home.downloadHistory","home.gridTest"];i.getData=function(e){return i[e]},i.setData=function(e,t){i[t]=e},i.show=function(e,n){t.go(e,{mapObj:n}),a()},i.hide=function(){t.go("home"),i.dialogShow=!1,$(".int-dialog").fadeOut(300)},i.getDialogShow=function(){return i.dialogShow},i.setDialogShow=function(e){i.dialogShow=e},i.setTab=function(e){i.setTabListener(e)},i.addSetTabListener=function(e){i.setTabListener=e},i.init=function(){for(var e=0;e<o.length;e++)t.current.name==o[e]&&a()},i.init()}function t(){function e(e){return{id:e,count:0,start_time:t(),end_time:0}}function t(){return performance.now()}var n=this;n.tracking=!0,n.trackArray=[],n.track=function(a){n.tracking&&(a in n.trackArray&&0==n.trackArray[a].end_time?(n.trackArray[a].end_time=t(),n.trackArray[a].diff=n.trackArray[a].end_time-n.trackArray[a].start_time):n.trackArray[a]=e(a))}}e.$inject=["$log","$state","$cookies"],angular.module("uiplatform").service("dialogService",e).service("cpuService",t)}(),function(){"use strict";function e(e){var t,n=this;n.markerHeight=12,n.markerWidth=12,n.CustomMarker=function(e,t,n,a){var i=this;i.latlng=new google.maps.LatLng(e,t),i.args=a,i.map=n,i.setMap(n),i.dropAnimation=!1,i.hide=function(){i.div&&(i.div.style.display="none")},i.show=function(){i.div&&(i.div.style.display="block")},i.hideVehicleNumber=function(){i.vehicleNumberWindow.style.display="none"},i.showVehicleNumber=function(){i.vehicleNumberWindow.style.display="block"}},n.CustomMarker.prototype=new google.maps.OverlayView,n.CustomMarker.prototype.setPosition=function(e){var t=this;t.latlng=new google.maps.LatLng(e.latitude,e.longitude),t.getProjection()&&(t.point=t.getProjection().fromLatLngToDivPixel(t.latlng),t.point&&t.div&&(t.div.style.left=t.point.x-n.markerWidth/2+"px",t.div.style.top=t.point.y-n.markerHeight/2+"px"))},n.CustomMarker.prototype.unhighlight=function(){var e=this;e.hide(),e.notifier.className="overlayNotifier",e.dropAnimation=!1},n.CustomMarker.prototype.highlight=function(e){var t=this;e=null!=e?"-anim-color-"+e:"",t.show(),t.notifier.className="overlayNotifier animate "+e,t.dropAnimation=!0},n.CustomMarker.prototype.highlightMe=function(e){var t=this;e=null!=e?"-anim-color-"+e:"",t.notifier&&(t.dropAnimation?(t.hide(),t.notifier.className="overlayNotifier",t.dropAnimation=!1):(t.show(),t.notifier.className="overlayNotifier animate "+e,t.dropAnimation=!0))},n.CustomMarker.prototype.draw=function(){var e=this;if(!e.div){e.div=document.createElement("div"),e.vehicleNumberWindow=document.createElement("div"),e.notifier=document.createElement("span"),e.div.className="customMarker",e.div.style.position="absolute",e.div.style.display="none",e.div.style.cursor="pointer",e.vehicleNumberWindow.className="vehicleNumberWindow",t='<input type="text" value="'+e.args.marker.vehicleno+'" readonly/> <div class="vnw-close">x</div>',e.vehicleNumberWindow.innerHTML=t,e.vehicleNumberWindow.style.display="none",e.notifier.className="overlayNotifier",e.div.appendChild(e.vehicleNumberWindow),e.div.appendChild(e.notifier),google.maps.event.addDomListener(e.div.querySelector(".vnw-close"),"click",function(t){e.hideVehicleNumber()}),google.maps.event.addDomListener(e.div.querySelector("input"),"click",function(e){this.select(),console.log("clicked!")});var a=this.getPanes();a.overlayImage.appendChild(e.div)}this.point=this.getProjection().fromLatLngToDivPixel(this.latlng),this.point&&(e.div.style.left=this.point.x-n.markerWidth/2+"px",e.div.style.top=this.point.y-n.markerHeight/2+"px")},n.CustomMarker.prototype.remove=function(){this.div&&(this.div.parentNode.removeChild(this.div),this.div=null)},n.CustomMarker.prototype.getPosition=function(){return this.latlng}}e.$inject=["$log"],angular.module("uiplatform").service("customMapOverlay",e)}(),function(){"use strict";function e(e,t,n,a,i){e.log("alarmService");var o=this;o.convertLatLngToAddr=!0,o.alarmsObj={vehicles:[],startTime:"",endTime:"",vehicleFilterPattern:"",selectedVehiclesCount:0,filteredVehicles:[],alarmResponseData:[],loadingAlarmData:!1,msg:""},o.latlngList=[],o.addressList=[],o.getAlarmsHistory=function(){var e=[];for(var t in o.alarmsObj.filteredVehicles)o.alarmsObj.filteredVehicles[t].checked&&e.push(o.alarmsObj.filteredVehicles[t].rtgps.deviceid);if(e.length<=0)return void(o.alarmsObj.msg="Please Select atleast one vehicle");var a=new Date(1e3*moment(o.alarmsObj.startTime).unix()).getTime(),i=new Date(1e3*moment(o.alarmsObj.endTime).unix()).getTime();if(!a)return void(o.alarmsObj.msg="Please enter start time");if(!i)return void(o.alarmsObj.msg="Please enter end time");if(a>=i)return void(o.alarmsObj.msg="End time should be >= Start time");o.alarmsObj.loadingAlarmData=!0;var r={vehiclepath:e,starttime:a,endtime:i};return o.alarmsObj.msg="",n.myAlarmService.getAlarmInfo(r).then(o.readHistoryInfo,o.handleFailure)},o.readHistoryInfo=function(t){var a=t;if(o.alarmsObj.loadingAlarmData=!1,a.length){for(var i in a){for(var r in o.alarmsObj.vehicles)a[i].deviceid==o.alarmsObj.vehicles[r].rtgps.deviceid&&(a[i].vehicleno=o.alarmsObj.vehicles[r].rtgps.vehicleno,a[i].speed=Math.floor(a[i].speed));o.latlngList.push([a[i].lat,a[i].lng])}o.convertLatLngToAddr?n.geocodeService.getAddress(o.latlngList).then(function(e){for(var t in e){o.addressList.push(e[t][1]);for(var n in a)a[n].lat==e[t][0][0]&&a[n].lng==e[t][0][1]&&(a[n].addr=e[t][1]);o.alarmsObj.alarmResponseData=a}},function(t){e.log(t)}):o.alarmsObj.alarmResponseData=a}},o.handleFailure=function(){e.log("fails")},o.init=function(){var e=o.getDefaultTime();o.alarmsObj.startTime=e.startTime,o.alarmsObj.endTime=e.endTime;for(var n in t.vehiclesByPath)t.vehiclesByPath[n].hasOwnProperty("rtgps")&&o.alarmsObj.vehicles.push(t.vehiclesByPath[n]);o.alarmsObj.filteredVehicles=o.alarmsObj.vehicles},o.getDefaultTime=function(){var e="YYYY-MM-DD HH:mm",t=moment().subtract(1,"hour").format(e),n=moment().format(e);return{startTime:t,endTime:n}},o.init()}e.$inject=["$log","vehicleService","intellicarAPI","$filter","$q"],angular.module("uiplatform").service("alarmService",e)}(),function(){function e(e,t,n,a,i,o,r,s,l,c){t.log("AlarmController");var d=this,m="DD-MM-YY HH:mm";n.setTab(3),d.jsonAlarmData=[],d.searchTerm=null,d.convertLatLngToAddr=a.convertLatLngToAddr,d.dtOptions=i.newOptions(),d.dtOptions.withOption("paging",!1).withOption("scrollY","58vh").withOption("scrollCollapse",!0),d.selectAll=function(e){var t;if("vehicle"==e){for(var n in d.alarms.filteredVehicles)t=d.alarms.filteredVehicles,d.alarms.filteredVehicles[n].checked=d.selectAllVehicles;d.deSelectAllVehicles=!d.selectAllVehicles,d.setSelectedCount("vehicle")}},d.deSelectAll=function(e){if("vehicle"==e){for(var t in d.alarms.filteredVehicles)d.alarms.filteredVehicles[t].checked=!1;d.selectAllVehicles=!1,d.setSelectedCount("vehicle")}},d.verifyCheckStatus=function(e){if("vehicle"==e){var t=l("filter")(d.alarms.filteredVehicles,{checked:!0});t.length?d.deSelectAllVehicles=!1:d.deSelectAllVehicles=!0,t.length<d.alarms.filteredVehicles.length?d.selectAllVehicles=!1:t.length==d.alarms.filteredVehicles.length&&(d.alarms.filteredVehicles.length<=0?d.selectAllVehicles=!1:d.selectAllVehicles=!0)}d.setSelectedCount(e)},d.filterVehicles=function(){d.alarms.vehicleFilterPattern?d.alarms.filteredVehicles=l("filter")(d.alarms.vehicles,d.alarms.vehicleFilterPattern):d.alarms.filteredVehicles=d.alarms.vehicles,d.verifyCheckStatus("vehicle")},d.setSelectedCount=function(e){"vehicle"==e&&d.alarms.filteredVehicles.length&&(d.alarms.selectedVehiclesCount=l("filter")(d.alarms.filteredVehicles,{checked:!0}).length)},d.init=function(){d.alarms=a.alarmsObj;for(var e in d.alarms.vehicles)d.alarms.vehicles[e].hasOwnProperty("checked")||(d.alarms.vehicles[e].checked=!1);d.alarms.filteredVehicles.length&&(d.alarms.selectedVehiclesCount=l("filter")(d.alarms.filteredVehicles,{checked:!0}).length),d.filterVehicles(),d.showAddress()},d.getHistory=function(){d.jsonAlarmData=[],d.alarms.alarmResponseData=[],a.getAlarmsHistory(),d.showAddress()},d.showAddress=function(){o(function(){$(".latlng").webuiPopover({trigger:"hover",width:300,animation:"pop"})},3e3)},d.downloadFile=function(){d.jsonAlarmData=[];var e=d.alarms.alarmResponseData;if(null!=d.searchTerm&&(e=l("filter")(d.alarms.alarmResponseData,{$:d.searchTerm})),e.length){for(var t in e){var n=e[t].lat+","+e[t].lng;d.convertLatLngToAddr&&(n=e[t].addr);var a=new Date(parseInt(e[t].gpstime));d.jsonAlarmData.push({vehicle_name:e[t].vehicleno,time:moment(a).format(m),reason:e[t].alarmreason,speed:e[t].speed,operation_mode:e[t].opermode,location:n})}c.importFileservice.JSONToCSVConvertor(d.jsonAlarmData,"Vehicles Alarm Report",!0)}},d.getAddress=function(e,t,n){d.convertLatLngToAddr||(d.myclass="loc"+n,c.geocodeService.getAddress([[e,t]]).then(d.gotAddress,d.handleFailure))},d.gotAddress=function(e){if(e.length){var t;for(var n in e)t=e[n];var a=t[1];$("."+d.myclass).attr("data-content",a),WebuiPopovers.updateContent("."+d.myclass,a)}},angular.element("body").on("search.dt",function(){d.searchTerm=document.querySelector(".dataTables_filter input").value}),d.init()}e.$inject=["$scope","$log","dialogService","alarmService","DTOptionsBuilder","$timeout","$interval","$q","$filter","intellicarAPI"],angular.module("uiplatform").controller("AlarmController",e)}(),function(){function e(e,t){var n=this;$(window).keydown(function(e){27==e.keyCode&&n.closeTab()}),e.log("DialogController"),n.getTab=function(){n.selectedTab=t.getTab()},n.closeTab=function(){t.hide()},n.dialogShow=function(){return t.getDialogShow()},n.setTab=function(e){n.selectedTab=e},n.init=function(){t.addSetTabListener(n.setTab)},n.init()}e.$inject=["$log","dialogService"],angular.module("uiplatform").controller("DialogController",e)}(),function(){function e(e,t,n){n.log("LeftToolbarDashboardController")}e.$inject=["$scope","$rootScope","$log"],angular.module("uiplatform").controller("LeftToolbarDashboardController",e)}(),function(){function e(e,t,n){n.log("ReportsController")}e.$inject=["$scope","$rootScope","$log"],angular.module("uiplatform").controller("ReportsController",e)}(),function(){"use strict";function e(e,t){e.state("home.management.vehicle",{url:"/vehicle",params:{info:null},views:{"mgmttab@home.management":{templateUrl:"app/components/landingpage/management/settings/vehicle/vehicle_mgmt.html",resolve:{startupData:["$stateParams","$log","vehicleMgmtService","$state",function(e,t,n,a){return t.log("toState "+a.current.name),t.log(e),n.getData(e)}]},controller:"VehicleMgmtController as vm"}}}).state("home.management.group",{url:"/group",params:{info:null},views:{"mgmttab@home.management":{templateUrl:"app/components/landingpage/management/settings/group/group_mgmt.html",resolve:{startupData:["$stateParams","$log","groupMgmtService","$state",function(e,t,n,a){return t.log("current State "+a.current.name),t.log(e),n.getData(e)}]},controller:"GroupMgmtController as vm"}}}).state("home.management.user",{url:"/user",params:{info:null},views:{"mgmttab@home.management":{templateUrl:"app/components/landingpage/management/settings/user/user_mgmt.html",resolve:{startupData:["$stateParams","$log","userMgmtService","$state",function(e,t,n,a){return t.log("toState "+a.current.name),t.log(e),n.getData(e)}]},controller:"UserMgmtController as vm"}}}).state("home.management.role",{url:"/role",params:{info:null},views:{"mgmttab@home.management":{templateUrl:"app/components/landingpage/management/settings/role/role_mgmt.html",resolve:{startupData:["$stateParams","$log","roleMgmtService","$state",function(e,t,n,a){return t.log("toState "+a.current.name),n.getData(e)}]},controller:"RoleMgmtController as vm"}}}).state("home.management.device",{url:"/device",params:{info:null},views:{"mgmttab@home.management":{templateUrl:"app/components/landingpage/management/settings/device/device_mgmt.html",resolve:{startupData:["$stateParams","$log","deviceMgmtService","$state",function(e,t,n,a){return t.log("toState "+a.current.name),t.log(e),n.getData(e)}]},controller:"DeviceMgmtController as vm"}}}),t.otherwise("/")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("uiplatform").config(e).run(["$rootScope","$log","$state","$stateParams",function(e,t,n,a){e.$state=n,e.$stateParams=a}])}(),function(){function e(e,t,n,a,i,o,r,s,l,c,d,m,p,u){function g(){var e=o.hide()||s.when(!0);e.then(function(){a("left").toggle()})}function h(e){y.title=e.name,y.toggleItemsList(),y.showSimpleToast(y.title)}function v(e){function t(e){var t=this;t.actions=[{name:"Share",icon:"share",url:"https://twitter.com/intent/tweet?text=Angular%20Material%20Dashboard%20https://github.com/flatlogic/angular-material-dashboard%20via%20@flatlogicinc"},{name:"Star",icon:"star",url:"https://github.com/flatlogic/angular-material-dashboard/stargazers"}],t.performAction=function(t){e.hide(t)}}o.show({parent:m.getElementById("content"),templateUrl:"app/main/bottomSheet.html",controller:["$mdBottomSheet",t],controllerAs:"vm",bindToController:!0,targetEvent:e}).then(function(e){e&&r.debug(e.name+" clicked!")})}function f(e){d.show(d.simple().content(e).hideDelay(2e3).position("bottom right"))}r.log("HeaderController");var y=this;y.currState=l.current.name,y.isManagementTab=y.currState.indexOf("home.management"),y.menuItems=[],y.selectItem=h,y.toggleItemsList=g,y.showActions=v,y.showSimpleToast=f,y.right_nav_toggle=!1,y.left_nav_toggle=!0,y.userpref=function(){return u.userpref},n.loadAllItems().then(function(e){y.menuItems=[].concat(e)}),y.changePassword=function(){},y.logout=function(){p.logout()},y.toggleRightSidebar=function(){y.right_nav_toggle=!y.right_nav_toggle,e.$broadcast("toggleRightSidebar",{right_nav_toggle:y.right_nav_toggle})},y.toggleLeftSidebar=function(){r.log("left nav header"),y.left_nav_toggle=!y.left_nav_toggle,e.$broadcast("toggleLeftSidebar",{left_nav_toggle:y.left_nav_toggle})},y.closeMdMenu=function(e){27==e.keyCode&&i.hide()}}e.$inject=["$rootScope","$scope","navService","$mdSidenav","$mdMenu","$mdBottomSheet","$log","$q","$state","$stateParams","$mdToast","$document","loginService","userprefService"],angular.module("uiplatform").controller("HeaderController",e)}(),function(){function e(e,t,n,a,i,o,r){i.log("FooterController")}e.$inject=["$scope","$rootScope","navService","$mdSidenav","$log","$document","requestService"],angular.module("uiplatform").controller("FooterController",e)}(),function(){function e(e,t,n){n.log("CenterController")}e.$inject=["$scope","$rootScope","$log"],angular.module("uiplatform").controller("CenterController",e)}(),function(){"use strict";function e(e,t,n){e.log("vehicleAPIService");var a=this;a.encloseBody=function(e){return{vehicle:e}},a.handleResponse=function(e){return t.resolve(e.data.data)},a.handleFailure=function(n){return e.log("handleFailure"),e.log(n),t.reject(n)},a.mobilize=function(e){var t=a.encloseBody(e);return n.firePost("/vehicle/mobilize",t).then(a.handleResponse,a.handleFailure)},a.immobilize=function(e){var t=a.encloseBody(e);return n.firePost("/vehicle/immobilize",t).then(a.handleResponse,a.handleFailure)},a.getMobilityCommandStatus=function(e){var t=a.encloseBody(e);return n.firePost("/vehicle/immobihist",t).then(a.handleResponse,a.handleFailure)}}e.$inject=["$log","$q","requestService"],angular.module("uiplatform").service("vehicleAPIService",e)}(),function(){"use strict";function e(e,t,n,a,i){t.log("userService");var o=this;o.encloseBody=function(e){return{user:e}},o.getMyInfo=function(e){return e=o.encloseBody(e),a.firePost("/user/myinfo",e)},o.getMyGroups=function(e){return e=o.encloseBody(e),a.firePost("/user/mygroups",e)},o.getMyAssignedGroups=function(e){return e=o.encloseBody(e),a.firePost("/user/myassignedgroups",e)},o.getMyAssetGroups=function(e){return e=o.encloseBody(e),a.firePost("/user/myassetgroups",e)},o.getMyVehicles=function(e){return e=o.encloseBody(e),a.firePost("/user/myvehicles",e);
},o.getMyUsers=function(e){return e=o.encloseBody(e),a.firePost("/user/myusers",e)},o.getUserPermissions=function(e){return e=o.encloseBody(e),a.firePost("/permission/map",e)},o.getMyRoles=function(e){return e=o.encloseBody(e),a.firePost("/user/myroles",e)},o.getMyDevices=function(e){return e=o.encloseBody(e),a.firePost("/user/mydevices",e)},o.createUser=function(e){return e=o.encloseBody(e),a.firePost("/user/create",e)},o.getMyFences=function(e){return e=o.encloseBody(e),a.firePost("/user/mygeofences",e)},o.getMyFenceInfos=function(e){return e=o.encloseBody(e),a.firePost("/user/mygeofenceinfos",e)},o.getMyGeofenceReports=function(e){return e=o.encloseBody(e),a.firePost("/user/mygeofencereports",e)},o.assignUser=function(e){return e=o.encloseBody(e),a.firePost("/user/assigngroup",e)},o.handleResponse=function(e){return n.resolve(e)},o.handleFailure=function(e){return n.reject(e)},o.getMyInfoMap=function(e){return o.getMyInfo(e).then(i.makeMapOnAssetPath,o.handleFailure).then(o.handleResponse,o.handleFailure)},o.getMyGroupsMap=function(e){return o.getMyGroups(e).then(i.mergeAssetPermissions,o.handleFailure).then(i.makeAssetMap,o.handleFailure).then(o.handleResponse,o.handleFailure)},o.getMyAssignedGroupsMap=function(e){return o.getMyAssignedGroups(e).then(i.mergeAssetPermissions,o.handleFailure).then(i.makeAssetMap,o.handleFailure).then(o.handleResponse,o.handleFailure)},o.getMyAssetGroupsMap=function(e){return o.getMyAssetGroups(e).then(i.mergeAssetPermissions,o.handleFailure).then(i.makeAssetMap,o.handleFailure).then(o.handleResponse,o.handleFailure)},o.getMyVehiclesMap=function(e){return o.getMyVehicles(e).then(i.mergeAssetPermissions,o.handleFailure).then(i.makeAssetMap,o.handleFailure).then(o.handleResponse,o.handleFailure)},o.getMyUsersMap=function(e){return o.getMyUsers(e).then(i.mergeAssetPermissions,o.handleFailure).then(i.makeAssetMap,o.handleFailure).then(o.handleResponse,o.handleFailure)},o.getMyUsersMapList=function(e){return o.getMyUsers(e).then(i.mergeAssetPermissions,o.handleFailure).then(i.makeAssetList,o.handleFailure).then(o.handleResponse,o.handleFailure)},o.getMyRolesMap=function(e){return o.getMyRoles(e).then(i.mergeAssetPermissions,o.handleFailure).then(i.makeAssetMap,o.handleFailure).then(o.handleResponse,o.handleFailure)},o.getMyRolesList=function(e){return o.getMyRoles(e).then(i.mergeAssetPermissions,o.handleFailure).then(i.makeAssetList,o.handleFailure).then(o.handleResponse,o.handleFailure)},o.getMyDevicesMap=function(e){return o.getMyDevices(e).then(i.mergeAssetPermissions,o.handleFailure).then(i.makeAssetMap,o.handleFailure).then(o.handleResponse,o.handleFailure)},o.getMyFencesMap=function(e){return o.getMyFences(e).then(i.mergeAssetPermissions,o.handleFailure).then(i.makeAssetMap,o.handleFailure).then(o.handleResponse,o.handleFailure)},o.getMyFenceInfosMap=function(e){return o.getMyFenceInfos(e).then(i.mergeAssetPermissions,o.handleFailure).then(i.mergeFenceInfo,o.handleFailure).then(i.makeAssetMap,o.handleFailure).then(o.handleResponse,o.handleFailure)},o.getMyGeofenceReportsMap=function(e){return o.getMyGeofenceReports(e).then(i.mergeAssetPermissions,o.handleFailure).then(i.makeAssetMap,o.handleFailure).then(o.handleResponse,o.handleFailure)},o.handleDirectAssetResponse=function(e){return n.resolve(e)},o.getMyDirectAssetsMap=function(e){var t=o.getMyGroupsMap(e),a=o.getMyVehiclesMap(e),i=o.getMyUsersMap(e),r=o.getMyRolesMap(e),s=o.getMyDevicesMap(e),l=o.getMyInfoMap(e);return n.all([t,a,i,r,s,l]).then(o.handleDirectAssetResponse,o.handleFailure)}}e.$inject=["$rootScope","$log","$q","requestService","helperService"],angular.module("uiplatform").service("userService",e)}(),function(){"use strict";function e(e,t,n,a,i){function o(e,t,n,a){for(var i=-1,s=0;s<e.length;s++)if(e[s].info.assetpath==t){if(e[s].items=[],e[s].loading=!1,a)for(var l=0;l<n.length;l++)if(e[s].items.length>0){i=-1;for(var c=0;c<e[s].items.length;c++)n[l].info.ui_asset_type==e[s].items[c].id&&(i=c);i>=0?e[s].items[i].items.push(n[l]):r(e[s],n[l],e[s].items.length)}else r(e[s],n[l],0)}else if(-1!==t.indexOf(e[s].info.assetpath))for(var l=0;l<e[s].items.length;l++)"group"==e[s].items[l].id&&o(e[s].items[l].items,t,n,a)}function r(e,t,n){e.items[n]={},e.items[n].id=t.info.ui_asset_type,e.items[n].title=t.info.ui_asset_type,e.items[n].ui_asset_type="assettype",e.items[n].info=e.info,e.items[n].items=[],e.items[n].items.push(t)}var s=this;e.log("treeDataService"),s.collapsedStatus=!1,s.management_tree_data=function(e){for(var t,n=e.data.data,a={},i=[],o=0;o<n.length;o+=1){t=n[o],t.checkStatus="unchecked",t.nodes=[];var r=t.pgrouppath.split("/");r.shift();for(var s,l,c=[],d=0;d<r.length;d++)d%2!=0&&c.push(r[d]);l=c[c.length-1],s=c.length<=1?l:c[c.length-2],a[l]=o,s!=l?n[a[s]].nodes.push(t):i.push(t)}return i},s.getGenericTreeIndex=function(e,t){for(var n in e)if(e[n].info.assetpath==t.assetpath)return n},s.buildDashboardTree=function(e,t){if(null===e)return null;if("visited"in e[t]){if(1==e[t].visited)return null}else e[t].visited=!0;var n=e[t];n.visited=!0;var a={};a.id=e[t].info.assetpath,a.title=n.info.name,a.info=n.info,a.items=[],a.checkStatus=!1,a.collapsed=s.collapsedStatus;var i=null,o=null;if(null!==n.children)for(var r in n.children)o=n.children[r],i=s.buildDashboardTree(e,s.getGenericTreeIndex(e,o)),null!==i&&a.items.push(i);return a},s.createDashboardTree=function(e){var n=[];for(var a in e){var i=s.buildDashboardTree(e,a);null!==i&&n.push(i)}return t.resolve(n)},s.buildManagementTree=function(e,t){if(null===e)return null;if("visited"in e[t]){if(1==e[t].visited)return null}else e[t].visited=!0;var n=e[t];n.visited=!0;var a={};a.id=e[t].info.assetpath,a.title=n.info.name,a.info=n.info,a.items=[],a.checkStatus=!1,a.collapsed=s.collapsedStatus;var i=null,o=null;if(null!==n.children)for(var r in n.children)if(o=n.children[r],i=s.buildManagementTree(e,s.getGenericTreeIndex(e,o)),null!==i){var l=!1;for(var c in a.items){var d=a.items[c];if(d.title==i.info.ui_asset_type){l=!0;break}}l||(d={id:i.info.ui_asset_type,title:i.info.ui_asset_type,info:n.info,ui_asset_type:"assettype",items:[],collapsed:s.collapsedStatus},a.items.push(d)),d.items.push(i)}return a},s.createManagementTree=function(e){var n=[];for(var a in e){var i=s.buildManagementTree(e,a);null!==i&&n.push(i)}return null==s.globalGenericTree&&(s.globalGenericTree=n),s.globalGenericTree[0].collapsed=!0,s.globalGenericTree[0].loading=!1,t.resolve(n)},s.addLoggedInUserToTree=function(e,t){var n=e.assetpath,i=e.pgrouppath;i in t||(t[i]={},null==t[i].info&&(t[i].info={name:e.pname,assetpath:e.pgrouppath},a.addAssetInfo(t[i].info)),null==t[i].children&&(t[i].children={},t[i].children[n]=e));for(var o in t){var r=a.getParentPath(t[o].info);r==i&&(t[o].info.assetpath in t[i].children||t[o].info.assetpath!=i&&(t[i].children[t[o].info.assetpath]=t[o].info))}},s.globalGenericTree=null,s.createGenericTree=function(n){e.log(n);for(var i=n[0],o={},r=0;r<n.length;r++){var l=n[r];for(var c in l){var d=l[c],m=d.assetpath,p=d.pgrouppath;m in o||(o[m]={},o[m].info=d,o[m].children=null,o[m].collapsed=s.collapsedStatus,p in i&&p!=m&&(p in o?(null==o[p].children&&(o[p].children={}),o[p].children[m]=d):(o[p]={},o[p].info=i[p],o[p].children={},o[p].children[m]=d,o[p].collapsed=s.collapsedStatus))),"userid"in d&&s.addLoggedInUserToTree(d,o)}}var u=a.sortOnAssetLevel(o);return t.resolve(u)},s.getDashboardTree=function(e){var a=n.getMyGroupsMap(e),i=n.getMyVehiclesMap(e);return t.all([a,i]).then(s.createGenericTree,s.handleFailure).then(s.createDashboardTree,s.handleFailure)},s.mergeChildTree=function(e){var n=!0;e[Object.keys(e)[0]]||(n=!1);var a=i.lastGroupPath;return o(s.globalGenericTree,a,e,n),s.globalGenericTree[0].collapsed=!0,s.globalGenericTree[0].loading=!1,t.resolve(s.globalGenericTree)},s.getManagementTreeWithUser=function(e){return i.getMyDirectAssetsMapWithUser(e).then(s.createGenericTree,s.handleFailure).then(s.createManagementTree,s.handleFailure)},s.getManagementTreeNoUser=function(e){return i.getMyDirectAssetsMap(e).then(s.createGenericTree,s.handleFailure).then(s.createManagementTree,s.handleFailure).then(s.mergeChildTree,s.handleFailure)},s.getManagementTree=function(e){return i.getMyDirectAssetsMap(e).then(s.createGenericTree,s.handleFailure).then(s.createManagementTree,s.handleFailure)}}e.$inject=["$log","$q","userService","helperService","groupService"],angular.module("uiplatform").service("treeDataService",e)}(),function(){function e(e,t){var n=".",a="home",i="home.dashboard",o="home.management",r=a+n,s=i+n,l=o+n,c=function(e){if(null===e)return null;var t=e.lastIndexOf(".");return-1==t?e:e.substring(t+1)},d=function(e){if(null===e)return null;var t=e.lastIndexOf(".");return-1==t?e:e.substring(0,t)},m=function(e){if(null===e)return null;var t=e.indexOf(".");return-1==t?e:e.substring(0,t)},p=function(e){if(null===e)return null;var t=e.indexOf(".");if(-1==t)return e;if(t==e.length-1)return null;var n=e.indexOf(".",t+1);return-1==n?e.substring(t,e.length):e.substring(0,n)},u=function(e){return{leaf:c(e),parent:d(e),root:m(e),rootchild:p(e)}},g=function(e){return"."+e};return{STATE_HOME:a,STATE_HOME_DASHBOARD:i,STATE_HOME_MANAGEMENT:o,STATE_HOME_DOT:r,STATE_HOME_DASHBOARD_DOT:s,STATE_HOME_MANAGEMENT_DOT:l,getStateTree:u,dotState:g}}e.$inject=["$log","groupService"],angular.module("uiplatform").factory("stateService",e)}(),function(){"use strict";function e(e){e.log("schemaService");var t,n=[["perm1","SETTINGS_TAG_1",{key1:{type:"number",displayname:"Display Name1",displaydesc:"This will come in the hint",select:null,editable:!1,"default":null},key2:{type:"text",displayname:"Display Name2",displaydesc:"This will come in the hint",select:null,editable:!1,"default":10},key3:{type:["number"],displayname:"Display Name3",displaydesc:"This will come in the hint",select:null,editable:!1,"default":[1,2,3,4,5]},key4:{type:["text"],displayname:"Display Name4",displaydesc:"This will come in the hint",select:null,editable:!1,"default":["a","b","c","d"]},key5:{type:["number"],displayname:"Display Name3",displaydesc:"This will come in the hint",select:null,editable:!0,"default":[1,2,3,4,5]},key6:{type:["text"],displayname:"Display Name4",displaydesc:"This will come in the hint",select:null,editable:!0,"default":["a","b","c","d"]},key7:{type:["number"],displayname:"Display Name7",displaydesc:"This will come in the hint",select:[0,1,[1,3,9,27,81,243]],editable:!0,"default":[3]},key8:{type:["text"],displayname:"Display Name8",displaydesc:"This will come in the hint",select:[0,1e4,["a","b","c"]],editable:!0,"default":["a","c"]},key9:{type:{level2key1:{type:"number",displayname:"Level2 key1","default":10,editable:!0},level2key2:{type:"text",displayname:"Level2 key2","default":"abc",editable:!0}},displayname:"Key9 Level 2 Keys Array",select:null,editable:!1,"default":{level2key1:100,level2key2:"200"},checkfun:{type:"udf",func:'function(inpdataofthisfield, overalldataofthisjson, schemaforthisfield, overallschema){return {"status":"FAILURE", "errmsg":"I havent yet checked it"}}'}},key10:{type:[{level2key1:{type:"number",displayname:"Level 2 Key1","default":10,editable:!0},level2key2:{type:"text",displayname:"Level 2 Key2","default":"10",editable:!0}}],displayname:"Key10 Level 2 Keys Array",select:null,editable:!1,"default":[{level2key1:100,level2key2:"100"}],checkfun:{type:"udf",func:'function(inpdataofthisfield, overalldataofthisjson, schemaforthisfield, overallschema){return {"status":"FAILURE", "errmsg":"I havent yet checked it"}}'}},key11:{type:{level2key1:{type:"number",displayname:"Level2 key1","default":10,editable:!0},level2key2:{type:"text",displayname:"Level2 key2","default":"abc",editable:!0},level2key3:{type:{level3key1:{type:"number",displayname:"Level 3 Key1","default":10,editable:!0},level3key2:{type:"text",displayname:"Level 3 Key2","default":"10",editable:!0}},displayname:"Key11 Level 3 Keys Array",select:null,editable:!1,"default":{level3key1:100,level3key2:"200"}}},displayname:"Key11 Level 2 Keys Array",select:null,editable:!1,"default":{level2key1:100,level2key2:"200",level2key3:{level3key1:400,level3key2:"500"}},checkfun:{type:"udf",func:'function(inpdataofthisfield, overalldataofthisjson, schemaforthisfield, overallschema){return {"status":"FAILURE", "errmsg":"I havent yet checked it"}}'}},key12:{type:{level2key1:{type:"number",displayname:"Level2 key1","default":10,editable:!0},level2key2:{type:"text",displayname:"Level2 key2","default":"abc",editable:!0},level2key3:{type:{level3key1:{type:"number",displayname:"Level 3 Key1","default":10,editable:!0},level3key2:{type:"text",displayname:"Level 3 Key2","default":"10",editable:!0},level3key3:{type:[{level4key1:{type:"number",displayname:"Level 4 Key1","default":10,editable:!0},level4key2:{type:"text",displayname:"Level 4 Key2","default":"10",editable:!0}}],displayname:"Key12 Level 4 Keys Array",select:null,editable:!1,"default":[{level4key1:100,level4key2:"100"}],checkfun:{type:"udf",func:'function(inpdataofthisfield, overalldataofthisjson, schemaforthisfield, overallschema){return {"status":"FAILURE", "errmsg":"I havent yet checked it"}}'}}},displayname:"Key12 Level 3 Keys Array",select:null,editable:!1,"default":{level3key1:100,level3key2:"200"}}},displayname:"Key12 Level 2 Keys Array",select:null,editable:!1,"default":{level2key1:100,level2key2:"200"},checkfun:{type:"udf",func:'function(inpdataofthisfield, overalldataofthisjson, schemaforthisfield, overallschema){return {"status":"FAILURE", "errmsg":"I havent yet checked it"}}'}},key13:{type:{level2key1:{type:"number",displayname:"Level2 key1","default":10,editable:!0},level2key2:{type:"text",displayname:"Level2 key2","default":"abc",editable:!0},level2key3:{type:{level3key1:{type:["number"],displayname:"Level3 key1",displaydesc:"This will come in the hint",select:[0,1,[1,3,9,27,81]],editable:!0,"default":[3]},level3key2:{type:["text"],displayname:"Level3 key2",displaydesc:"This will come in the hint",select:null,editable:!0,"default":["a","b","c","d"]},level3key3:{type:["number"],displayname:"Level3 key3",displaydesc:"This will come in the hint",select:null,editable:!1,"default":[1,2,3,4,5]}},displayname:"Level2 key2","default":{key1:{},key2:{},key3:{}}},level2key4:{type:"text",displayname:"Level2 key2","default":"abc",editable:!0}},displayname:"Key13 Level 2 Keys Array",select:null,editable:!1,"default":{level2key1:100,level2key2:"200"},checkfun:{type:"udf",func:'function(inpdataofthisfield, overalldataofthisjson, schemaforthisfield, overallschema){return {"status":"FAILURE", "errmsg":"I havent yet checked it"}}'}}}]];t=[["perm1","SETTINGS_TAG_1",{key1:10,key2:"Ten",key3:[111,222,333,444,555,666,777,888,999],key4:["aaa","bbb","ccc"],key5:[101,102,103],key6:["aaa","bbb","ccc"],key7:[1,3,9],key8:["c","a"],key9:{level2key1:"India",level2key2:"New Delhi"},key10:[{level2key1:"passenger",level2key2:7},{level2key1:"goods",level2key2:"8 tonnes"},{level2key1:"electric",level2key2:"container"}],key11:{level2key1:600,level2key2:"700",level2key3:{level3key1:800,level3key2:"900"}},key12:{level2key1:600,level2key2:"700",level2key3:{level3key1:"val1",level3key2:"val2",level3key3:[{level4key1:800,level4key2:"900"},{level4key1:"700",level4key2:"600"},{level4key1:1e3,level4key2:"1000"}]}},key13:{level2key1:600,level2key2:"700",level2key3:{level3key1:[9,27,81],level3key2:[444,555],level3key3:[777]},level2key4:"sometext"}}]];var a=0,i=1,o=2,r=-1,s=0,l=1,c=2,d=3,m="number",p="text",u=function(e){switch(e){case m:return s;case p:return s}return r},g=function(e){return e.constructor===String&&u(e)===s?l:e.constructor===Object||e.constructor===Array?d:r},h=function(e){if(e.hasOwnProperty("type")){var t=e.type;if(t.constructor===String)return u(t);if(t.constructor===Object)return c;if(t.constructor===Array&&1===t.length)return g(t[0])}return r},v=function(e,t){return null==e?null:{_schema_uidata:{field:"icar-input",data:e,key:t}}},f=function(e,t){return{_schema_uidata:{field:"icar-readonly-list",data:e,key:t}}},y=function(e,t){return{_schema_uidata:{field:"icar-editable-list",data:e,key:t}}},b=function(e,t){return{_schema_uidata:{field:"icar-select-list",data:e,key:t}}},k=function(e,t,n){switch(n){case s:return v(e,t);case l:if(e.select)return b(e,t);if(e["default"])return e.editable?y(e,t):f(e,t);break;default:return"<span>Unexpected section.type</span>"}},M=function(e,t){if(null==e||null==t)return null;var n=h(e);if(n===r)return null;var a;if(n===s)a=k(e,t,n);else if(n===c){a={};for(var i in e.type){var o=e.type[i];a[i]=M(o,i,n)}}else if(n===l||n===d){var m=angular.copy(e);m.type=e.type[0];var p=null;if(!e.select&&e["default"]?p=e["default"]:e.select&&3==e.select.length&&(p=e.select[2]),p)if(n===l)a=k(m,t,n);else if(n===d){a=[];for(var i in p)a.push(M(m,i,n))}}return a},S=function(t){var n={};for(var r in t){var s=t[r],l=(s[a],s[i]),c=s[o];n[l]={};for(var d in c){var m=c[d];n[l][d]=M(m,d)}}return e.log(n),n},x=function(e){var t={};for(var n in e){var r=e[n],s=(r[a],r[i]),l=r[o];t[s]={};for(var c in l){var d=l[c];t[s][c]=d}}return t},w=function(){return S(n)},C=function(){return x(t)},T=function(e,t){for(var n in t){var a=t[n];if(a.constructor===Number||a.constructor===String)n in e&&(e[n]._schema_uidata.data.model=a,e[n]._schema_uidata.data["default"]=e[n]._schema_uidata.data.model);else if(a.constructor===Object)n in e&&T(e[n],a);else if(a.constructor===Array&&a.length>0)if(a[0].constructor===Number||a[0].constructor===String)for(var i in a)n in e&&("model"in e[n]._schema_uidata.data||(e[n]._schema_uidata.data.model=[],e[n]._schema_uidata.data["default"]=e[n]._schema_uidata.data.model),e[n]._schema_uidata.data.model.push(a[i]));else if(a[0].constructor===Object){var o=angular.copy(e[n][0]);e[n]=[];for(var i in a){var r=angular.copy(o);e[n].push(r)}for(var i in a)T(e[n][i],a[i])}}};return{getSchema:w,getSchemaData:C,bindDataToSchema:T}}e.$inject=["$log"],angular.module("uiplatform").service("schemaService",e)}(),function(){"use strict";function e(e,t){var n=this;n.encloseBody=function(e){return{role:e}},n.assignPermission=function(e){return e=n.encloseBody(e),t.firePost("/role/addpermission",e)},n.createRole=function(e){return e=n.encloseBody(e),t.firePost("/role/create",e)},n.rolePermissions=function(e){return e=n.encloseBody(e),t.firePost("/role/permissions",e)}}e.$inject=["$log","requestService"],angular.module("uiplatform").service("roleService",e)}(),function(){"use strict";function e(e,t,n,a,i,o){var r=this,s=[],l=[400,401,403];e.log("requestService"),r.getToken=function(){return o.getToken()},r.firePost=function(i,s,l){return i=a+i,null===s&&(s={}),l=null==l||l?!0:!1,l?o.isAuthed()||i.indexOf("gettoken")>0?t.post(i,s)["catch"](r.handleFailure):(e.log("user not authenticated"),r.checkLogin(),n.reject({auth:!1})):t.post(i,s)},r.fireGet=function(i,s){return i=a+i,s=null==s||s?!0:!1,s?o.isAuthed()||i.indexOf("gettoken")>0?t.post(i)["catch"](r.handleFailure):(e.log("user not authenticated"),r.checkLogin(),n.reject({auth:!1})):t.post(i)},r.fireGeoCode=function(a,s,l){return a=i+a,null===s&&(s={}),l=null==l||l?!0:!1,l?o.isAuthed()||a.indexOf("gettoken")>0?t.post(a,s)["catch"](r.handleFailure):(e.log("user not authenticated"),r.checkLogin(),n.reject({auth:!1})):t.post(a,s)},r.handleFailure=function(e){return-1!=l.indexOf(e.status),n.reject(e)},r.checkLogin=function(t){(!o.isAuthed()||t)&&angular.forEach(s,function(t,n){e.log("calling show login"),t()})},r.addAuthListener=function(e){s.push(e)},r.isLoginTokenValid=function(){r.checkLogin(!1)}}e.$inject=["$log","$http","$q","API_HOST","GEOCODE_API_HOST","authService"],angular.module("uiplatform").service("requestService",e)}(),function(){"use strict";function e(e,t,n,a){function i(e){return{reports:e}}e.log("reportsService");var o=this;o.handleTrackHistory=function(e){return e.data&&e.data.data?n.resolve(e.data.data):n.reject(e)},o.handleFailure=function(t){e.log(t),n.reject(t)},o.getDeviceLocation=function(e){return a.firePost("/reports/rtgps/trackhistory",e).then(o.handleTrackHistory,o.handleFailure)},o.getBatteryInfo=function(e){return a.firePost("/reports/battery/trackhistory",e).then(o.handleTrackHistory,o.handleFailure)},o.getGPSLastseen=function(e){return e=i(e),a.firePost("/reports/rtgps/gpslatest",e)}}e.$inject=["$log","$http","$q","requestService"],angular.module("uiplatform").service("reportsService",e)}(),function(){"use strict";function e(e,t){e.log("groupService");var n=this;n.permissionMap=function(e){return t.firePost("/permission/map",e)}}e.$inject=["$log","requestService"],angular.module("uiplatform").service("permissionService",e)}(),function(){"use strict";function e(e,t,n){var a=this;e.log("myAlarmService"),a.handleGetAlarms=function(e){return e.data&&e.data.data?t.resolve(e.data.data):t.reject(e)},a.handleFailure=function(n){return e.log(n),t.reject(n)},a.getAlarmInfo=function(e){var e={vehicle:e};return n.firePost("/reports/rtalarm/trackhistorym",e).then(a.handleGetAlarms,a.handleFailure)},a.subscribe=function(e,t){var n="gps",a=[{path:e}];t?intellicarAPI.mqttService.subscribe(a,n):intellicarAPI.mqttService.unsubscribe(a,n)}}e.$inject=["$log","$q","requestService"],angular.module("uiplatform").service("myAlarmService",e)}(),function(){"use strict";function e(e,t,n,a,i){e.log("mqttService");var o=this;return o.socketiohost=i,o.socket=null,o.toConnect=!0,o.listeners={},o.socket=null,o.subscriptionList={},o.initSocket=function(){null===o.socket&&o.toConnect&&(e.log("Trying to connect to MQTT"),o.connect(),o.socket.on("connect",o.onConnect),o.socket.on("close",o.onClose),o.toConnect=!1),a(o.initSocket,5e3)},o.onConnect=function(){null!==o.socket?(o.toConnect=!0,o.sendToken(),o.socket.on("authsuccess",o.onAuthSuccess),o.socket.on("authfailure",o.onAuthFailure),o.socket.on("mqtt",o.onReceiveMsg)):e.log("mqtt connect error")},o.connect=function(){o.socket=io.connect(o.socketiohost)},o.sendToken=function(){o.socket&&o.socket.emit("authtoken",t.getToken())},o.onAuthSuccess=function(){e.log("mqtt authSuccess");for(var t in o.subscriptionList)for(var n in o.subscriptionList[t])o.subscribeChannel(o.subscriptionList[t][n],t)},o.subscribe=function(e,t){t in o.subscriptionList||(o.subscriptionList[t]=[]),o.subscriptionList[t].push(e),o.subscribeChannel(e,t)},o.unsubscribe=function(e,t){var n=o.subscriptionList.indexOf(e);n>-1&&(o.subscriptionList.splice(n,1),o.unsubscribeChannel(e,t))},o.subscribeChannel=function(e,t){var n={};n.data=[],n.data.push([t,e]),o.socket.emit("subscribe",n)},o.unsubscribeChannel=function(e,t){var n={};n.data=[],n.data.push([t,e]),o.socket.emit("unsubscribe",n)},o.subscribeAsset=function(e,t){o.subscribe(e,t)},o.unsubscribeAsset=function(e,t){o.unsubscribe(e,t)},o.getTopicKey=function(e){if(e.length>0){var t=e[0].split("/");if(t.length>2)return t[2]}return null},o.onReceiveMsg=function(t){var n=o.getTopicKey(t);return null==n?(e.log("Invalid mqtt msg"),void e.log(t)):void o.callListeners(t,n)},o.onAuthFailure=function(){e.log("mqtt authFailure"),o.onClose()},o.onClose=function(){e.log("mqtt onClose"),o.socket.close(),o.socket=null,o.toConnect=!0},o.addListener=function(e,t){e in o.listeners||(o.listeners[e]=[]),-1===o.listeners[e].indexOf(t)&&o.listeners[e].push(t)},o.callListeners=function(e,t){if(t in o.listeners)for(var n in o.listeners[t])o.listeners[t][n](e,t)},o.initSocket(),{addListener:o.addListener,subscribeAsset:o.subscribeAsset,unsubscribeAsset:o.unsubscribeAsset,subscribe:o.subscribe,unsubscribe:o.unsubscribe}}e.$inject=["$log","authService","helperService","$timeout","MQTT_HOST"],angular.module("uiplatform").service("mqttService",e)}(),function(){"use strict";angular.module("uiplatform").service("intellicarAPI",["$rootScope","$log","$q","appConstants","helperService","authService","requestService","stateService","treeDataService","userService","groupService","mqttService","schemaService","reportsService","anchorSmoothScrollService","geofenceService","fenceReportService","vehicleAPIService","geocodeService","permissionService","roleService","importFileservice","myAlarmService",function(e,t,n,a,i,o,r,s,l,c,d,m,p,u,g,h,v,f,y,b,k,M,S){return t.log("intellicarAPI"),{helperService:i,authService:o,requestService:r,stateService:s,treeDataService:l,userService:c,groupService:d,anchorScrollService:g,appConstants:a,mqttService:m,schemaService:p,reportsService:u,geofenceService:h,fenceReportService:v,vehicleAPIService:f,geocodeService:y,permissionService:b,roleService:k,importFileservice:M,myAlarmService:S}}])}(),function(){"use strict";function e(e,t,n){var a=this;t.log("importFileService"),a.JSONToCSVConvertor=function(e,t,n){var a="object"!=typeof e?JSON.parse(e):e,i="";if(i+=t+"\r\n\n",n){var o="";for(var r in a[0])r=r.replace("_"," "),o+=r+",";o=o.slice(0,-1),i+=o+"\r\n"}for(var s=0;s<a.length;s++){var o="";for(var r in a[s])o+='"'+a[s][r]+'",';o.slice(0,o.length-1),i+=o+"\r\n"}if(""==i)return void alert("Invalid data");var l="";l=t.replace(/ /g,"_");var c="data:text/csv;charset=utf-8,"+escape(i),d=document.createElement("a");d.href=c,d.style.cssText+=";visibility:hidden",d.download=l+".csv",document.body.appendChild(d),d.click(),document.body.removeChild(d)}}e.$inject=["$rootScope","$log","$q"],angular.module("uiplatform").service("importFileservice",e)}(),function(){"use strict";function e(e,t,n,a){var i=this;t.log("helperService");var o="/",r="/1/1",s="assetpath",l="assetid",c="pgrouppath",d="pgroupid",m="ui_asset_type";i.assetTypeIdToAssetType={1:a.GROUP,2:a.USER,3:a.ROLE,4:a.VEHICLE,5:a.VEHICLETYPE,6:a.DEVICE,7:a.DEVICETYPE,15:a.FENCE,17:a.FENCEREPORT},i.assetTypeToAssetTypeId=function(){var e={};for(var t in i.assetTypeIdToAssetType)e[i.assetTypeIdToAssetType[t]]=t;return e}(),i.getPathId=function(e){return null==e?null:parseInt(e.substring(e.lastIndexOf(o)+1))},i.getAssetId=function(e){return null==e?null:l in e?e.assetid:s in e?i.getPathId(e.assetpath):null},i.getParentPath=function(e){if(null==e)return null;if(c in e)return e.pgrouppath;if(!(s in e))return null;var t=e.assetpath;if(null==t)return null;if(t===r)return r;for(var n=0,a=t.length-1;a>0&&(t.charAt(a)!==o||2!==++n);a--);return t.substring(0,a)},i.getParentFromPath=function(e){if(null==e)return null;if(e===r)return r;for(var t=0,n=e.length-1;n>0&&(e.charAt(n)!==o||2!==++t);n--);return e.substring(0,n)},i.getParentId=function(e){return null==e?null:d in e?e.pgroupid:i.getPathId(i.getParentPath(e))},i.getAssetTypeId=function(e){if(null==e)return null;var t=i.getParentPath(e);return null==t?null:t===r&&e.assetpath==r?"1":e.assetpath.substring(t.length+1,e.assetpath.lastIndexOf(o))},i.getAssetType=function(e){if(null==e)return null;if(m in e)return e.ui_asset_type;var t=i.getAssetTypeId(e);return null==t?null:i.assetTypeIdToAssetType[t]},i.getAssetPath=function(e){return null==e?null:s in e?e.assetpath:null},i.getAssetPathLevel=function(e){return null==e?null:(e.split(o).length-1)/2},i.getAssetLevel=function(e){return null==e?null:s in e?i.getAssetPathLevel(e.assetpath):void 0},i.addAssetInfo=function(e){return null==e?null:(e.assetid=i.getAssetId(e),e.pgrouppath=i.getParentPath(e),e.pgroupid=i.getParentId(e),e.ui_asset_type=i.getAssetType(e),void(e.assetlevel=i.getAssetLevel(e)))},i.mergeAssetPermissions=function(e){var t=e.data.data;for(var a in t.assets){var o=t.assets[a];i.addAssetInfo(o);for(var r in t.permissions){var s=t.permissions[r];o.assetpath==s.assetpath&&(o.permissions=JSON.parse(s.permid))}}return n.resolve(e)},i.mergeUserPermissions=function(e){var t=[],a=e[0].data.data;for(var i in a.assets){var o=a.assets[i];for(var r in a.permissions){var s=a.permissions[r];o.assetpath==s.assetpath&&t.push({assetpath:o.assetpath,name:o.name,pname:o.pname,assetid:s.assetid,permid:s.permid})}}return n.resolve(t)},i.mergeAssetAssignments=function(e){var t=e.data.data,a=t.asset[0];return a.info=t.info,a.assg=t.assg,a.assginfo=t.assginfo,a.permissions=JSON.parse(t.permissions[0].permid),n.resolve(a)},i.mergeFenceInfo=function(e){var t=e.data.data;for(var a in t.assets){var i=t.assets[a];i.info=[];for(var o in t.info){var r=t.info[o];i.assetpath==r.assetpath&&i.info.push(r)}}return n.resolve(e)},i.makeAssetMap=function(e){var t=e.data.data,a={};for(var i in t.assets){var o=t.assets[i];a[o.assetpath]=o}return n.resolve(a)},i.makeAssetList=function(e){var t=e.data.data,a=[];for(var i in t.assets){var o=t.assets[i];o.id=t.assets[i].assetid,a.push(o)}return n.resolve(a)},i.makeMapOnAssetPath=function(e){var t=e.data.data,a={};for(var o in t){var r=t[o];i.addAssetInfo(r),a[r.assetpath]=r}return n.resolve(a)},i.sortOnAssetLevel=function(e){function t(e,t){return e.info.assetlevel-t.info.assetlevel}var n=[];for(var a in e)n.push(e[a]);return n.sort(t),n},i.getNextPathItemEnd=function(e,t){var n="/";if(null===e)return-1;if(null===t&&(t=0),0>t||t>=e.length)return-1;if(e.charAt(t)!==n)return-1;if(e.substr(t,e.length).length<4)return-1;var a=e.indexOf(n,t+1);if(-1!=a&&a<e.length-1){var i=e.indexOf(n,a+1);return-1!=i?i-1:e.length-1}return-1},i.getNodesInPath=function(e){if(angular.isUndefined(e))return[];for(var t=[],n=0,a=0,o=0;o<e.length;){if(a=i.getNextPathItemEnd(e,o),-1==a)return null;a<e.length&&t.push(e.substring(n,a+1)),o=a+1}return t},JSON.flatten=function(e){function t(e,a){if(Object(e)!==e)n[a]=e;else if(Array.isArray(e)){for(var i=0,o=e.length;o>i;i++)t(e[i],a+"["+i+"]");0==o&&(n[a]=[])}else{var r=!0;for(var s in e)r=!1,t(e[s],a?a+"."+s:s);r&&a&&(n[a]={})}}var n={};return t(e,""),n},JSON.flatten2=function(e){function t(e,a){if(Object(e)!==e)n[a]=e;else if(Array.isArray(e)){for(var i=0,o=e.length;o>i;i++)"object"==typeof e[i]?t(e[i],a+"["+i+"]"):(0==i&&(n[a]=[]),n[a].push(e[i]));0==o&&(n[a]=[])}else{var r=!0;for(var s in e)r=!1,t(e[s],a?a+"."+s:s);r&&a&&(n[a]={})}}var n={};return t(e,""),n},JSON.unflatten=function(e){if(Object(e)!==e||Array.isArray(e))return e;var t=/\.?([^.\[\]]+)|\[(\d+)\]/g,n={};for(var a in e){for(var i,o=n,r="";i=t.exec(a);)o=o[r]||(o[r]=i[2]?[]:{}),r=i[2]||i[1];o[r]=e[a]}return n[""]||n}}e.$inject=["$rootScope","$log","$q","appConstants"],angular.module("uiplatform").service("helperService",e)}(),function(){"use strict";function e(e,t,n,a,i,o){t.log("groupService");var r=this;r.encloseBody=function(e){return{group:e}},r.getMyGroups=function(e){return e=r.encloseBody(e),a.firePost("/group/mygroups",e)},r.getMyAssetGroups=function(e){return e=r.encloseBody(e),a.firePost("/group/myassetgroups",e)},r.getMyVehicles=function(e){return e=r.encloseBody(e),a.firePost("/group/myvehicles",e)},r.getMyUsers=function(e){return e=r.encloseBody(e),a.firePost("/group/myusers",e)},r.getAssignedUsers=function(e){return e=r.encloseBody(e),a.firePost("/group/assignedusers",e)},r.getMyRoles=function(e){return e=r.encloseBody(e),a.firePost("/group/myroles",e)},r.getAssignedRoles=function(e){return e=r.encloseBody(e),a.firePost("/group/assignedroles",e)},r.getMyDevices=function(e){return e=r.encloseBody(e),a.firePost("/group/mydevices",e)},r.createGroup=function(e){return e=r.encloseBody(e),a.firePost("/group/create",e)},r.assignRole=function(e){return e=r.encloseBody(e),a.firePost("/group/assignrole",e)},r.deAssignRole=function(e){return e=r.encloseBody(e),a.firePost("/group/deassignrole",e)},r.handleResponse=function(e){return n.resolve(e)},r.handleFailure=function(e){return n.reject(e)},r.getMyGroupsMap=function(e){return r.getMyGroups(e).then(i.mergeAssetPermissions,r.handleFailure).then(i.makeAssetMap,r.handleFailure).then(r.handleResponse,r.handleFailure)},r.getMyAssetGroupsMap=function(e){return r.getMyAssetGroups(e).then(i.mergeAssetPermissions,r.handleFailure).then(i.makeAssetMap,r.handleFailure).then(r.handleResponse,r.handleFailure)},r.getMyVehiclesMap=function(e){return r.getMyVehicles(e).then(i.mergeAssetPermissions,r.handleFailure).then(i.makeAssetMap,r.handleFailure).then(r.handleResponse,r.handleFailure)},r.getMyUsersMap=function(e){return r.getMyUsers(e).then(i.mergeAssetPermissions,r.handleFailure).then(i.makeAssetMap,r.handleFailure).then(r.handleResponse,r.handleFailure)},r.getMyUsersMapList=function(e){return r.getMyUsers(e).then(i.mergeAssetPermissions,r.handleFailure).then(i.makeAssetList,r.handleFailure).then(r.handleResponse,r.handleFailure);
},r.getAssignedUsersMapList=function(e){return r.getAssignedUsers(e).then(i.mergeAssetPermissions,r.handleFailure).then(i.makeAssetList,r.handleFailure).then(r.handleResponse,r.handleFailure)},r.getMyRolesMap=function(e){return r.getMyRoles(e).then(i.mergeAssetPermissions,r.handleFailure).then(i.makeAssetMap,r.handleFailure).then(r.handleResponse,r.handleFailure)},r.getMyRolesList=function(e){return r.getMyRoles(e).then(i.mergeAssetPermissions,r.handleFailure).then(i.makeAssetList,r.handleFailure).then(r.handleResponse,r.handleFailure)},r.getAssignedRolesList=function(e){return r.getAssignedRoles(e).then(i.mergeAssetPermissions,r.handleFailure).then(i.makeAssetList,r.handleFailure).then(r.handleResponse,r.handleFailure)},r.getMyDevicesMap=function(e){return r.getMyDevices(e).then(i.mergeAssetPermissions,r.handleFailure).then(i.makeAssetMap,r.handleFailure).then(r.handleResponse,r.handleFailure)},r.handleDirectAssetResponse=function(e){return t.log("groupService handleDirectAssetResponse"),n.resolve(e)},r.getMyDirectAssetsMapWithUser=function(e){var t=r.getMyGroupsMap(e),a=r.getMyVehiclesMap(e),i=r.getMyUsersMap(e),s=r.getMyRolesMap(e),l=r.getMyDevicesMap(e),c=o.getMyInfoMap(e);return n.all([t,a,i,s,l,c]).then(r.handleDirectAssetResponse,r.handleFailure)},r.getMyDirectAssetsMap=function(e){var t=r.getMyGroupsMap(e),a=r.getMyVehiclesMap(e),i=r.getMyUsersMap(e),o=r.getMyRolesMap(e),s=r.getMyDevicesMap(e);return n.all([t,a,i,o,s]).then(r.handleDirectAssetResponse,r.handleFailure)},r.createNewGroup=function(e){return t.log(e),"success"}}e.$inject=["$rootScope","$log","$q","requestService","helperService","userService"],angular.module("uiplatform").service("groupService",e)}(),function(){"use strict";function e(e,t,n,a){var i=this;e.log("geofenceService"),i.getFenceInfo=function(e){var t={geofence:e};return n.firePost("/geofence/info",t)},i.handleTrackHistory=function(e){return e.data&&e.data.data?t.resolve(e.data.data):t.reject(e)},i.handleFailure=function(n){e.log(n),t.reject(n)},i.getReportHistory=function(e){var t={fenceinfo:e};return n.firePost("/reports/rtfence/trackhistory",t)},i.getFenceInfoMap=function(e){return i.getFenceInfo(e).then(a.mergeAssetAssignments,i.handleFailure)}}e.$inject=["$log","$q","requestService","helperService"],angular.module("uiplatform").service("geofenceService",e)}(),function(){"use strict";function e(e,t,n){var a=this;e.log("geocodeService");var i=function(e){return e.data&&e.data.data&&e.data.data.length?n.resolve(e.data.data):n.reject(e)},o=function(t){return e.log(t),n.reject(t)};a.getAddress=function(e){return e={data:e},t.fireGeoCode("/geocodeint",e).then(i,o)}}e.$inject=["$log","requestService","$q"],angular.module("uiplatform").service("geocodeService",e)}(),function(){"use strict";function e(e,t,n,a){var i=this;e.log("fenceReportService"),i.getGoefenceReportInfo=function(e){var t={geofencereport:e};return n.firePost("/geofencereport/info",t)},i.getGeofenceReportInfoMap=function(e){return i.getGoefenceReportInfo(e).then(a.mergeAssetAssignments,i.handleFailure)},i.handleResponse=function(e){return t.resolve(e)},i.handleFailure=function(e){return t.reject(e)}}e.$inject=["$log","$q","requestService","helperService"],angular.module("uiplatform").service("fenceReportService",e)}(),function(){"use strict";function e(e,t,n){var a=this;t.log("authService"),a.parseJwt=function(t){var n=t.split(".")[1],a=n.replace("-","+").replace("_","/");return angular.fromJson(e.atob(a))},a.saveToken=function(t){e.localStorage[n]=t},a.getToken=function(){return e.localStorage[n]},a.isAuthed=function(){var e=a.getToken();if(e){var t=a.parseJwt(e);return Math.round((new Date).getTime()/1e3)<=t.exp}return!1},a.logout=function(){e.localStorage.removeItem(n)}}function t(e,t,n){return{request:function(e){return 0===e.url.indexOf(t)&&("POST"==e.method?e.url.indexOf("gettoken")>0||(e.data.token=n.getToken()):"GET"==e.method),e},response:function(e){return e.data&&e.data.data&&0===e.config.url.indexOf(t)&&e.data.data.token&&n.saveToken(e.data.data.token),e}}}e.$inject=["$window","$log","TOKEN_KEY"],t.$inject=["$log","API_HOST","authService"],angular.module("uiplatform").constant("API_HOST","http://in2.intellicar.in:10104").constant("MQTT_HOST","http://in2.intellicar.in:10105").constant("GEOCODE_API_HOST","http://maps.intellicar.in:8082").constant("TOKEN_KEY","JWT_TOKEN_KEY").service("authService",e).factory("authInterceptor",t).config(["$httpProvider",function(e){e.interceptors.push("authInterceptor")}])}(),function(){"use strict";function e(e,t,n,a,i){t.log("assetAPIService");var o=this;o.encloseBody=function(e){return{asset:e}},o.getMyAssets=function(e,t){return e.assettype=t,"grouppath"in e||(e.grouppath="/1/1"),e=o.encloseBody(e),a.firePost("/asset/myassets",e)},o.getMyGroups=function(e){return o.getMyAssets(e,appConstants.GROUP)},o.getMyUsers=function(e){return o.getMyAssets(e,appConstants.USER)},o.getMyRoles=function(e){return o.getMyAssets(e,appConstants.ROLE)},o.getMyVehicles=function(e){return o.getMyAssets(e,appConstants.VEHICLE)},o.getMyDevices=function(e){return o.getMyAssets(e,appConstants.DEVICE)}}e.$inject=["$rootScope","$log","$q","requestService","helperService"],angular.module("uiplatform").service("assetAPIService",e)}(),function(){"use strict";function e(e,t,n){var a=this;a.scrollTo=function(e){function t(){return self.pageYOffset?self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0}function a(e){for(var t=document.getElementById(e),n=t.offsetTop,a=t;a.offsetParent&&a.offsetParent!=document.body;)a=a.offsetParent,n+=a.offsetTop;return n}var i=t(),o=a(e),r=o>i?o-i:i-o;if(100>r)return void scrollTo(0,o);var s=Math.round(r/100);s>=20&&(s=20);var l=Math.round(r/25),c=o>i?i+l:i-l,d=0;if(o>i)for(var m=i;o>m;m+=l)n("window.scrollTo(0, "+c+")",d*s),c+=l,c>o&&(c=o),d++;else for(var m=i;m>o;m-=l)n("window.scrollTo(0, "+c+")",d*s),c-=l,o>c&&(c=o),d++}}e.$inject=["$log","$q","$timeout"],angular.module("uiplatform").service("anchorSmoothScrollService",e)}(),function(){function e(e,t){return{restrict:"AE",templateUrl:"app/components/common/directives/readonly-list.html",scope:{listData:"="},link:function(e){}}}e.$inject=["$log","$mdDialog"],angular.module("uiplatform").directive("readOnlyList",e)}(),function(){function e(e,t,n,a,i,o){return{restrict:"E",templateUrl:"app/components/common/directives/panel-expansion.html",trasclude:!0,scope:{details:"=",myFunc:"&clickPanel",fields:"="},link:function(a){a.slides=[{image:"assets/images/car1.jpg"},{image:"assets/images/car2.jpg"},{image:"assets/images/car3.jpg"},{image:"assets/images/car4.jpg"}],a.deleted_panel_id,a.master={},a.save=function(){e.log("============================================="),e.log(a.schemaData)},a.discard=function(e){a.readMode=!0,a.details=angular.copy(a.master)},a.edit=function(){a.readMode&&(a.readMode=!1)},a["delete"]=function(e){var n={templateUrl:"/app/components/common_directives/panel_delete_dialog.html",scope:a,preserveScope:!0};a.deleted_panel_id=e.toString(),t.show(n)},a.deleteSelected=function(){n().waitFor(a.deleted_panel_id).then(function(e){e.remove()}),t.cancel()},a.cancelSelected=function(){t.cancel(),e.log("my delete")},a.panelSchema=[{section:"vehicle Details",order:1,description:"vehicle description"},{section:"Devices",order:2,description:"device description"}],a.getCurrentData=function(t){a.master={},a.master=angular.copy(a.details),e.log(t),a.myFunc().then(function(t){e.log("inside directive"),e.log(t),angular.element(document.getElementById("fields_content")).html(o(a.fields)(a)),a.schemaData=t[1],e.log("received in directive ++++++++++++++++++++++++++"),e.log(a.schemaData),e.log(a.fields)})},a.tabs=[{title:"Nine",content:"<md-input-container>                                                  <label>Vehicle Name</label>                                                  <input type='text'>                                                </md-input-container>"},{title:"Ten",content:"<md-input-container>                                                  <label>Device Name</label>                                                  <input type='text'>                                                </md-input-container>"}],a.selectedIndex=0,a.activeTab=function(e){},a.collapsePanel=function(t){e.log(t),t=t.toString(),n(t).collapse(),a.readMode=!0}}}}e.$inject=["$log","$mdDialog","$mdExpansionPanel","$mdExpansionPanelGroup","$stateParams","$compile"],angular.module("uiplatform").directive("icarPanelExpansion",e)}(),function(){function e(){return{restrict:"E",scope:{popup:"=data"},templateUrl:"app/components/common/directives/multi-list.html",link:function(e){e.defaultClick=function(e,t){var n=function(t){console.log(e.data),e.item.processing=!1;for(var n=0;n<e.object.list.length;n++)e.object.list[n].id==e.item.id&&e.object.list.splice(n,1);e.data[e.object.id+t].list.unshift(e.item)};1!=e.item.processing&&(e.item.processing=!0,t(n))}}}}angular.module("uiplatform").directive("multiList",e)}(),function(){function e(){return function(e,t,n){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(n.icarKeypress)}),t.preventDefault())})}}angular.module("uiplatform").directive("icarKeypress",e)}(),function(){function e(e,t){return{restrict:"E",template:'<div style="overflow:hidden;"></div>',scope:{tabContent:"="},link:function(e,n,a){e.parseContent=function(n,a){var i=t('<fieldset layout="row" style="border:1px solid #ccc;"></fieldset>')(e);a.append(i);for(var o in n){var r=n[o];if("_schema_uidata"==o){var s=e.$new(!1);s.content=r,i.append(t(e.getIcarDirective(r))(s))}else"object"==typeof r&&e.parseContent(r,i)}},e.getIcarDirective=function(e){return"<legend>"+e.key+"</legend><"+e.field+"></"+e.field+">"},e.parseContent(e.tabContent,angular.element(n.children()[0]))}}}function t(e){return{restrict:"A",compile:function(t,n){e.log(t)}}}e.$inject=["$log","$compile"],t.$inject=["$log"],angular.module("uiplatform").directive("icarTabContent",e).directive("addContent",t)}(),function(){function e(e){return{restrict:"AE",template:' <md-content layout="row" layout-wrap>                            <div class="error" ng-show="showErrorMsg">Maximum Selection is                             {{maxSelection}}                            </div>                            <div layout="row" layout-wrap flex="100" flex-gm-sm="20">                                <md-checkbox aria-label="Select All"                                    ng-checked="isChecked()"                                    md-indeterminate="isIndeterminate()"                                    ng-click="toggleAll()"  ng-show="showSelectAll">                                    <span ng-if="isChecked()" style="font-size:14px;">Un-</span>Select All                                </md-checkbox flex>                            </div>                            <div class="" ng-repeat="item in items" layout-padding>                            <md-checkbox ng-checked="exists(item, selected)"                                 ng-click="toggle(item, selected)" ng-disabled="scope.content.data.editable">                                {{ item }}                            </md-checkbox>                           </div>                        </md-content>',link:function(t,n,a){t.selectedCount=t.content.data["default"].length,t.minSelection=t.content.data.select[0],t.maxSelection=t.content.data.select[1],t.maxSelection>=t.content.data.select[2].length?t.showSelectAll=!0:t.showSelectAll=!1,t.items=t.content.data.select[2],t.selected=t.content.data["default"],t.toggle=function(n,a){e.log(t.selectedCount);var i=a.indexOf(n);e.log(t.selectedCount,t.maxSelection),i>-1?(e.log("selected"),a.splice(i,1),e.log(a),t.selectedCount<0?0:--t.selectedCount,t.showErrorMsg=!1):parseInt(t.selectedCount)<parseInt(t.maxSelection)?(e.log("Unselected"),a.push(n),t.selectedCount+=1,t.showErrorMsg=!1):t.showErrorMsg=!0},t.exists=function(e,t){return t.indexOf(e)>-1},t.isIndeterminate=function(){return 0!==t.selected.length&&t.selected.length!==t.items.length},t.isChecked=function(){return t.selected.length===t.items.length},t.toggleAll=function(){t.selected.length===t.items.length?t.selected=[]:(0===t.selected.length||t.selected.length>0)&&(t.selected=t.items.slice(0))}}}}e.$inject=["$log"],angular.module("uiplatform").directive("icarSelectList",e)}(),function(){function e(e){return{restrict:"AE",template:'<md-content layout="row" layout-wrap>                        <label flex="100">Username</label><br/>                            <div ng-repeat="d in data" layout-padding>{{d}}</div>                        </md-content>',link:function(e,t,n){e.data=e.content.data["default"]}}}e.$inject=["$log"],angular.module("uiplatform").directive("icarReadonlyList",e)}(),function(){function e(){return{restrict:"AE",template:'<md-input-container>                        <label>Username</label>                       <input type="text" ng-model="content.data.default" ng-disabled="!content.data.editable">                        </md-input-container>',link:function(e,t,n){}}}angular.module("uiplatform").directive("icarInput",e)}(),function(){function e(e,t,n,a){return{restrict:"ACE",templateUrl:"app/components/common/directives/icar-expanel.html",scope:{details:"=",schema:"="},link:function(n){n.contentTemplate="panel-content.html",n.headerTemplate="panel-header.html",n.footerTemplate="panel-footer.html",n.confirmDialog=t.confirm().title("Delete asset ?").clickOutsideToClose(!0).ok("Yes").cancel("No"),n.discard=function(){},n.edit=function(){},n["delete"]=function(){t.show(n.confirmDialog).then(function(){e.log("OK")},function(){e.log("Cancel")})},n.deleteSelected=function(){},n.cancelSelected=function(){},n.expandCollapse=function(e){e.isOpen()?e.collapse():e.expand()},n.collapsePanel=function(){}}}}e.$inject=["$log","$mdDialog","$mdExpansionPanel","$mdExpansionPanelGroup"],angular.module("uiplatform").directive("icarExpanel",e)}(),function(){function e(){return{restrict:"AE",template:'<label>{{displayName}}</label>                       <md-chips ng-model="data" layout="row" layout-wrap flex="100">                            ng-model="data"                            readonly="false"                            md-removable="true"                            placeholder="displayHint"                            secondary-placeholder="+Add">                       </md-chips>',link:function(e,t,n){e.displayName=e.content.data.displayname,e.dataType=e.content.data.type,e.displayHint=e.content.data.displaydesc,e.data=e.content.data["default"],e.editable=e.content.data.editable}}}angular.module("uiplatform").directive("icarEditableList",e)}(),function(){function e(){return{GROUP:"group",VEHICLE:"vehicle",USER:"user",ROLE:"role",DEVICE:"device",VEHICLETYPE:"vehicletype",DEVICETYPE:"devicetype",FENCE:"fence",FENCEREPORT:"fencereport"}}angular.module("uiplatform").factory("appConstants",e)}(),function(){"use strict";function e(e,t){e.log("vehicleService");var n=this;n.vehiclesByPath={},n.vehiclesByNumber={},n.listeners={},n.noCommThreshold=108e5,n.addListener=function(e,t){e in n.listeners||(n.listeners[e]=[]),-1===n.listeners[e].indexOf(t)&&n.listeners[e].push(t)},n.callListeners=function(e,t){if(t in n.listeners)for(var a in n.listeners[t])n.listeners[t][a](e,t)};var a="On",i="Off",o="Running",r="Stopped",s="Active",l="Immobilized",c="Not Communicating",d="Device Pullout";n.processVehicleData=function(t){var m=t[1];if(null==m.vehiclepath||0==m.vehiclepath.length)return null;if(!(m.vehiclepath in n.vehiclesByPath))return void e.log("Receiveing data of vehicle not owned by user!!");var p=n.vehiclesByPath[m.vehiclepath];"rtgps"in p||(p.rtgps=m,n.callListeners(p.rtgps,"rtgps2"));var u=p.rtgps;u.timestamp=new Date(m.timestamp),u.deviceid=m.deviceid,u.latitude=m.latitude,u.longitude=m.longitude,u.altitude=m.altitude,u.vehicleno=m.vehicleno,u.odometer=m.odometer,u.carbattery=u.carbattery?u.carbattery:0,u.devbattery=u.devbattery?u.devbattery:0,u.speed=parseFloat(parseFloat(m.speed).toFixed(2)),u.direction=parseFloat(parseFloat(m.direction).toFixed(2)),u.carbattery=parseFloat(parseFloat(m.carbattery).toFixed(2)),u.devbattery=parseFloat(parseFloat(m.devbattery).toFixed(2)),u.ignitionstatus=m.ignitionstatus,u.mobilistatus=m.mobilistatus;var g=(new Date).getTime();return g-u.timestamp.getTime()>288e5&&(u.noComm="no communication",u.notcommunicatingFilter=c),1==u.ignitionstatus?(u.ignitionstatusStr=a,u.ignitionstatusFilter=o):(u.ignitionstatusStr=i,u.ignitionstatusFilter=r),1==u.mobilistatus?u.mobilistatusFilter=s:(u.mobilistatusFilter=l,u.ignitionstatusFilter=""),u.carbattery<2&&(u.devicepulloutFilter=d),p},n.updateVehicle=function(t,a){if(2==t.length&&null!=t[0]&&null!=t[1]){var i=n.processVehicleData(t);i&&n.callListeners(i,a)}else e.log("invalid rtgps data")},n.handleFailure=function(t){e.log("handleFailure"),e.log(t)},n.subscribe=function(e,n,a){var i=[{path:e}];n?t.mqttService.subscribe(i,a):t.mqttService.unsubscribe(i,a)},n.handleGetMyVehicles=function(e){for(var t in e)n.subscribe(e[t].assetpath,!0,"gps"),n.subscribe(e[t].assetpath,!0,"rtalarm"),n.vehiclesByNumber[e[t].name]=e[t],n.vehiclesByPath[e[t].assetpath]=e[t]},n.getMyVehicles=function(e){return t.userService.getMyVehiclesMap(e)},n.init=function(){t.mqttService.addListener("rtgps",n.updateVehicle),n.getMyVehicles({}).then(n.handleGetMyVehicles,n.handleFailure)},n.init()}e.$inject=["$log","intellicarAPI"],angular.module("uiplatform").service("vehicleService",e)}(),function(){"use strict";function e(e,t,n,a,i,o){e.log("userprefService");var r=this;r.userpref={},r.listeners={},r.addListener=function(e,t){e in r.listeners||(r.listeners[e]=[]),-1===r.listeners[e].indexOf(t)&&r.listeners[e].push(t)},r.callListeners=function(e,t){if(t in r.listeners)for(var n in r.listeners[t])r.listeners[t][n](e,t)},r.loginSuccess=function(t){e.log("loginSuccess"),e.log(t)},r.handleGetMyInfo=function(e){r.userpref=e.data.data[0],r.pgrouppath=i.getParentFromPath(r.userpref.assetpath),o.setCurrentGroupPath(r.pgrouppath),r.callListeners(r.userpref,"setUserPref")},r.handleFailure=function(t){e.log("handleFailure"),e.log(t)},r.init=function(){t.addListener("loginSuccess",r.loginSuccess),n.userService.getMyInfo({}).then(r.handleGetMyInfo,r.handleFailure)},r.init()}e.$inject=["$log","loginService","intellicarAPI","latlngService","helperService","settingsService"],angular.module("uiplatform").service("userprefService",e)}(),function(){"use strict";function e(e){e.log("latlngService");var t=this;t.initCoords={},t.geocoder=new google.maps.Geocoder,t.geocodeAddress=function(e){t.geocoder.geocode({address:e},function(e,n){return"OK"===n?(t.initCoords=e[0].geometry.location,t.initCoords):void 0})}}e.$inject=["$log"],angular.module("uiplatform").service("latlngService",e)}(),function(){"use strict";function e(){function e(){return t}var t=[{title:"AngularJS",url:"https://angularjs.org/",description:"HTML enhanced for web apps!",logo:"angular.png"},{title:"BrowserSync",url:"http://browsersync.io/",description:"Time-saving synchronised browser testing.",logo:"browsersync.png"},{title:"GulpJS",url:"http://gulpjs.com/",description:"The streaming build system.",logo:"gulp.png"},{title:"Jasmine",url:"http://jasmine.github.io/",description:"Behavior-Driven JavaScript.",logo:"jasmine.png"},{title:"Karma",url:"http://karma-runner.github.io/",description:"Spectacular Test Runner for JavaScript.",logo:"karma.png"},{title:"Protractor",url:"https://github.com/angular/protractor",description:"End to end test framework for AngularJS applications built on top of WebDriverJS.",logo:"protractor.png"},{title:"Angular Material Design",url:"https://material.angularjs.org/#/",description:"The Angular reference implementation of the Google's Material Design specification.",logo:"angular-material.png"},{title:"Sass (Node)",url:"https://github.com/sass/node-sass",description:"Node.js binding to libsass, the C version of the popular stylesheet preprocessor, Sass.",logo:"node-sass.png"}];this.getTec=e}angular.module("uiplatform").service("webDevTec",e)}(),function(){function e(e){var t=[{name:"Dashboard",icon:"dashboard",sref:".dashboard"},{name:"Profile",icon:"person",sref:".profile"},{name:"Table",icon:"view_module",sref:".table"}];return{loadAllItems:function(){return e.when(t)}}}e.$inject=["$q"],angular.module("uiplatform").service("navService",e)}(),function(){"use strict";function e(){function e(e){var t=this;t.relativeDate=e(t.creationDate).fromNow()}e.$inject=["moment"];var t={restrict:"E",templateUrl:"app/components/navbar/navbar.html",scope:{creationDate:"="},controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("uiplatform").directive("acmeNavbar",e)}(),function(){"use strict";function e(e){function t(t,n,a,i){var o,r=e(n[0],{typeSpeed:40,deleteSpeed:40,pauseDelay:800,loop:!0,postfix:" "});n.addClass("acme-malarkey"),angular.forEach(t.extraValues,function(e){r.type(e).pause()["delete"]()}),o=t.$watch("vm.contributors",function(){angular.forEach(i.contributors,function(e){r.type(e.login).pause()["delete"]()})}),t.$on("$destroy",function(){o()})}function n(e,t){function n(){return a().then(function(){e.info("Activated Contributors View")})}function a(){return t.getContributors(10).then(function(e){return i.contributors=e,i.contributors})}var i=this;i.contributors=[],n()}n.$inject=["$log","githubContributor"];var a={restrict:"E",scope:{extraValues:"="},template:"&nbsp;",link:t,controller:n,controllerAs:"vm"};return a}e.$inject=["malarkey"],angular.module("uiplatform").directive("acmeMalarkey",e)}(),function(){function e(e,n,a,i,o){n.log("loginService");var r=this;r.username="",r.password="",r.listeners={},r.addListener=function(e,t){e in r.listeners||(r.listeners[e]=[]),-1===r.listeners[e].indexOf(t)&&r.listeners[e].push(t)},r.callListeners=function(e,t){if(t in r.listeners)for(var n in r.listeners[t])r.listeners[t][n](e,t)},r.login=function(e,t){return o.firePost("/gettoken",{user:{type:"local",username:e,password:t}}).then(function(n){return r.username=e,r.password=t,r.callListeners(n,"loginSuccess"),n})},r.logout=function(){i.logout&&i.logout(),e.showLoginDialog=!0,r.loginDialog="",r.checkLogin()},r.isAuthed=function(){return i.isAuthed?i.isAuthed():!1},r.checkLogin=function(){e.showLoginDialog&&(n.log("Showing login"),r.loginDialog||(r.loginDialog=a.confirm({controller:t,templateUrl:"app/components/login/login_dialog.html",clickOutsideToClose:!1,escapeToClose:!1}),a.show(r.loginDialog)))},o.addAuthListener(r.checkLogin)}function t(e,t,n,a,i,o){function r(e){n.log("handleLoginSuccess"),t.showLoginDialog=!1,i.hide(),l.loginDialog="",o.location.reload()}function s(e){n.log(e),n.log("handleLoginFailure"),e&&e.data&&e.msg&&n.log(e),l.errorMsg=e.data.msg}var l=e;t.showLoginDialog=!1,n.log("loginDialogController"),l.emailFormat=/^[a-z]+[a-z0-9._]+@[a-z]+\.[a-z.]{2,5}$/,l.onChangeCredentials=function(){return l.username&&l.password?void(l.errorMsg=""):void(l.errorMsg="Please enter valid Username and Password")},l.login=function(){l.errorMsg||(n.log("/gettoken"),a.login(l.username,l.password).then(r,s))},l.logout=function(){a.logout()}}e.$inject=["$rootScope","$log","$mdDialog","authService","requestService"],t.$inject=["$scope","$rootScope","$log","loginService","$mdDialog","$window"],angular.module("uiplatform").service("loginService",e).controller("loginDialogController",t)}(),function(){"use strict";function e(e,t){function n(n){function i(e){return e.data}function o(t){e.error("XHR Failed for getContributors.\n"+angular.toJson(t.data,!0))}return n||(n=30),t.get(a+"/contributors?per_page="+n).then(i)["catch"](o)}var a="https://github.com/intellicar/uiplatform.git",i={apiHost:a,getContributors:n};return i}e.$inject=["$log","$http"],angular.module("uiplatform").factory("githubContributor",e)}(),function(){function e(e,t,n){n.log("MainController");var a=this;a.dummy=!1,a.toggleLeftnav=function(e,t){a.dummy=t.dummy},e.$on("toggleLeftSidebar",a.toggleLeftSidebar)}e.$inject=["$scope","$rootScope","$log"],angular.module("uiplatform").controller("MainController",e)}(),function(){"use strict";function e(e,t,n,a,i){n.log("runBlock"),e.showLoginDialog=!0,i.ga("create","UA-86820286-2","auto"),e.$on("$stateChangeSuccess",function(e){i.ga("send","pageview",a.path())})}e.$inject=["$rootScope","$state","$log","$location","$window"],angular.module("uiplatform").run(e)}(),function(){"use strict";function e(e,t){e.state("home",{url:"/",views:{"":{templateUrl:"app/main/main.html",controller:"MainController as vm"},"header@home":{templateUrl:"app/components/landingpage/header/header.html",controller:"HeaderController as vm"},"leftnavtree@home":{templateUrl:"app/components/landingpage/dashboard/leftnavtree/leftnav_dashboard.html",controller:"LeftNavDashboardController as vm"},"lefttoolbar@home":{templateUrl:"app/components/landingpage/dashboard/lefttoolbar/lefttoolbar_dashboard.html",controller:"LeftToolbarDashboardController as vm"},"center@home":{templateUrl:"app/components/landingpage/center/center.html",controller:"CenterController as vm"},"centermain@home":{templateUrl:"app/components/landingpage/dashboard/map/map.html",controller:"MapController as vm"},"rightnav@home":{templateUrl:"app/components/landingpage/dashboard/rightnav/rightnavalert_dashboard.html",controller:"RightNavDashboardController as vm"}}}).state("home.dashboard",{url:"home/dashboard",views:{"leftnavtree@home":{templateUrl:"app/components/landingpage/dashboard/leftnavtree/leftnav_dashboard.html",controller:"LeftNavDashboardController as vm"},"lefttoolbar@home":{templateUrl:"app/components/landingpage/dashboard/lefttoolbar/lefttoolbar_dashboard.html",controller:"LeftToolbarDashboardController as vm"}}}).state("home.management",{url:"home/management",resolve:{startupTreeData:["$stateParams","$log","$q","$state","$rootScope","settingsService","intellicarAPI",function(e,t,n,a,i,o,r){t.log(e),t.log(a);var s=function(e){var t=e.data.data[0],n=r.helperService.getParentFromPath(t.assetpath);return o.setCurrentGroupPath(n),n},l=function(e){return t.log("handleFailure"),t.log(e),e};return r.userService.getMyInfo({}).then(s,l)}]},views:{"leftnavtree@home":{templateUrl:"app/components/landingpage/management/leftnav/leftnav_mgmt.html",controller:"LeftNavManagementController as vm"},"lefttoolbar@home":{templateUrl:"app/components/common/views/emptydiv.html",controller:"LeftToolbarDashboardController as vm"},"centermain@home":{templateUrl:"app/components/landingpage/management/settings/tabs/settings.html",controller:"SettingsController as vm"},"mgmttab@home.management":{templateUrl:"app/components/landingpage/management/settings/vehicle/vehicle_mgmt.html",controller:"VehicleMgmtController as vm"},"rightnav@home":{templateUrl:"app/components/landingpage/management/rightnav/rightnav_mgmt.html",controller:"RightNavMgmtController as vm"}}}).state("home.history",{url:"history",params:{mapObj:null},views:{"dialogview@home":{templateUrl:"app/components/landingpage/dashboard/map/dialog/history.html",controller:"HistoryController as vm"}}}).state("home.historyData",{url:"historyData",params:{mapObj:null},views:{"dialogview@home":{templateUrl:"app/components/landingpage/dashboard/map/dialog/historyTable.html",controller:"HistoryTableController as vm"}}}).state("home.alarm",{url:"alarm",views:{"dialogview@home":{templateUrl:"app/components/landingpage/dashboard/map/dialog/alarm.html",controller:"AlarmController as vm"}}}).state("home.downloadHistory",{url:"downloadHistory",views:{"dialogview@home":{templateUrl:"app/components/landingpage/dashboard/map/dialog/downloadHistory.html",controller:"DownloadHistoryController as vm"}}}).state("home.geofence",{url:"geofence",views:{"dialogview@home":{templateUrl:"app/components/landingpage/dashboard/map/dialog/geofence.html",controller:"GeofenceReportController as vm"}}}).state("home.reports",{url:"home/reports",views:{"leftnavtree@home":{templateUrl:"app/components/landingpage/management/leftnav/leftnav_mgmt.html",controller:"LeftNavDashboardController as vm"},"lefttoolbar@home":{templateUrl:"app/components/common/views/emptydiv.html",controller:"LeftToolbarDashboardController as vm"},"centermain@home":{templateUrl:"app/components/landingpage/reports/reports.html",controller:"ReportsController as vm"}}}),t.otherwise("/")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("uiplatform").config(e).filter("titleCase",function(){return function(e){return e=e||"",e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}})}(),function(){"use strict";angular.module("uiplatform")}(),function(){"use strict";function e(e,t){t.theme("default").primaryPalette("defaultPrimary",{"default":"600"}).accentPalette("teal",{"default":"500"}).warnPalette("defaultPrimary"),t.theme("dark","default").primaryPalette("defaultPrimary").dark(),t.theme("grey","default").primaryPalette("grey"),t.theme("custom","default").primaryPalette("defaultPrimary",{"hue-1":"50"}),t.definePalette("defaultPrimary",{50:"#FFFFFF",100:"rgb(255, 198, 197)",200:"#E75753",300:"#E75753",400:"#E75753",500:"#E75753",600:"#E75753",700:"#E75753",800:"#E75753",900:"#E75753",A100:"#E75753",A200:"#E75753",A400:"#E75753",A700:"#E75753"}),e.icon("user","assets/images/user.svg",64)}e.$inject=["$mdIconProvider","$mdThemingProvider"],angular.module("uiplatform").config(e)}(),angular.module("uiplatform").run(["$templateCache",function(e){e.put("app/main/main.html","<!DOCTYPE html><style>.left-nav {border-right:1px solid #CCC;}\n    .right-nav {border-left:1px solid #CCC;}</style><div class=mainHeader ui-view=header></div><div ui-view=leftnavtree class=left-nav></div><div id=main><md-content layout=row flex class=altered><div layout=column flex id=content><md-content layout=column><div ui-view=center></div></md-content></div></md-content></div><div class=right-nav ui-view=rightnav></div><div ui-view=footer></div>"),e.put("app/components/login/login_dialog.html",'<!DOCTYPE html><style>md-dialog {\n        width: 50%;\n    }\n\n    .img-logo {\n        margin: 0 auto;\n        display: block;\n    }\n    .error{\n        color:#f00;\n    }</style><!--<script type="text/ng-template" id="login_dialog.html">--><md-dialog aria-label=authLoginDialog><md-dialog-content><img ng-src=assets/logo.png height=120 class="img-logo md-card-image" alt=Intellicar><div><span class=error>{{errorMsg}}</span><md-input-container class="md-block md-accent"><label>Username</label><input type=text ng-model=username ng-change=onChangeCredentials() icar-keypress=login()></md-input-container><div flex layout-align="center center"><span style="color: red;font-size:13px" layout-align="center center" flex>{{message}}</span></div><md-input-container class="md-block md-accent"><label>Password</label><input type=password ng-model=password icar-keypress=login() ng-change=onChangeCredentials()></md-input-container></div></md-dialog-content><md-dialog-actions layout=row><div flex><md-button class=md-accent ng-click=login()>Login</md-button><!--<md-button class="md-raised md-primary" ng-show="isAuthed()" ng-click="logout()">Logout</md-button>--></div></md-dialog-actions></md-dialog><!--//</script>-->'),e.put("app/components/navbar/navbar.html",'<md-toolbar layout=row layout-align="center center"><md-button href=https://github.com/Swiip/generator-gulp-angular>Gulp Angular</md-button><section flex layout=row layout-align="left center"><md-button href=# class=md-raised>Home</md-button><md-button href=# class=md-raised>About</md-button><md-button href=# class=md-raised>Contact</md-button></section><md-button class=acme-navbar-text>Application was created {{ vm.relativeDate }}.</md-button></md-toolbar>'),e.put("app/components/navservice/bottomSheet.html","<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><title>Title</title></head><body></body></html>"),e.put("app/components/common/directives/icar-expanel.html",'<!DOCTYPE html><!--<div ng-include src="icar-expanel-templates.html"></div>--><!--<link rel="import" href="app/components/common/directives/icar-expanel/icar-expanel-templates.html">--><style>md-tabs:not(.md-no-tab-content):not(.md-dynamic-height){\n        min-height:360px;\n    }</style><script type=text/ng-template id=panel-header.html><div layout="row" flex>\n        <div>{{details.name}}</div>\n        <div class="md-summary"></div>\n        <md-expansion-panel-icon></md-expansion-panel-icon>\n    </div></script><script type=text/ng-template id=panel-content.html><div layout="row" flex>\n        <div flex>\n            <md-tabs flex>\n                <md-tab ng-repeat="(key, tab) in schema">\n                    <md-tab-label>\n                        {{key}}\n                    </md-tab-label>\n                    <md-tab-body>\n                        <icar-tab-content tab-content="tab"></icar-tab-content>\n                    </md-tab-body>\n                </md-tab>\n            </md-tabs>\n        </div>\n    </div></script><script type=text/ng-template id=panel-footer.html><div layout="row" flex>\n        <md-button class="md-warn" ng-click="save()">Save</md-button>\n        <md-button class="md-warn" ng-click="discard()">Discard</md-button>\n        <md-button class="md-fab md-mini" aria-label="Edit" ng-click="edit()">\n            <md-icon class="material-icons md-mini">mode_edit</md-icon>\n            <md-tooltip md-direction="bottom">\n                Edit\n            </md-tooltip>\n        </md-button>\n        <md-button class="md-fab md-mini" aria-label="delete" ng-click="delete(details.id)">\n            <md-icon class="material-icons md-mini">delete</md-icon>\n            <md-tooltip md-direction="bottom">\n                Delete\n            </md-tooltip>\n        </md-button>\n    </div></script><md-expansion-panel md-component-id=details.assetpath flex><md-expansion-panel-collapsed ng-click=expandCollapse($panel) md-no-sticky=true flex><div ng-include=headerTemplate></div></md-expansion-panel-collapsed><md-expansion-panel-expanded flex><md-expansion-panel-header ng-click=expandCollapse($panel) md-no-sticky=true flex><div ng-include=headerTemplate></div></md-expansion-panel-header><md-expansion-panel-content ng-include=contentTemplate flex><!--<icar-tab-content tab-content="vm.schema"></icar-tab-content>--></md-expansion-panel-content><md-expansion-panel-footer md-no-sticky=true flex><div ng-include=footerTemplate></div></md-expansion-panel-footer></md-expansion-panel-expanded></md-expansion-panel>'),
e.put("app/components/common/directives/multi-list.html",'<!DOCTYPE html><div class=grp-popup ng-if=popup.visible><div class=grp-popup-backdrop ng-click="popup.visible = false"></div><div class=grp-popup-inner style="width:{{popup.options.width}}%;\n        height:{{popup.options.height}}%;\n        left:{{ ( 100 - popup.options.width ) / 2 }}%;\n        top:{{ ( 100 - popup.options.height ) / 2 }}%"><div class=gp-head><span>{{popup.heading}}</span> <a class="waves-effect waves-light btn ng-isolate-scope gph-close" ng-click="popup.visible = false">x</a></div><div class=gp-content><span class="spinner -blue -big" ng-show="!popup.datas || popup.datas.length <= 0" ng-class="{\'opacity_0\':popup.datas.length > 0}"></span><div class=gpc-half style="width:{{100 / popup.datas.length }}%" ng-repeat="obj in popup.datas" ng-init="obj.id = $index"><div class=gpc-wrapper><nav class="gp-head nav-wrapper"><span>{{obj.heading}}</span><span class=gph-smallHead> </span><i class="inputAfter fa fa-search"></i> <input type=text placeholder=Search ng-model=obj.FilterStr></nav><div class="gp-content coolbar"><div class=gpc-item ng-repeat="item in obj.list | filter : obj.FilterStr"><span>{{item.name}}</span><div class=gpc-right-btn style=background:{{button.color}} ng-repeat="button in obj.buttons" ng-click="button.onClick({item:item, object:obj, data:popup.datas}, defaultClick)" ng-class="{\'inactive\':item.processing}"><i ng-if="button.iconType ==\'fa\' && !item.processing" class="fa fa-{{button.icon}}" style=color:{{button.fColor}}></i> <i ng-if="button.iconType ==\'fa\' && item.processing" class="fa fa-spin fa-gear" style=color:{{button.fColor}}></i></div></div><div ng-if="obj.list.length <= 0" class=gpc-noitem>No Items</div></div></div></div></div></div></div>'),e.put("app/components/common/directives/panel-expansion.html",'<!DOCTYPE html><!--<script type="text/ng-template" id="fields-template.html">--><!--<div> <h1>HTML Content </h1></div>--><!--<div ng-bind-html="fields"></div>--><!--</script>--><md-expansion-panel md-component-id={{details.order}} flex><md-expansion-panel-collapsed ng-click=getCurrentData(details.order) flex><div class=md-title>{{details.section}}</div><div class=md-summary>demo</div><md-expansion-panel-icon></md-expansion-panel-icon></md-expansion-panel-collapsed><md-expansion-panel-expanded flex><md-expansion-panel-header ng-click=collapsePanel(details.order) md-no-sticky=true flex><div class=md-title>{{details.section}}</div><div class=md-summary></div><md-expansion-panel-icon></md-expansion-panel-icon></md-expansion-panel-header>{{selectedIndex}}<md-expansion-panel-content flex><md-tabs md-selected=selectedIndex md-border-bottom md-autoselect><md-tab ng-repeat="tab in tabs" ng-disabled=tab.disabled label={{tab.title}} md-on-select=activeTab(selectedIndex)><div class="demo-tab tab{{$index%4}}" style="padding: 25px; text-align: center"><div bind-html-compile=tab.content></div></div></md-tab></md-tabs></md-expansion-panel-content><md-expansion-panel-footer md-no-sticky=true flex><div flex></div><md-button class=md-warn ng-click=save();>Save</md-button><md-button class=md-warn ng-click=discard(details.len)>Discard</md-button><md-button class="md-fab md-mini" aria-label=Edit ng-click=edit()><md-icon class="material-icons md-mini">mode_edit</md-icon><md-tooltip md-direction=bottom>Edit</md-tooltip></md-button><md-button class="md-fab md-mini" aria-label=delete ng-click=delete(details.id)><md-icon class="material-icons md-mini">delete</md-icon><md-tooltip md-direction=bottom>Delete</md-tooltip></md-button></md-expansion-panel-footer></md-expansion-panel-expanded></md-expansion-panel>'),e.put("app/components/common/directives/panel_delete_dialog.html",'<style>.div-area{padding:50px;}</style><md-dialog aria-label=deleteDialog><md-dialog-content><div class=div-area>Are you sure you want to delete?</div></md-dialog-content><md-dialog-actions layout=row><div flex><md-button class="md-raised md-primary" ng-click=deleteSelected()>Yes</md-button><md-button class="md-raised md-primary" ng-click=cancelSelected()>No</md-button></div></md-dialog-actions></md-dialog>'),e.put("app/components/common/directives/readonly-list.html",'<!DOCTYPE html><div><md-grid-list md-cols=5 md-row-height=4:4><md-grid-tile ng-repeat="item in listData[0]"></md-grid-tile></md-grid-list></div>'),e.put("app/components/common/views/emptydiv.html","<!DOCTYPE html><div></div>"),e.put("app/components/landingpage/footer/footer.html","<!DOCTYPE html><div ui-view=footer></div>"),e.put("app/components/landingpage/center/center.html",'<!DOCTYPE html><div><!--<section>--><!--<div ui-view="centernav"></div>--><!--</section>--><section id=middle><section><div ui-view=lefttoolbar></div></section><section><div class=centermain ui-view=centermain></div></section><section><div ui-view=righttoolbar></div></section></section></div>'),e.put("app/components/landingpage/header/header.html",'<!DOCTYPE html><md-toolbar class=icar-toolbar><div class="md-toolbar-tools icar-toolbar-tools" layout-align="start center"><div layout=row layout-align="start center" flex=30><md-button class=md-icon-button aria-label=Icon ng-click=vm.toggleLeftSidebar()><md-tooltip>Left menu</md-tooltip><md-icon md-font-library=material-icons>dehaze</md-icon></md-button><img ng-src=assets/logo.png height=44 alt=Intellicar></div><div id=centernav2 flex=40 layout-align="space-around center"><div layout=row ng-if="vm.isManagementTab<0"><!--<a ui-sref="home.dashboard" class="M9kDrd xyzabc">Dashboard</a>--><!--<a ui-sref="home.management" target="_blank" class="M9kDrd xyzabc">Management</a>--><!--<a ui-sref="home.reports" class="M9kDrd xyzabc">Reports</a>--></div></div><!--<span flex></span>--><div layout=row layout-align="end right" flex=30 ng-keydown=vm.closeMdMenu($event) tabindex=0><md-button class=md-icon-button aria-label=notifications ng-click=vm.toggleRightSidebar()><md-tooltip>Alerts</md-tooltip><md-icon md-font-library=material-icons>notifications</md-icon></md-button><md-menu md-offset="0 2" style=margin:0><md-button class=md-icon-button aria-label=User ng-click=$mdOpenMenu()><md-tooltip>User</md-tooltip><md-icon md-font-library=material-icons>face</md-icon></md-button><md-menu-content width=3 class=userPop-cont><div class=userPopp><div class=up-header>User Settings<div class=up-h-close ng-click=$mdCloseMenu()><i class="fa fa-times"></i></div></div><div class=up-cont><div class=up-name>{{vm.userpref().name}}</div><div class=up-sub>{{vm.userpref().pname}}</div></div><div class=up-footer><!--<div class="up-btn" ng-click="vm.changePassword();$mdCloseMenu()">Change Password</div>--><div class="up-btn -logoutBtn" ng-click=vm.logout();$mdCloseMenu()>Logout</div></div></div></md-menu-content></md-menu></div></div></md-toolbar>'),e.put("app/components/landingpage/leftnav/leftnav.html","<!DOCTYPE html><div ui-view=leftnav></div>"),e.put("app/components/landingpage/reports/reports.html","<!DOCTYPE html><div id=reports>This is reports view;</div>"),e.put("app/components/landingpage/dashboard/leftnavtree/leftnav_dashboard.html",'<!DOCTYPE html><style>md-checkbox {\n        margin: 8px;\n        cursor: pointer;\n        padding-left: 0px;\n        padding-right: 0;\n        line-height: 4px;\n        min-width: 18px;\n        min-height: 1px;\n    }\n    /*md-checkbox .md-icon {width:15px; height:15px;}*/\n    md-sidenav{height:100%;}\n    md-checkbox span{font-weight:normal;}\n\n    .angular-ui-tree-node, .angular-ui-tree-placeholder{line-height:22px;}\n\n    .hidden {\n        display: none!important;\n        visibility: hidden!important;\n    }\n\n    .search-result {\n        font-size:13px;\n        font-style:italic;\n        font-weight:normal;\n    }</style><!-- Template for parent nodes --><script type=text/ng-template id=parent_nodes_renderer.html><div class="icar-wrap-text">\n        <a ng-click="toggle(this)" style="cursor:pointer;" ng-show="item.items.length > 0">\n            <md-icon md-font-library="material-icons" ng-show="collapsed">arrow_drop_down</md-icon>\n            <md-icon md-font-library="material-icons" ng-show="!collapsed">play_arrow</md-icon>\n        </a>\n        <span style="padding-left:28px;" ng-hide="item.items.length > 0"></span>\n        <md-checkbox aria-label="Checkbox 1" ng-checked="\'checked\'===item.checkStatus"\n                     md-indeterminate="\'partlyChecked\'===item.checkStatus"\n                     ng-click="vm.toggleCheck(item)"\n                     data-nodrag>\n        </md-checkbox>\n        <span>{{item.title | titleCase }}</span ><br/>\n    </div>\n    <ol ui-tree-nodes ng-model="item.items" ng-show="collapsed">\n        <li ng-repeat="item in item.items" ui-tree-node\n            ng-hide="!treeFilter(item, vm.tree_search_pattern, supportedFields)"\n            ng-include="(item.items) ? \'parent_nodes_renderer.html\' : \'terminal_node_renderer.html\'">  </li>\n    </ol></script><!-- Template for terminal nodes --><script type=text/ng-template id=terminal_node_renderer.html><div class="tree-node tree-node-content">\n        <md-checkbox aria-label="chekbox" ng-checked="item.checkStatus === \'checked\'"\n                     md-indeterminate="item.checkStatus === \'partlyChecked\'"\n                     ng-click="vm.toggleCheck(item)"\n                     data-nodrag>\n        </md-checkbox>\n        <span>{{item.title | titleCase }}\n        </span>\n    </div></script><md-sidenav class=md-sidenav-left md-component-id=left md-is-locked-open=left_nav_toggle flex><!--The ROot Node--><md-input-container><label>Search</label><input type=text ng-model=vm.tree_search_pattern ng-change=vm.expandAll()> <span class=search-result ng-hide=!vm.search_results>0 results found</span></md-input-container><md-button ng-click=vm.expand_tree()>Expand</md-button><div ui-tree id=tree-root callbacks=treeOptions ng-if=vm.tree_data.length><ol ui-tree-nodes ng-model=vm.tree_data ng-class="{hidden: collapsed}"><li ng-repeat="item in vm.tree_data" ui-tree-node data-nodrag data-collapsed=collapsed ng-hide="vm.search_results = !treeFilter(item, vm.tree_search_pattern, supportedFields)" ng-include="(item.items) ? \'parent_nodes_renderer.html\' : \'terminal_node_renderer.html\'"></li></ol></div></md-sidenav>'),e.put("app/components/landingpage/dashboard/lefttoolbar/lefttoolbar_dashboard.html","<!DOCTYPE html><div id=lefttoolbar_dashboard></div>"),e.put("app/components/landingpage/dashboard/map/history-dialog.html",'<!DOCTYPE html><!--<md-dialog aria-label="Location Tracker History" ng-cloak flex="85">--><!--<md-toolbar style="height:42px; text-align:center;">--><!--<div class="md-toolbar-tools md-accent">--><!--<h2 layout-align="center center" style="width:100%" ng-click="another()">Location History</h2>--><!--<span flex></span>--><!--<md-button class="md-icon-button" ng-click="cancel()">--><!--<md-icon md-font-library="material-icons">close</md-icon>--><!--</md-button>--><!--</div>--><!--</md-toolbar>--><!--<md-content>--><!--<md-tabs class="" md-selected="selectedTab" md-align-tabs="top" md-border-bottom md-autoselect md-dynamic-height>--><!--<md-tab>--><!--<a ui-sref="home.history" style="width:100%; height:100%">History</a>--><!--</md-tab>--><!--<md-tab>--><!--<a ui-sref="home.geofence" style="width:100%; height:100%">Geofence</a>--><!--</md-tab>--><!--</md-tabs>--><!--<div flex ui-view="dialogview" style="width:100%; height:550px; background:#eee;">--><!--</div>--><!--</md-content>--><!--</md-dialog-content>--> <!--</md-dialog>-->'),e.put("app/components/landingpage/dashboard/map/history-map-control.html",'<!DOCTYPE html><div class=control-panel ng-class="{\'active\':gotHistory()}" layout=row flex=100><!--<div class=\'control-panel\'  layout="row" flex="100">--><div class=md-padding></div><div class=marker-details flex><span>Time : {{tracePointGpsTime | date : \'d MMM, h:mm:ss a\'}}</span><br><span>Odometer : {{tracePointOdometer}} km </span><br><span>Speed : {{tracePointSpeed}} kmph</span><br><span>Ignition : <span ng-show=ignStatus>ON</span> <span ng-show=!ignStatus>OFF</span></span></div><md-button class="md-fab md-primary md-mini play-pause-btns" ng-click=goSlow()><md-icon class=icon-font md-font-library=material-icons>fast_rewind</md-icon><md-tooltip>Go Slow</md-tooltip></md-button><md-button class="md-fab md-primary md-mini play-pause-btns" ng-show=play ng-click=playAnimation()><md-icon class=icon-font md-font-library=material-icons>play_arrow</md-icon><md-tooltip>Play</md-tooltip></md-button><md-button class="md-fab md-primary md-mini play-pause-btns" ng-hide=play ng-click=pauseAnimation()><md-icon class=icon-font md-font-library=material-icons>pause</md-icon><md-tooltip>Pause</md-tooltip></md-button><md-button class="md-fab md-primary md-mini play-pause-btns" ng-click=fastForward()><md-icon class=icon-font md-font-library=material-icons>fast_forward</md-icon><md-tooltip md-direction=top>Go Fast</md-tooltip></md-button><md-button class="md-fab md-primary md-mini play-pause-btns" ng-click=stopAnimation()><md-icon class=icon-font md-font-library=material-icons>stop</md-icon></md-button><div class=md-padding></div><md-slider class="md-accent icar-slider" md-discrete ng-model=slider step=1 min={{initialSliderTime}} ng-change=onChangeSlider() max={{finalSliderTime}} aria-label=timeline flex></md-slider><div class=md-padding></div><md-button class="md-fab md-primary md-mini play-pause-btns" ng-click="moveOneStep(\'backward\')"><md-icon class=icon-font md-font-library=material-icons>remove</md-icon></md-button><md-button class="md-fab md-primary md-mini play-pause-btns popover" data-content="Move 1 step" ng-click="moveOneStep(\'forward\')"><md-icon class=icon-font md-font-library=material-icons>add</md-icon></md-button><div class=md-padding></div><br><br><div class=historGraphContainer><!--<div class="dataLine" ng-repeat="data in sampleData" ng-if="data.ignition"--><!--style="width:{{graphWRatio}}%; left:{{($index * graphWRatio)}}%">--><!--</div>--><!----><canvas id=historyGraphCanvas style="height:100%; width: 100%"></canvas></div></div>'),e.put("app/components/landingpage/dashboard/map/immobalize-dialog.html",'<!DOCTYPE html><md-dialog aria-label=dialog><md-dialog-content><div class="div-area immobDialog" layout=column layout-align="center center"><div class=imd-head><span ng-class="{\'redColor\':!mobilityRequest,\'greenColor\':mobilityRequest}">{{msg}}</span><br><span>{{notify}}</span></div><table><tr><td>Vehicle No</td><td>{{vehicleno}}</td></tr><tr><td>Device ID</td><td>{{deviceid}}</td></tr></table></div></md-dialog-content><md-dialog-actions layout=row><div flex layout=row layout-align="space-around center"><md-button class="md-raised md-primary" ng-if=!commandSent ng-click=okImmobilize() style=margin-left:-8px>Yes</md-button><md-button class="md-raised md-primary" ng-if=!commandSent ng-click=cancelImmobalize()>No</md-button><md-button class="md-raised md-primary" ng-if=commandSent ng-click=cancelImmobalize()>OK</md-button></div></md-dialog-actions></md-dialog>'),e.put("app/components/landingpage/dashboard/map/info-window.html",'<div layout=column><div class=info-w-header></div><md-table-container style="min-height: 130px; max-height:130px; min-width:300px; max-width:300px;\n                                position: relative; overflow: hidden"><table md-table md-row-select multiple class=trPadding><tbody md-body><tr md-row md-select-id=carnumber class=infoWHead md-auto-select><td md-cell><strong>Reg.No</strong></td><td md-cell colspan=3>{{parameter.clickedMarker.vehicleno}}</td></tr><tr md-row md-select-id=timestamp md-auto-select><td md-cell><strong>Last seen at</strong></td><td md-cell colspan=3>{{parameter.clickedMarker.timestamp | date : \'dd MMM yyyy - h:mm a\'}}</td></tr><tr md-row md-select-id=odometer md-auto-select><td md-cell><strong>Odometer</strong></td><td md-cell class=infoWmiddle>{{parameter.clickedMarker.odometer}}</td><td md-cell><strong>Speed</strong></td><td md-cell>{{parameter.clickedMarker.speed}}</td></tr><tr md-row md-select-id=ignitionstatus md-auto-select><td md-cell><strong>Ignition</strong></td><td md-cell class=infoWmiddle>{{parameter.clickedMarker.ignitionstatus ? \'On\' : \'Off\'}}</td><td md-cell><strong>Mobility</strong></td><td md-cell>{{parameter.clickedMarker.mobilistatusFilter}}</td></tr><tr md-row md-select-id=carbattery md-auto-select><td md-cell><strong>Vehicle batt</strong></td><td md-cell class=infoWmiddle ng-class="{\'redBattery\' : parameter.clickedMarker.carbattery < 9.5 }">{{parameter.clickedMarker.carbattery}}</td><td md-cell><strong>Device batt</strong></td><td md-cell ng-class="{\'redBattery\' : parameter.clickedMarker.devbattery < 3.55 }">{{parameter.clickedMarker.devbattery}}</td></tr><tr md-row md-select-id=cartype md-auto-select><td md-cell><strong>Make</strong></td><td md-cell>{{parameter.clickedMarker.meta.cartype}}</td></tr><tr md-row md-select-id=deviceid md-auto-select><td md-cell><strong>Device ID</strong></td><td md-cell colspan=3>{{parameter.clickedMarker.deviceid}}</td></tr></tbody></table></md-table-container><div layout=row><md-button class="infoWBtn md-raised md-small infoWBtn" ng-hide=parameter.hideMobilityControls ng-click=parameter.mobilize(0)><span>Immobilize</span></md-button><md-button class="infoWBtn md-raised md-small infoWBtn" ng-hide=parameter.hideMobilityControls ng-click=parameter.mobilize(1)><span>Mobilize</span></md-button><md-button class="md-raised md-accent md-small infoWBtn" ng-click=parameter.showHistory()>History</md-button></div></div>'),e.put("app/components/landingpage/dashboard/map/map.html",'<!DOCTYPE html><style>.infowindow-img {\n        height: 30px;\n        width: 30px;\n    }\n\n    .infowindow-devbattery-img {\n        height: 50px;\n    }\n\n    .icar-padding {\n        padding: 5px;\n    }\n\n    .map-area {\n        padding: 0;\n    }\n\n    .container-margin {\n        margin-bottom: 0;\n        padding: 0;\n        height: 31px\n    }\n\n    ul {\n        margin: 0;\n    }\n\n    ul li {\n        width: 100%;\n        height: 100%;\n        list-style: none;\n    }\n\n    li {\n        text-align: center;\n    }\n\n    .icon-font {\n        font-size: 25px;\n    }\n\n    li:hover {\n        box-shadow: 1px 0px 6px 0px;\n        cursor: pointer;\n    }\n\n    .li-clicked {\n        background: #d1e934;\n    }\n\n    .md-light {\n        color: #000;\n    }\n\n    /*.icar-checkbox{*/\n    /*transform:scale(0.8);*/\n    /*}*/\n    .icon-visibility {\n        color: #000;\n    }\n\n    .icon-running {\n        color: #0C8;\n    }\n\n    .icon-stopped {\n        color: #6991FD;\n    }\n\n    .icon-active {\n        color: #000;\n    }\n\n    .icon-immobilized {\n        color: rgba(245, 86, 94, 0.85);\n    }\n\n    .lefttoolbar {\n        background: rgba(163, 204, 255, 0.7) !important;\n    }\n\n    .mapDView {\n        top: 52px;\n    }\n\n    .icar-tabs {\n        border-bottom: 1px solid #ccc;\n    }\n\n    .anchor-line {\n        border-bottom: 1px solid #F00;\n    }\n\n    #marker_infowindow {\n        display:none;\n    }</style><div><!--layout="row" layout-align="center center"--><div layout=row flex><md-input-container class=container-margin flex=30><input type=text placeholder="Apply filters..." size=50 ng-model=vm.filterStr ng-change=vm.runFilters(vm.filterStr)></md-input-container><div layout=row layout-align="center center"><div class=toggleButton ng-class="{\'active\':vm.onRoaded}">On Road <input type=checkbox class=icar-checkbox ng-model=vm.onRoaded aria-label=onroaded ng-change=vm.onRoadCheck()></div><div class=toggleButton ng-class="{\'active\':vm.offRoaded}">Off Road <input type=checkbox class=icar-checkbox ng-model=vm.offRoaded aria-label=onroaded ng-change=vm.offRoadCheck()></div></div><ul id=nav layout=row layout-align="end center" flex><li ng-class="{true: \'li-clicked\'}[vm.filterStr==\'\']" ng-click="vm.runFilters(\'\')" layout=column layout-align="center center"><md-icon ng-class="{true: \'md-light\'}[vm.filterStr==\'\']" class="icon-font icon-visibility" md-font-library=material-icons>visibility</md-icon><span ng-class="{true: \'md-light\'}[vm.filterStr==\'\']" style="font-size: 13px">{{vm.vehicleStats.showall}}</span><md-tooltip>All</md-tooltip></li><li ng-class="{true: \'li-clicked\'}[vm.filterStr==\'Running\']" ng-click="vm.runFilters(\'Running\')" layout=column layout-align="center center"><md-icon ng-class="{true: \'md-light\'}[vm.filterStr==\'Running\']" class="icon-font icon-running" md-font-library=material-icons>time_to_leave</md-icon><span ng-class="{true: \'md-light\'}[vm.filterStr==\'Running\']" style="font-size: 13px">{{vm.vehicleStats.running}}</span><md-tooltip>Ignition On</md-tooltip></li><li ng-class="{true: \'li-clicked\'}[vm.filterStr==\'Stopped\']" ng-click="vm.runFilters(\'Stopped\')" layout=column><md-icon ng-class="{true: \'md-light\'}[vm.filterStr==\'Stopped\']" class="icon-font icon-stopped" md-font-library=material-icons>radio_button_checked</md-icon><span ng-class="{true: \'md-light\'}[vm.filterStr==\'Stopped\']" style="font-size: 13px">{{vm.vehicleStats.stopped}}</span><md-tooltip>Ignition Off</md-tooltip></li><li ng-class="{true: \'li-clicked\'}[vm.filterStr==\'Active\']" ng-click="vm.runFilters(\'Active\')" layout=column><md-icon ng-class="{true: \'md-light\'}[vm.filterStr==\'Active\']" class="icon-font icon-active" md-font-library=material-icons>lock_open</md-icon><span ng-class="{true: \'md-light\'}[vm.filterStr==\'Active\']" style="font-size: 13px">{{vm.vehicleStats.active}}</span><md-tooltip>Active</md-tooltip></li><li ng-class="{true: \'li-clicked\'}[vm.filterStr==\'Immobilized\']" ng-click="vm.runFilters(\'Immobilized\')" layout=column><md-icon ng-class="{true: \'md-light\'}[vm.filterStr==\'Immobilized\']" class="icon-font icon-immobilized" md-font-library=material-icons>lock</md-icon><span ng-class="{true: \'md-light\'}[vm.filterStr==\'Immobilized\']" style="font-size: 13px">{{vm.vehicleStats.immobilized}}</span><md-tooltip>Immoblized</md-tooltip></li><li ng-class="{true: \'li-clicked\'}[vm.filterStr==\'Not Communicating\']" ng-click="vm.runFilters(\'Not Communicating\')" layout=column><md-icon ng-class="{true: \'md-light\'}[vm.filterStr==\'Not Communicating\']" class="icon-font icon-immobilized" md-font-library=material-icons>signal_cellular_off</md-icon><span ng-class="{true: \'md-light\'}[vm.filterStr==\'Immobilized\']" style="font-size: 13px">{{vm.vehicleStats.noComm}}</span><md-tooltip>Vehicle Not Communicating</md-tooltip></li><li ng-class="{true: \'li-clicked\'}[vm.filterStr==\'Device pullout\']" ng-click="vm.runFilters(\'Device pullout\')" layout=column><md-icon ng-class="{true: \'md-light\'}[vm.filterStr==\'Device pullout\']" class="icon-font icon-immobilized" md-font-library=material-icons>sim_card_alert</md-icon><span ng-class="{true: \'md-light\'}[vm.filterStr==\'Device pullout\']" style="font-size: 13px">{{vm.vehicleStats.devPullout}}</span><md-tooltip>Device Pullout</md-tooltip></li></ul></div><div class=lefttoolbar ng-controller="GeofenceViewController as vm"><div class=ltb_item ng-repeat="item in vm.leftTB" ng-mouseenter="item.activeInt = 1" ng-mouseleave="item.activeInt = 0" ng-class="{\'ltb_item-line\':item.type == \'line\', \'active\': vm.fencesActive()}"><div class=ltbi_button ng-click=vm.buttonClick(item) ng-if="item.type == \'button\' || item.type == \'toggleButton\'" ng-class="{\'active\':item.data.active && item.type == \'toggleButton\',\n                 \'independ\':item.data.independent,\'hasChildren\':item.children }"><div class=ltbi_icon ng-if="item.hasOwnProperty(\'icon\')"><i class="fa {{item.icon}}" ng-if="item.iconType == \'fa\'" aria-hidden=true></i> <i ng-if="item.iconType == \'md\'" class=material-icons>{{item.icon}}</i> <img ng-if="item.iconType == \'png\' && item.data.active" ng-src={{item.icon}}.active.png> <img ng-if="item.iconType == \'png\' && !item.data.active" ng-src={{item.icon}}.png> <i ng-if="item.iconType == \'png\'" style="position: absolute; color: rgba(0,0,0,0)!important; width: 80%; height: 80%"></i></div><div class=ltbi_name ng-if=item.name>{{item.name}} <span>{{item.description}}</span></div></div><div class=ltbi_cont ng-if=item.content ng-if="item.type == \'button\' || item.type == \'toggleButton\' "><md-input-container class=md-input-cont><label>Color</label><input type=text ng-model=color></md-input-container></div><!--Child Buttons--><div class=ltbi_loc ng-init="item.activeInt = 0" ng-if=item.children style="width: {{((item.children.length * 44) + 40 ) * item.activeInt }}px"><div ng-repeat="child in item.children" class=ltbil_item ng-click="vm.childClick(child,item.childType )" ng-class="{\'active\':child.id == vm.currentLocation}" ng-if="item.childType == \'location\'">{{child.notation}}</div><div class="ltbil_item childButton" ng-click=vm.buttonClick(child) ng-if="item.childType == \'button\'" ng-repeat="child in item.children" ng-class="{\'active\':child.data.active && child.type == \'toggleButton\',\'independ\':child.data.independent }"><div class=ltbi_icon ng-if="child.hasOwnProperty(\'icon\')"><i class="fa {{child.icon}}" ng-if="child.iconType == \'fa\'" aria-hidden=true></i> <i ng-if="child.iconType == \'md\'" class=material-icons>{{child.icon}}</i> <img ng-if="child.iconType == \'png\' && !child.data.active" ng-src={{child.icon}}.png> <img ng-if="child.iconType == \'png\' && child.data.active" ng-src={{child.icon}}.active.png> <i ng-if="child.iconType == \'png\'" style="position: absolute; color: rgba(0,0,0,0)!important; width: 80%; height: 80%">a</i></div><div class=ltbi_name ng-if=child.name>{{child.name}}<!--<span>{{child.description}}</span>--></div></div></div></div></div><div id=mapCanvas><!--<script id="searchbox.tpl.html" type="text/ng-template">--><!--<input id="pac-input" type="text" placeholder="Search">--><!--</script>--> <input id=pac-input class=controls type=text placeholder=Search...><div id=map style=width:100%></div></div></div><div class=int-dialog ng-controller="DialogController as vm"><!--<div class="id-background" ng-click="vm.closeTab()"></div>--><div class=id-container ng-if=vm.dialogShow()><div class=id-header><div class=map-DHeader1><span>Vehicle History</span> <button class="md-icon-button md-button md-ink-ripple" type=button style=float:right ng-click=vm.closeTab() aria-label=close><md-icon md-font-library=material-icons class="ng-scope material-icons">close</md-icon><div class=md-ripple-container></div></button></div></div><div class=id-body><div class="row icar-tabs"><div class="col s12"><ul class=tabs select_tab=vm.selectedTab><li class="tab col s2"><a ng-class="{true: \'active anchor-line\'}[vm.selectedTab == 0]" ui-sref=home.history>HISTORY</a></li><li class="tab col s2"><a ng-class="{true: \'active anchor-line\'}[vm.selectedTab == 1]" ui-sref=home.historyData>HISTORY Report</a></li><li class="tab col s2"><a ng-class="{true: \'active anchor-line\'}[vm.selectedTab == 2]" ui-sref=home.geofence>Geofence</a></li><li class="tab col s2"><a ng-class="{true: \'active anchor-line\'}[vm.selectedTab == 3]" ui-sref=home.alarm>Alarms</a></li><li class="tab col s2"><a ng-class="{true: \'active anchor-line\'}[vm.selectedTab == 4]" ui-sref=home.downloadHistory>Download Reports</a></li></ul></div><div flex ui-view=dialogview id=dialogview class=mapDView></div></div></div></div></div><div id=fence_infowindow layout=row ng-non-bindable flex><div layout=column id=fenceWindow ng-cloak><table><tbody><tr><th>Name:</th><td>{{vm.selectedFenceObj.info.name}}</td></tr><tr><th>Type:</th><td>{{vm.selectedFenceObj.info.tagdata.olafilter}}</td></tr></tbody></table></div></div><div id=marker_infowindow layout=row ng-non-bindable flex ng-cloak><div layout=column id=markerWindow ng-cloak><div class=info-w-header></div><md-table-container style="min-height: 150px; max-height:175px; min-width:300px; max-width:300px;\n                                position: relative; overflow: hidden"><table md-table md-row-select multiple class=trPadding><tbody md-body><tr md-row md-select-id=carnumber class=infoWHead md-auto-select><td md-cell><strong>Reg.No</strong></td><td md-cell colspan=3 id=myreg>{{clickedMarker.rtgps.vehicleno}}</td></tr><tr md-row md-select-id=deviceid md-auto-select><td md-cell><strong>Device ID</strong></td><td md-cell colspan=3>{{clickedMarker.rtgps.deviceid}}</td></tr><tr md-row md-select-id=cartype md-auto-select><td md-cell><strong>Model</strong></td><td md-cell colspan=3>{{clickedMarker.rtgps.meta.cartype}}</td></tr><tr md-row md-select-id=timestamp md-auto-select><td md-cell><strong>Last seen at</strong></td><td md-cell colspan=3 id=timestamp>{{clickedMarker.rtgps.timestamp | date : \'dd MMM yyyy - h:mm a\'}}</td></tr><tr md-row md-select-id=odometer md-auto-select><td md-cell><strong>Odometer</strong></td><td md-cell class=infoWmiddle id=odometer>{{clickedMarker.rtgps.odometer}}</td><td md-cell><strong>Speed</strong></td><td md-cell id=speed>{{clickedMarker.rtgps.speed}}</td></tr><tr md-row md-select-id=ignitionstatus md-auto-select><td md-cell><strong>Ignition</strong></td><td md-cell class=infoWmiddle id=ignition>{{clickedMarker.rtgps.ignitionstatus ? \'On\' : \'Off\'}}</td><td md-cell><strong>Mobility</strong></td><td md-cell id=mobility>{{clickedMarker.rtgps.mobilistatusFilter}}</td></tr><tr md-row md-select-id=carbattery md-auto-select><td md-cell><strong>Vehicle batt</strong></td><td md-cell class=infoWmiddle ng-class="{\'redBattery\' : clickedMarker.rtgps.carbattery < 9.5 }">{{clickedMarker.rtgps.carbattery}}</td><td md-cell><strong>Device batt</strong></td><td md-cell ng-class="{\'redBattery\' : clickedMarker.rtgps.devbattery < 3.55 }">{{clickedMarker.rtgps.devbattery}}</td></tr></tbody></table></md-table-container><br><div layout=row><md-button class="infoWBtn md-raised md-small infoWBtn" ng-hide=hideMobilityControls ng-click=vm.mobilize(0)><span>Immobilize</span></md-button><md-button class="infoWBtn md-raised md-small infoWBtn" ng-hide=hideMobilityControls ng-click=vm.mobilize(1)><span>Mobilize</span></md-button><md-button class="md-raised md-accent md-small infoWBtn" id=historyBtn ng-click=vm.showHistory()>History</md-button></div></div></div>'),e.put("app/components/landingpage/dashboard/rightnav/rightnavalert_dashboard.html",'<!DOCTYPE html><style>.md-button{\n        text-transform:capitalize;\n    }\n    .alert-md-content{height:590px;overflow-y:scroll;}\n    .container-margin{margin-bottom: 0; padding:0; height:31px}\n\n    .md-title {font-size:13px !important;}\n\n    .panel-content{padding:4px 4px;}\n\n    .ignition-on-bg {\n        background:#2acc60 !important;\n    }\n    .ignition-off-bg {\n        background:#6476a2 !important;\n    }</style><style>.sidenav {\n        height: 100%;\n        width: 320px;\n        position: fixed;\n        z-index: 1;\n        top: 0;\n        right: 0;\n        overflow-x: hidden;\n        transition: 0.5s;\n        padding-top: 60px;\n        border-left:1px solid #ccc;\n    }\n\n    #main {\n        margin-right:320px;\n        transition: margin-right .5s;\n    }\n\n    @media screen and (max-height: 450px) {\n        .sidenav {padding-top: 15px;}\n    }\n\n\n    .sidenav .id-body {\n        width:320px;\n        /*transition: 0.3s*/\n    }\n\n    .webui-popover-content{\n        word-wrap:break-word;\n    }\n\n    /*.eye-icon{*/\n        /*position: absolute;*/\n        /*right: 3px;*/\n        /*top: 68px;*/\n    /*}*/\n\n    .tabs .tab a{\n        padding:0;\n    }</style><div id=mySidenav class=sidenav><div class=id-body id=right_side_nav_content><div class=row><div class="col s12" style=padding:0><ul class=tabs><li class="tab col s4"><a class=active href=#active>Active</a></li><li class="tab col s4"><a href=#history>History</a></li><li class="tab col s4"><a href=#alarms>Alarms</a></li></ul>{{vm.vehicleAddress}}</div><div id=active class="col s12"><span class="spinner -sp-blue -sp-big" ng-if=!vm.activeTabData></span><div class="expansionNav coolbar" style=top:110px ng-if=vm.activeTabData><!--first wrapper--><div class=en_main ng-if="mainKey != \'active\' && vm.navFilter(main)" ng-class="{\'active\':main.active}" ng-repeat="(mainKey, main) in vm.activeTabData " ng-init="main.active = true"><div class=en_label ng-class="{\'{{main.class}}\':true}" ng-click=vm.itemClicked(main,1) style="background:#4FC3F7 !important">{{mainKey}}<div class="enl_item enl_add"><i class="fa fa-plus" ng-if=!main.active></i> <i class="fa fa-minus" ng-if=main.active></i></div><div class="enl_item enl_count">{{vm.returnLength(main,1)}}</div></div><!--middle wrapper--><div class=en-wrapper><div class=en_mid ng-repeat="(midKey, mid) in main " ng-if="midKey != \'active\' && vm.navFilter(mid)" ng-init="mid.active = true" ng-class="{\'en-closed\':!main.active}" style=height:{{vm.returnHeight(mid);}}><div class=en_label ng-click=vm.itemClicked(mid,2) style=background:#B3E5FC!important>{{midKey}}<div class="enl_item enl_add"><i class="fa fa-plus" ng-if=!mid.active></i> <i class="fa fa-minus" ng-if=mid.active></i></div><div class="enl_item enl_count">{{vm.returnLength(mid,2)}}</div></div><!--final wrapper--><div class=en-wrapper><div class=en_last ng-repeat="(carKey, car) in mid" ng-if="carKey != \'active\' && vm.navFilter(car)" ng-class="{\'active\':car.active && mid.active,\'en-closed\':!mid.active, \'noExit\':car.stillActive}"><div class=en_head ng-click="vm.itemClicked(car,3); " ng-class="{\'resolvedHeader\':car.resolved}">{{carKey}}<!--<div class="enl_item enl_add">--><!--<i class="fa fa-plus" ng-if="!car.active"></i>--><!--<i class="fa fa-minus" ng-if="car.active"></i>--><!--</div>--><div class="enl_item enl_entry" ng-class="{\'redBG\':!car.triggerType,\'greenBG\':car.triggerType}"><i class="fa fa-arrow-down" ng-if=car.triggerType></i> <i class="fa fa-arrow-up" ng-if=!car.triggerType></i></div><div class="enl_item enl_time" ng-class="{ \'ignition-on-bg\': vm.vehicleData[carKey].ignitionstatus==1 ,\n                                                 \'ignition-off-bg\': vm.vehicleData[carKey].ignitionstatus==0  }">{{ vm.getTimeDiff(car) }}</div></div><div class=en_body><div class=enb_full ng-if=car.triggerType><i class="fa fa-arrow-down greenColor"></i> Entry : {{car.entry | date : \'d MMM, h:mm a\'}}</div><div class=enb_full ng-if=!car.triggerType><i class="fa fa-arrow-up redColor"></i> Exit : {{car.entry | date : \'d MMM, h:mm a\'}}</div><!--<div class="enb_full" ng-if="!car.stillActive">--><!--<i class="fa fa-arrow-up redColor" ></i> Exit : {{car.exit | date : \'d MMM, h:mm a\'}}--><!--</div>--><div class=enb_full><textarea class=coolbar placeholder="Put Your Message" ng-keydown=vm.resolutionKeyEvent($event,car)></textarea><div class=enb_button_list><button class=blueBG ng-if="car.state != vm.SAVING" ng-click=vm.saveRep(car)><i class="fa fa-save"></i></button> <button class=greyBG ng-if="car.state == vm.SAVING"><span class=spinner></span></button> <button class=greenBG ng-if="!car.resolved && car.state != vm.RESOLVING" ng-click=vm.resolve(car)><i class="fa fa-check"></i></button> <button class=redBG ng-if="car.resolved && car.state != vm.RESOLVING" ng-click=vm.resolve(car)><i class="fa fa-times"></i></button> <button class=greyBG ng-if="car.state == vm.RESOLVING"><span class=spinner></span></button></div></div></div></div></div></div></div></div></div></div><div id=history class="col s12"><div class="expansionNav coolbar" style=top:110px ng-if=vm.activeTabData><!--first wrapper--><div class=en_main ng-if=vm.navFilter(main) ng-class="{\'active\':main.active}" ng-repeat="main in vm.reports " ng-init="main.active = true"><div class=en_label ng-class="{\'{{main.class}}\':true}" ng-click=vm.itemClicked(main,1) style="background:#4FC3F7 !important">{{main.reportName}}<div class="enl_item enl_add"><i class="fa fa-plus" ng-if=!main.active></i> <i class="fa fa-minus" ng-if=main.active></i></div></div><div class=en-wrapper><div ng-repeat="fence in main.fences" style="width: 100%;float:left"><div class=en_mid ng-repeat="(midKey, mid) in fence" ng-if="midKey != \'id\' && midKey != \'name\' && midKey != \'active\' && mid.length > 0" ng-class="{\'en-closed\':!main.active,\'en-semi-closed\':!mid.active}" style="height:{{(mid.length * 30) + 67}}px" ng-init="mid.active = true;"><div class=en_label ng-click=vm.itemClicked(mid,2) style=background:#B3E5FC!important>{{ midKey}}<div class="enl_item enl_add"><i class="fa fa-plus" ng-if=!mid.active></i> <i class="fa fa-minus" ng-if=mid.active></i></div><div class="enl_item enl_count">{{vm.returnLength(mid,2)}}</div></div><div class=en-wrapper><table class=en_entryexit><tr><th><i class="fa fa-chevron-down greenColor"></i> Entry Time</th><th><i class="fa fa-chevron-up redColor"></i> Exit Time</th></tr><tr ng-repeat="vehicle in mid"><td>{{vehicle.fentry | date : \'d MMM, h:mm a\'}}</td><td>{{vehicle.fexit | date : \'d MMM, h:mm a\'}}</td></tr></table></div></div></div></div></div></div></div><div id=alarms class="col s12"><div class="expansionNav coolbar" style=top:110px ng-if=vm.activeAlarmData><!--first wrapper--><div class=en_main ng-if=vm.navFilter(main) ng-class="{\'active\':main.active}" ng-repeat="(mainKey, main)  in vm.activeAlarmData " ng-init="main.active = true"><div class=en_label ng-class="{\'{{main.class}}\':true}" ng-click=vm.itemClicked(main,1) style="background:#4FC3F7 !important">{{ mainKey | limitTo: 30 }}{{mainKey.length > 30 ? \'...\' : \'\'}}<div class="enl_item enl_add"><i class="fa fa-plus" ng-if=!main.active></i> <i class="fa fa-minus" ng-if=main.active></i></div></div><div class=en-wrapper><div class=en_mid ng-repeat="(midKey, mid) in main track by $index" ng-if="midKey != \'id\' && midKey != \'name\' && midKey != \'active\'" ng-class="{\'en-closed\':!main.active,\'en-semi-closed\':!mid.active}" style=height:110px><div class=en_label ng-click=vm.itemClicked(mid,2) style=background:#B3E5FC!important>{{ midKey }}<div class="enl_item enl_add"><i class="fa fa-plus" ng-if=!mid.active></i> <i class="fa fa-minus" ng-if=mid.active></i></div><!--<div class="enl_item enl_count">{{vm.returnLength(mid,2)}}</div>--></div><div class=en-alarm-final><div class=en-af-item>Time : {{mid.timestamp | date : \'d MMM, h:mm a\'}}</div><div class=en-af-item>Mode : {{mid.opermode }}</div><div class=en-af-item><a href=# class="eye-icon pops{{midKey}}{{$index}}" data-content={{vm.vehicleAddress}} ng-mouseover="vm.getAddress(midKey, $index, mid.latitude, mid.longitude)">Loc : {{mid.latitude }},{{mid.longitude }} </a><!--<div class="pops{{$index}}"></div>--></div></div></div></div></div></div></div></div></div></div><script>$(document).ready(function(){\n        $(\'ul.tabs\').tabs();\n    });</script>'),
e.put("app/components/landingpage/management/leftnav/leftnav_mgmt.html",'<!DOCTYPE html><style>/*md-checkbox {*/\n        /*margin: 8px;*/\n        /*cursor: pointer;*/\n        /*padding-left: 0px;*/\n        /*padding-right: 0;*/\n        /*line-height: 4px;*/\n        /*min-width: 18px;*/\n        /*min-height: 1px;*/\n    /*}*/\n    /*md-sidenav{height:100%;}*/\n    md-checkbox span{font-weight:normal;}\n\n    .angular-ui-tree-node, .angular-ui-tree-placeholder{line-height:22px;}\n\n    .hidden {\n        display: none!important;\n        visibility: hidden!important;\n    }\n\n    .search-result {\n        font-size:13px;\n        font-style:italic;\n        font-weight:normal;\n    }\n\n    .tree-str{\n        overflow-y: scroll;\n        position: absolute;\n        width: 100%;\n        top: 120px;\n        right: 0;\n        bottom: 0;\n    }</style><style>.left-sidenav {\n        height: 100%;\n        width: 320px;\n        position: fixed;\n        z-index: 1;\n        top: 0px;\n        left: 0;\n        overflow-x: hidden;\n        transition: 0.5s;\n        padding-top: 60px;\n        color:#000;\n    }\n    #main {\n        margin-left:320px;\n        transition: margin-left .5s;\n    }\n\n    @media screen and (max-height: 450px) {\n        .left-sidenav {padding-top: 15px;}\n        .left-sidenav a {font-size: 18px;}\n    }\n\n    #myLeftSidenav{\n        border-right:1px solid #ccc;\n        overflow:hidden;\n    }</style><!-- Template for parent nodes --><script type=text/ng-template id=parent_nodes_renderer.html><div class="ln-main"ng-class="{\'active\':vm.selectedAsset == item.id}">\n        <div class="ln-arrow" ng-click="item.collapsed = !item.collapsed" ng-show="item.items.length > 0"\n        ng-class="{\'active\':item.collapsed}"><i class="fa fa-chevron-right"></i></div>\n\n        <div class="ln-heading" ng-click="vm.handleAssetClick(item, item.collapsed, toggle, this); item.collapsed = true"\n        ng-class="{\'no-arrow\':item.items.length <= 0, \'active\':vm.selectedAsset == item.id}">{{item.title | titleCase }}</div>\n        <span class="spinner -blue -relative" ng-class="{\'opacity_0\':!item.loading}" ng-if="item.loading"></span>\n    </div>\n    <div class="ln-child-cont" ng-model="item.items" ng-show="item.collapsed">\n        <div ng-repeat="item in item.items" ui-tree-node class="ln-child"\n             ng-include="(item.items) ? \'parent_nodes_renderer.html\' : \'terminal_node_renderer.html\'"></div>\n    </div></script><!-- Template for terminal nodes --><script type=text/ng-template id=terminal_node_renderer.html><div class="tree-node tree-node-content">\n        <md-checkbox aria-label="chekbox" ng-checked="item.checkStatus === \'checked\'"\n                     md-indeterminate="item.checkStatus === \'partlyChecked\'"\n                     ng-click="vm.toggleCheck(item)"\n                     data-nodrag>\n        </md-checkbox>\n        <span style="cursor:default;">{{item.title | titleCase}}\n        </span>\n    </div></script><div id=myLeftSidenav class=left-sidenav><div class="input-field col s6"><input id=last_name type=text class=validate ng-model=vm.tree_search_pattern ng-change=vm.expand_tree()><label for=last_name>Search</label></div><div ui-tree id=tree-root callbacks=treeOptions class=tree-str ng-cloak><ol ui-tree-nodes ng-model=vm.tree_data ng-class="{hidden: collapsed}"><li ng-repeat="item in vm.tree_data" ui-tree-node data-nodrag data-collapsed=item.collapsed ng-include="(item.items) ? \'parent_nodes_renderer.html\' : \'parent_nodes_renderer.html\'"></li></ol></div></div>'),e.put("app/components/landingpage/management/rightnav/rightnav_mgmt.html","<!DOCTYPE html><style>.sidenav {\n        height: 100%;\n        width: 0;\n        position: fixed;\n        z-index: 1;\n        top: 0;\n        right: 0;\n        overflow-x: hidden;\n        transition: 0.5s;\n        padding-top: 60px;\n        border-left:1px solid #ccc;\n    }\n\n    #main {\n        transition: margin-right .8s;\n    }\n\n    @media screen and (max-height: 450px) {\n        .sidenav {padding-top: 15px;}\n    }\n\n\n    .sidenav .id-body {\n        width:320px;\n        /*transition: 0.3s*/\n    }\n\n    .eye-icon{\n        position: absolute;\n        right: 3px;\n        top: 68px;\n    }</style><div class=sidenav id=mySidenav>Rightnav Mgmt Controller</div>"),e.put("app/components/landingpage/dashboard/map/dialog/alarm.html",'<!--<md-tab-body >--><style>.error-msg {\n        color: #f00;\n        font-size: 12px;\n        min-height: 20px;\n    }\n\n    table.geo-table thead tr{\n        padding:0;\n        height:35px;\n    }\n\n    .google-visualization-table-tr-sel{\n        background: red !important;\n    }\n    .alarm-cont .geoc-body{top:50px}\n    #DataTables_Table_0_filter, .dataTables_filter{\n        position: absolute !important;\n        top: -45px !important;\n        z-index: 999;\n        left: 330px !important;\n    }\n\n    md-checkbox{\n        position:relative !important;\n        left:0 !important;\n        opacity: 1 !important;\n    }\n\n    md-list-item.md-2-line, md-list-item.md-2-line > .md-no-style{\n        height:30px !important;\n        min-height:30px !important;\n    }\n\n    .latlng:hover{cursor:pointer;}\n\n    .dataTables_filter label {\n\n    }</style><div class=alarm-cont><div class=geoc-head><span class=error-msg>{{vm.alarms.msg}}</span><br><div layout=row layout-align="space-around center"><div layout=row class=input-fields layout-align="space-around center" flex=70><div class=geo-mul-back ng-show=vm.currPop ng-click="vm.currPop = null"></div><md-input-container class="container-margin geo-multiSel"><label>Vehicle Name ({{vm.alarms.selectedVehiclesCount}})</label><input type=text ng-focus="vm.currPop = \'vehiclePop\'" placeholder="Search Vehicle" ng-model=vm.alarms.vehicleFilterPattern ng-change=vm.filterVehicles()><div class=geo-ms-cont ng-show="vm.currPop == \'vehiclePop\'"><md-list><md-list-item class=md-2-line ng-repeat="item in vm.alarms.filteredVehicles "><md-checkbox ng-model=item.checked aria-label=myvehicles ng-change="vm.verifyCheckStatus(\'vehicle\')"></md-checkbox><div class=md-list-item-text><h3>{{item.name}}</h3></div></md-list-item></md-list><div class=geo-ms-controls><md-checkbox ng-model=vm.selectAllVehicles aria-label=all ng-change="vm.selectAll(\'vehicle\')">All</md-checkbox><md-checkbox ng-model=vm.deSelectAllVehicles aria-label=None ng-change="vm.deSelectAll(\'vehicle\')">None</md-checkbox></div></div></md-input-container><md-input-container class=container-margin><label>Start Time</label><input type=text id=start_time ng-model=vm.alarms.startTime></md-input-container><md-input-container class=container-margin><label>End Time</label><input type=text id=end_time ng-model=vm.alarms.endTime></md-input-container><!--<md-button class="md-accent" ng-click="vm.getHistory()">Get Report</md-button>--> <a class="waves-effect waves-light btn" ng-click=vm.getHistory()>Get Report</a><md-button class="md-fab md-mini my-tooltip pops" ng-disabled=vm.alarms.loadingAlarmData ng-click=vm.downloadFile()><md-icon md-font-library=material-icons>file_download</md-icon></md-button></div><div layout=row layout-align="end start"></div></div></div><div class=progress ng-if=vm.alarms.loadingAlarmData><div class=indeterminate></div></div><div class=geoc-body id=table_area><!--<div layout="row" layout-sm="column" layout-align="space-around"--><!--ng-show="">--><!--<md-progress-circular md-mode="indeterminate"></md-progress-circular>--><!--</div>--><div ng-hide=vm.alarms.loadingAlarmData style="width: 100%; height: 100%"><table datatable=ng dt-options=vm.dtOptions dt-instance=dtInstanceCallback class="row-border hover table table-striped" width=100% ng-cloak><thead><tr><th width=150>Vehicle No</th><th width=150>Time</th><th>Reason</th><th>Speed</th><th>Opperation Mode</th><th>Location</th></tr></thead><tbody><tr ng-repeat="report in vm.alarms.alarmResponseData track by $index"><td width=150>{{report.vehicleno}}</td><td width=150>{{report.gpstime | date : \'d MMM, h:mm a\'}}</td><td>{{report.alarmreason}}</td><td>{{report.speed}}</td><td>{{report.opermode}}</td><td><span ng-if=!vm.convertLatLngToAddr class="latlng loc{{$index}}" ng-mouseover="vm.getAddress(report.lat, report.lng, $index)" data-content="Fetching Address">{{report.lat }},{{report.lng }} </span><span ng-if=vm.convertLatLngToAddr>{{report.addr}}</span></td></tr></tbody></table></div><!--<span ng-show="vm.dataFound">No Data Found</span>--></div></div><script>$(document).ready(function () {\n        $(\'#start_time\').datetimepicker({\n            mask: \'9999-19-39 29:59\',\n            format: \'Y-m-d H:i\'\n        });\n\n        $(\'#end_time\').datetimepicker({\n            mask: \'9999/19/39 29:59\',\n            format: \'Y-m-d H:i\'\n        });\n    });</script>'),e.put("app/components/landingpage/dashboard/map/dialog/downloadHistory.html",'<style>.error-msg {\n        color: #f00;\n        font-size: 12px;\n        min-height: 20px;\n    }</style><span class=error-msg>{{vm.errorMsg}}</span><br><div class=dh_container><div class=dhc_name>Last location report</div><md-input-container class=container-margin><label>Select Area</label><!--<md-select ng-model="vehicle" ng-model-options="{trackBy: \'$value.vehicleno\'}">--><md-select ng-model=vm.selectedGroup ng-model-options="{trackBy: \'$value.assetpath\'}"><md-option ng-repeat="group in vm.groups" ng-value=group>{{group.name}}</md-option></md-select></md-input-container><a class="tc_button waves-effect waves-light btn raised" ng-click=vm.download() ng-disabled=vm.showLoading>DOWNLOAD</a></div><div class=progress ng-if=vm.showLoading><div class=indeterminate></div></div>'),e.put("app/components/landingpage/dashboard/map/dialog/geofence.html",'<!--<md-tab-body >--><style>.error-msg {\n        color: #f00;\n        font-size: 12px;\n        min-height: 20px;\n    }\n\n    table.geo-table thead tr{\n        padding:0;\n        height:35px;\n    }\n\n    .google-visualization-table-tr-sel{\n        background: red !important;\n    }\n    md-checkbox{\n        position:relative !important;\n        left:0 !important;\n        opacity: 1 !important;\n    }\n\n\n    md-list-item.md-2-line, md-list-item.md-2-line > .md-no-style{\n        height:30px !important;\n        min-height:30px !important;\n    }\n\n\n    .google-visualization-table-tr-odd {\n        background-color: #eee;\n    }</style><div class=geofence-cont style="height: 100%"><div class=geo-leftbar ng-click="vm.currPop = null"><div class="geo-rep-item-head shadow-border">Reports</div><div class="geo-lb-cont coolbar"><div class=geo-rep-item ng-class="{\'active\':vm.fenceReportObj.reportId == rep.assetpath}" ng-repeat="rep in vm.fenceReportObj.reports" ng-click=vm.getSelectedFences(rep)>{{rep.name}}</div></div></div><div class=geo-cont><div class=geoc-head><span class=error-msg>{{vm.errorMsg}}</span><br><div layout=row layout-align="space-around center"><div layout=row class=input-fields layout-align="space-around center" flex><div class=geo-mul-back ng-show=vm.currPop ng-click="vm.currPop = null"></div><md-input-container class="container-margin geo-multiSel"><label>Fence Name ({{vm.fenceReportObj.selectedFencesCount}})</label><input type=text ng-focus=" vm.currPop = \'fencePop\'" placeholder="Search Fences" ng-model=vm.fenceReportObj.fenceFilter ng-change=vm.filterFences()><div class=geo-ms-cont ng-show="vm.currPop == \'fencePop\'"><md-list><md-list-item class=md-2-line ng-repeat="item in vm.fenceReportObj.filteredFenceItems "><md-checkbox ng-model=item.checked aria-label=myfences ng-change="vm.verifyCheckStatus(\'fence\')"></md-checkbox><div class=md-list-item-text><h3>{{item.name}}</h3></div></md-list-item></md-list><div class=geo-ms-controls><md-checkbox ng-model=vm.selectAllFences aria-label=all ng-change="vm.selectAll(\'fence\')">All</md-checkbox><md-checkbox ng-model=vm.deSelectAllFences aria-label=None ng-change="vm.deSelectAll(\'fence\')">None</md-checkbox></div></div></md-input-container><md-input-container class="container-margin geo-multiSel"><label>Vehicle Name ({{vm.fenceReportObj.selectedVehiclesCount}})</label><input type=text ng-focus="vm.currPop = \'vehiclePop\'" placeholder="Search Vehicle" ng-model=vm.fenceReportObj.vehicleFilter ng-change=vm.filterVehicles()><div class=geo-ms-cont ng-show="vm.currPop == \'vehiclePop\'"><md-list><md-list-item class=md-2-line ng-repeat="item in vm.fenceReportObj.filteredItems"><md-checkbox ng-model=item.checked aria-label=myvehicles ng-change="vm.verifyCheckStatus(\'vehicle\')"></md-checkbox><div class=md-list-item-text><h3>{{item.name}}</h3></div></md-list-item></md-list><div class=geo-ms-controls><md-checkbox ng-model=vm.selectAllVehicles aria-label=all ng-change="vm.selectAll(\'vehicle\')">All</md-checkbox><md-checkbox ng-model=vm.deSelectAllVehicles aria-label=None ng-change="vm.deSelectAll(\'vehicle\')">None</md-checkbox></div></div></md-input-container><md-input-container class=container-margin><label>Start Time</label><input type=text id=start_time ng-model=vm.fenceReportObj.startTime></md-input-container><md-input-container class=container-margin><label>End Time</label><input type=text id=end_time ng-model=vm.fenceReportObj.endTime></md-input-container><!--<md-button class="md-accent" ng-click="vm.getHistoryReport()">Get Report</md-button>--> <a class="waves-effect waves-light btn" ng-click=vm.getHistoryReport()>Get Report</a><md-button class="md-fab md-mini my-tooltip pops" ng-disabled=vm.disableDownload ng-click=vm.downloadFile()><md-icon md-font-library=material-icons>file_download</md-icon><md-tooltip>Download</md-tooltip></md-button></div><div layout=row layout-align="end start"></div></div></div><div class=geoc-body><!--<div layout="row" layout-sm="column" layout-align="space-around" ng-show="vm.loadingHistoryData">--><!--<md-progress-circular md-mode="indeterminate"></md-progress-circular>--><!--</div>--><div class=progress ng-if=vm.loadingHistoryData><div class=indeterminate></div></div><div id=geo-table class=geo-table></div><span ng-show=vm.dataFound>No Data Found</span></div></div></div><!--</md-tab-body>--><script>$(document).ready(function () {\n        $(\'#start_time\').datetimepicker({\n            mask: \'9999-19-39 29:59\',\n            format: \'Y-m-d H:i\'\n        });\n\n        $(\'#end_time\').datetimepicker({\n            mask: \'9999/19/39 29:59\',\n            format: \'Y-m-d H:i\'\n        });\n    });</script>'),e.put("app/components/landingpage/dashboard/map/dialog/history.html",'<!--<md-tab-body>--><style>md-toolbar {\n        min-height: 20px;\n    }\n\n    .map-dialog {\n        padding: 0 !important\n    }\n\n    .map-dialog-content {\n        overflow: hidden;\n    }\n\n    .error-msg {\n        color: #f00;\n        font-size: 12px;\n        min-height: 20px;\n    }\n\n    md-toolbar.md-default-theme:not(.md-menu-toolbar), md-toolbar:not(.md-menu-toolbar) {\n        background: #d1e934;\n    }\n\n    .play-pause-btns {\n        background: #d1e934 !important;\n        color:#000;\n    }\n\n    .play-pause-btns i { color: #000 !important;}\n\n    .container-margin{margin-bottom: 0; padding:0; height:31px}\n\n    .btn {\n        background-color: #d1e934;\n        border: none;\n        color: white;\n        padding: 18px 12px;\n        text-align: center;\n        text-decoration: none;\n        display: inline-block;\n        font-size: 16px;\n        margin: 4px 2px;\n        width: 10px;\n        box-shadow: 1px 1px 8px 0px #FFF;\n        height: 10px;\n    }\n\n    .btn-img {\n        background: url(\'assets/images/play.png\') no-repeat;\n        width: 13px;\n    }\n\n    .btn:hover {\n        cursor: pointer;\n    }\n\n    .history-dialog .angular-google-map-container {\n        position: absolute;\n        left:0;\n        bottom:0;\n        height: auto!important;\n        top:72px;\n        right:0;\n        width:100%;\n    }\n\n    .md-button{\n        margin:6px 1px;\n    }\n\n    .md-button.md-fab.md-mini{\n        /*line-height:37px;*/\n        width:34px;\n        height:36px;\n    }\n\n    .icon-font {\n        font-size: 20px;\n        left: -1px;\n        position: relative;\n        top: 2px;\n    }\n\n    .errorMsg {\n        font-size: 16px;\n        background: rgba(255, 255, 255, 0.8);\n        color: red;\n        padding: 10px;\n    }</style><div class=downloadImage></div><script type=text/ng-template id=historyInfoWindow.html><div style="width:230px; height:62px; max-width:230px; min-width:230px; overflow:hidden; padding-top:5px;">\n        <table>\n            <tr>\n                <td><strong>End Time: </strong></td>\n                <td>{{parameter.data.gpstime | date : \'d MMM, h:mm a\'}}</td>\n            </tr>\n            <tr>\n                <td style="padding-right:5px;"><strong>Odometer: </strong></td>\n                <td>{{parameter.data.odometer}} km</td>\n            </tr>\n            <tr>\n                <td><strong>Speed: </strong></td>\n                <td>{{parameter.data.speed}} kmph</td>\n            </tr>\n            <tr>\n                <td><strong>Ignition: </strong></td>\n                <td>{{parameter.data.ignstatus}}</td>\n            </tr>\n        </table>\n    </div></script><div class=lefttoolbar ng-controller="GeofenceViewController as vm"><div class=ltb_item ng-repeat="item in vm.leftTB" ng-mouseenter="item.activeInt = 1" ng-mouseleave="item.activeInt = 0" ng-class="{\'ltb_item-line\':item.type == \'line\', \'active\': vm.fencesActive()}" ng-if=item.historymap><div class=ltbi_button ng-click=vm.buttonClick(item) ng-if="item.type == \'button\' || item.type == \'toggleButton\'" ng-class="{\'active\':item.data.active && item.type == \'toggleButton\',\'independ\':item.data.independent,\'hasChildren\':item.children }"><div class=ltbi_icon ng-if="item.hasOwnProperty(\'icon\')"><i class="fa {{item.icon}}" ng-if="item.iconType == \'fa\'" aria-hidden=true></i> <i ng-if="item.iconType == \'md\'" class=material-icons>{{item.icon}}</i> <img ng-if="item.iconType == \'png\' && item.data.active" ng-src={{item.icon}}.active.png> <img ng-if="item.iconType == \'png\' && !item.data.active" ng-src={{item.icon}}.png> <i ng-if="item.iconType == \'png\'" style="position: absolute; color: rgba(0,0,0,0)!important; width: 80%; height: 80%">a</i></div><div class=ltbi_name ng-if=item.name>{{item.name}} <span>{{item.description}}</span></div></div><div class=ltbi_cont ng-if=item.content ng-if="item.type == \'button\' || item.type == \'toggleButton\' "><md-input-container class=md-input-cont><label>Color</label><input type=text ng-model=color></md-input-container></div><!--Child Buttons--><div class=ltbi_loc ng-init="item.activeInt = 0" ng-if=item.children style="width: {{((item.children.length * 44) + 40 ) * item.activeInt }}px"><div ng-repeat="child in item.children" class=ltbil_item ng-click="vm.childClick(child,item.childType )" ng-class="{\'active\':child.id == vm.currentLocation}" ng-if="item.childType == \'location\'">{{child.notation}}</div><div class="ltbil_item childButton" ng-click=vm.buttonClick(child) ng-if="item.childType == \'button\'" ng-repeat="child in item.children" ng-class="{\'active\':child.data.active && child.type == \'toggleButton\',\'independ\':child.data.independent }"><div class=ltbi_icon ng-if="child.hasOwnProperty(\'icon\')"><i class="fa {{child.icon}}" ng-if="child.iconType == \'fa\'" aria-hidden=true></i> <i ng-if="child.iconType == \'md\'" class=material-icons>{{child.icon}}</i> <img ng-if="child.iconType == \'png\' && !child.data.active" ng-src={{child.icon}}.png> <img ng-if="child.iconType == \'png\' && child.data.active" ng-src={{child.icon}}.active.png> <i ng-if="child.iconType == \'png\'" style="position: absolute; color: rgba(0,0,0,0)!important; width: 80%; height: 80%">a</i></div><div class=ltbi_name ng-if=child.name>{{child.name}}<!--<span>{{child.description}}</span>--></div></div></div></div></div><div style="height: 100%" draggable=false><!--<span class="error-msg">{{errorMsg}}</span><br/>--><div layout=row layout-align="space-around center"><div layout=row class=input-fields layout-align="space-around center" flex><md-autocomplete class=hsitoryAutocomplete md-selected-item=vm.historyMap.selectedVehicle md-search-text=searchText md-items="item in getMatches(searchText)" md-item-text=item.rtgps.vehicleno><md-item-template><span>{{item.rtgps.vehicleno}}</span></md-item-template><md-not-found>No matches found.</md-not-found></md-autocomplete><md-input-container class=container-margin><label>Start Time</label><input type=text id=start_time ng-model=vm.historyMap.startTime></md-input-container><md-input-container class=container-margin><label>End Time</label><input type=text id=end_time ng-model=vm.historyMap.endTime></md-input-container><md-button class="md-accent md-raised" ng-click=vm.getHistory()>Get History</md-button><md-button class="md-accent md-raised" ng-click=vm.downloadScreenShot();>Print History</md-button></div><div layout=row layout-align="end start"></div></div><md-dialog-content class=map-dialog-content draggable=false ng-class="{\'expandedGraphs\':vm.traceControls.expandedGraphs == \'full\' && vm.gotData,\n                       \'expandedGraphsHalf\':vm.traceControls.expandedGraphs == \'half\' && vm.gotData}"><div class="md-dialog-content historyMap map-dialog history-dialog"><div id=history_map style=width:100%;height:500px></div><div class=tc_graphs><div class=tcg_buttons ng-show=vm.gotData><a class="tc_button tcb_abs waves-effect waves-light btn raised" ng-click="vm.toggleExpandedGraphs(\'close\')"><i class="fa fa-times" ng-if=vm.traceControls.expandedGraphs></i> <i class="fa fa-line-chart" ng-if=!vm.traceControls.expandedGraphs></i> </a><a class="tc_button tcb_abs waves-effect waves-light btn raised" ng-click="vm.toggleExpandedGraphs(\'toggle\')"><i class="fa fa-chevron-left" ng-if="vm.traceControls.expandedGraphs != \'full\'"></i> <i class="fa fa-chevron-right" ng-if="vm.traceControls.expandedGraphs == \'full\'"></i></a></div><div class="tc_graph-container noselect"><div class=tcg_item-half><div class=tcg_item><svg id=visualisation1 width=100% height=100%></svg></div><div class=tcg_item><svg id=visualisation2 width=100% height=100%></svg></div><div class=tcg_item><svg id=visualisation3 width=100% height=100%></svg></div></div></div></div><div class=tc_popup style=left:{{vm.getPopLeft()}} ng-show=vm.traceControls.timeline[vm.traceControls.current].alarmData>{{vm.traceControls.timeline[vm.traceControls.current].alarmData.alarmreason}}</div><div class=history-err ng-show=!vm.gotData><span ng-hide=vm.loadingData>{{vm.historyMap.errorMsg}}</span><div ng-show=vm.loadingData ng-class="{\'opacity_0\':!vm.loadingData}" class="preloader-wrapper active" style="position: absolute; left: 50%; top:50%; margin:-20px"><div class="spinner-layer spinner-red-only"><div class="circle-clipper left"><div class=circle></div></div><div class=gap-patch><div class=circle></div></div><div class="circle-clipper right"><div class=circle></div></div></div></div></div><div class="traceControls noselect" ng-class="{\'active\':vm.gotData}"><div class=tc_controls><a class="tc_button waves-effect waves-light btn raised" ng-click=vm.traceControls.togglePlay() ng-class="{\'active\':vm.traceControls.playing}"><i class="fa fa-play" ng-show=!vm.traceControls.playing></i> <i class="fa fa-pause" ng-show=vm.traceControls.playing></i> </a><!--<a class="waves-effect waves-light btn raised">a</a>--> <a class="tc_button waves-effect waves-light btn raised" ng-click=vm.traceControls.stepBackward()><i class="fa fa-minus"></i> </a><a class="tc_button waves-effect waves-light btn raised" ng-click=vm.traceControls.stepForward()><i class="fa fa-plus"></i></a><div class=tc_speedButton><a class="tc_button waves-effect waves-light btn raised" ng-click=vm.traceControls.decrementSpeed()><i class="fa fa-backward"></i></a><div class=tc_speedDisplay><span ng-show="vm.traceControls.speed == 0">1/16x</span> <span ng-show="vm.traceControls.speed == 1">1/8x</span> <span ng-show="vm.traceControls.speed == 2">1/4x</span> <span ng-show="vm.traceControls.speed == 3">1/2x</span> <span ng-show="vm.traceControls.speed == 4">1x</span> <span ng-show="vm.traceControls.speed == 5">2x</span> <span ng-show="vm.traceControls.speed == 6">4x</span> <span ng-show="vm.traceControls.speed == 7">8x</span> <span ng-show="vm.traceControls.speed == 8">16x</span></div><a class="tc_button waves-effect waves-light btn raised" ng-click=vm.traceControls.incrementSpeed()><i class="fa fa-forward"></i></a></div></div><div class=tc_panel><!--<div class="tc_pointer" ng-class="{\'active\':vm.traceControls.playing}"></div>--><div class="tcp_leftButton waves-effect waves-light btn raised" ng-click=vm.tcGraphs.seekGraph(0)><i class="fa fa-chevron-left"></i></div><div class="tcp_rightButton waves-effect waves-light btn raised" ng-click=vm.tcGraphs.seekGraph(1)><i class="fa fa-chevron-right"></i></div><div class=tcp_name>SPEED</div><div class=tpc_graphContainer><svg id=visualisation-parent width=100% height=100%></svg></div></div><div class=tc_info><table><tr class=time><td colspan=2>{{vm.getCurrentPos().gpstime | date : \'d MMM yy, h:mm:ss a\'}}</td></tr><tr><td>Ignition</td><td style=width:50%>{{ vm.getCurrentPos().ignstatus ? \'On\' : \'Off\' }}</td></tr><tr><td>Speed</td><td>{{vm.getCurrentPos().speed}} <span>kmph</span></td></tr><tr><td>Odometer</td><td>{{vm.getCurrentPos().odometer}} <span>km</span></td></tr><tr><td colspan=2>{{vm.traceControls.selectedVehicle.rtgps.meta.cartype}}</td></tr></table></div></div></div></md-dialog-content></div><div id=history_fence_infowindow layout=row ng-non-bindable flex><div layout=column id=historyFenceWindow ng-cloak><table><tbody><tr><th>Name:</th><td>{{vm.selectedFenceObj.info.name}}</td></tr><tr><th>Type:</th><td>{{vm.selectedFenceObj.info.tagdata.olafilter}}</td></tr></tbody></table></div></div><!--</md-tab-body>--><script>$(document).ready(function () {\n        $(\'#start_time\').datetimepicker({\n            mask: \'9999-19-39 29:59\',\n            format: \'Y-m-d H:i\'\n        });\n\n        $(\'#end_time\').datetimepicker({\n            mask: \'9999/19/39 29:59\',\n            format: \'Y-m-d H:i\'\n        });\n    });</script>'),e.put("app/components/landingpage/dashboard/map/dialog/historyTable.html",'<style>.error-msg {\n        color: #f00;\n        font-size: 12px;\n        min-height: 20px;\n    }\n\n\n    .geo-table{\n        height:85%;\n    }\n\n\n    table tbody tr td:nth-child(1),\n    table tbody tr  td:nth-child(2),\n    table tbody tr  td:nth-child(3),\n    table tbody tr  td:nth-child(4) ,\n    table tbody tr  td:nth-child(5)\n    {\n        text-align:center;\n    }\n\n    .google-visualization-table-tr-odd {\n        background-color: #eee;\n    }</style><div style="height: 100%"><!--<span>{{errorMsg}}</span><br/>--> <span class=error-msg>{{vm.historyMap.errorMsg}}</span><div layout=row layout-align="space-around center"><div layout=row class=input-fields layout-align="space-around center" flex><!--<md-input-container class="container-margin"  ng-show="vm.multiSelect">--><!--<label>Vehicle No</label>--><!--&lt;!&ndash;<md-select ng-model="vehicle" ng-model-options="{trackBy: \'$value.vehicleno\'}">&ndash;&gt;--><!--<md-select ng-model="vm.historyMap.selectedHistoryVehicle"--><!--ng-model-options="{trackBy: \'$value.deviceid\'}"--><!--&gt;--><!--<md-option--><!--ng-repeat="vehicle in vm.historyMap.dashboardMapObj.inMarkers | filter:vehicle.visible=\'true\' | orderBy:\'vehicleno\'"--><!--ng-value="vehicle">--><!--{{vehicle.vehicleno}}--><!--</md-option>--><!--</md-select>--><!--</md-input-container>--><md-input-container class=container-margin><label>Vehicle No</label><!--<md-select ng-model="vehicle" ng-model-options="{trackBy: \'$value.vehicleno\'}">--><md-select ng-model=vm.historyMap.selectedVehicle ng-model-options="{trackBy: \'$value.rtgps.deviceid\'}"><md-option ng-repeat="(key, vehicle) in vm.historyMap.vehiclesByPath" ng-value=vm.historyMap.vehiclesByPath[key] ng-if=vm.historyMap.vehiclesByPath[key].rtgps.meta.onroad>{{vm.historyMap.vehiclesByPath[key].rtgps.vehicleno}}</md-option></md-select></md-input-container><md-input-container class=container-margin><label>Start Time</label><input type=text id=start_time ng-model=vm.historyMap.startTime></md-input-container><md-input-container class=container-margin><label>End Time</label><input type=text id=end_time ng-model=vm.historyMap.endTime></md-input-container><a class="waves-effect waves-light btn" ng-click=getHistory()>Get History</a><!--<md-button class="md-accent" ng-click="getHistory()">Get History</md-button>--><md-button class="md-fab md-mini my-tooltip pops" ng-click=downloadFile() ng-disabled=vm.disableDownload><md-icon md-font-library=material-icons>file_download</md-icon></md-button></div><div layout=row layout-align="end start"></div></div><!--<div layout="row" layout-sm="column" layout-align="space-around" ng-hide="vm.historyMap.trace.path">--><!--<md-progress-circular md-mode="indeterminate"></md-progress-circular>--><!--</div>--><div class=progress ng-if="vm.showLoading && !vm.historyMap.errorMsg"><div class=indeterminate></div></div><div id=geo-table class=geo-table></div></div><script>$(document).ready(function () {\n        $(\'#start_time\').datetimepicker({\n            mask: \'9999-19-39 29:59\',\n            format: \'Y-m-d H:i\'\n        });\n\n        $(\'#end_time\').datetimepicker({\n            mask: \'9999/19/39 29:59\',\n            format: \'Y-m-d H:i\'\n        });\n    });</script>'),e.put("app/components/landingpage/management/settings/group/group_mgmt.html",'<!DOCTYPE html><style>.icar-new-group {\n        border: 1px solid #ccc;\n        display:none;\n    }\n    .icar-new-group.active {\n        display:block;\n    }</style><span ng-if=vm.currentGroupAsset>Group Name : {{vm.currentGroupAsset.name}}</span><br><md-button class=md-accent ng-show=vm.showBtn ng-click=vm.showNewGroupField()>Create Group</md-button><md-button class=md-accent ng-if=vm.currentGroupAsset.assignUser ng-click=vm.assignUsers(vm.currentGroupAsset)>Assign User</md-button><md-button class=md-accent ng-if=vm.currentGroupAsset.assignRole ng-click=vm.assignRoles(vm.currentGroupAsset)>Assign Role</md-button><div class="list list-inset icar-new-group" ng-class="{\'active\':vm.isdiplay}"><div class=error ng-show=vm.msg style=color:red>{{vm.msg}}</div><md-content layout=row><md-input-container flex><label>Enter Group Name</label><input type=text ng-model=vm.newGroup.name maxlength=10></md-input-container><md-button class="md-button md-accent" ng-click=vm.createGroup(); flex=20 ng-disabled=vm.groupBtnStatus>Create Group</md-button></md-content></div><br><script type=text/ng-template id=outside-panel-header.html><div class="md-title" style="display:inline;">{{myAsset.name}}</div>\n    <div class="md-summary"></div>\n    <md-expansion-panel-icon></md-expansion-panel-icon></script><script type=text/ng-template id=outside-panel-content.html><!-- <div class="md-title">{{myAsset.name}}</div> -->\n    <!--<icar-expanel ng-repeat="item in vm.vehicleinfo track by $index"-->\n    <!--details="item" schema="item.schema" layout></icar-expanel>-->\n    <div class="waves-effect waves-light btn ng-isolate-scope" ng-if="myAsset.assignUser"\n         ng-click="vm.assignUsers(myAsset)">\n        Assign Users\n    </div>\n    <a class="waves-effect waves-light btn ng-isolate-scope"\n       ng-if="myAsset.assignRole"\n       ng-click="vm.assignRoles(myAsset)">Assign Role</a></script><multi-list data=groupData></multi-list><!-- <ul class="collapsible popout" data-collapsible="accordion" watch>\n    <li ng-repeat="myAsset in vm.assets track by $index">\n        <div class="collapsible-header"><i class="{{single.icon}}"></i>\n            {{myAsset.name}}\n        </div>sers\n        <div class="collapsible-body">\n            <div ng-include="\'outside-panel-content.html\'"></div>\n        </div>\n    </li>\n</ul> --><md-expansion-panel-group class=expansion-panel md-component-id=vehicleGroup flex><md-expansion-panel md-component-id=$index ng-repeat="myAsset in vm.assets track by $index"><md-expansion-panel-collapsed ng-include="\'outside-panel-header.html\'"></md-expansion-panel-collapsed><md-expansion-panel-expanded><md-expansion-panel-header ng-click=$panel.collapse()><div style=display:inherit;width:100% ng-include="\'outside-panel-header.html\'"></div></md-expansion-panel-header><md-expansion-panel-content><div ng-include="\'outside-panel-content.html\'"></div></md-expansion-panel-content><!-- <md-expansion-panel-footer  md-no-sticky="true">\n            </md-expansion-panel-footer> --></md-expansion-panel-expanded></md-expansion-panel></md-expansion-panel-group>'),
e.put("app/components/landingpage/management/settings/device/device_mgmt.html",'<!DOCTYPE html><style>.icar-new-group {\n        border: 1px solid #ccc;\n        display:none;\n    }\n    .icar-new-group.active {\n        display:block;\n    }</style><span ng-if=vm.currentGroupAsset>Group Name : {{vm.currentGroupAsset.name}}</span><br><md-button class=md-accent ng-show=vm.showBtn ng-click=vm.showNewDeviceField()>Add Device</md-button><md-button class=md-accent ng-show=vm.showBtn>Bind to Vehicle</md-button><div class="list list-inset icar-new-group" ng-class="{\'active\':vm.isdiplay}"><div class=error ng-show=vm.msg style=color:red><span>{{vm.msg}}</span></div></div><br><script type=text/ng-template id=outside-panel-header.html><div class="md-title">{{myAsset.name}}</div>\n    <div class="md-summary"></div>\n    <md-expansion-panel-icon></md-expansion-panel-icon></script><script type=text/ng-template id=outside-panel-content.html><div class="md-title">{{myAsset.name}}</div>\n    <!--<icar-expanel ng-repeat="item in vm.vehicleinfo track by $index"-->\n    <!--details="item" schema="item.schema" layout></icar-expanel>--></script><md-expansion-panel-group md-component-id=vehicleGroup flex><md-expansion-panel md-component-id=$index ng-repeat="myAsset in vm.assets track by $index"><md-expansion-panel-collapsed ng-include="\'outside-panel-header.html\'"></md-expansion-panel-collapsed><md-expansion-panel-expanded><md-expansion-panel-header ng-click=$panel.collapse()><div style=display:inherit;width:100% ng-include="\'outside-panel-header.html\'"></div></md-expansion-panel-header><md-expansion-panel-content><div ng-include="\'outside-panel-content.html\'"></div></md-expansion-panel-content><md-expansion-panel-footer md-no-sticky=true></md-expansion-panel-footer></md-expansion-panel-expanded></md-expansion-panel></md-expansion-panel-group>'),e.put("app/components/landingpage/management/settings/role/role_mgmt.html",'<!DOCTYPE html><style>.icar-new-group {\n        border: 1px solid #ccc;\n        display:none;\n    }\n    .icar-new-group.active {\n        display:block;\n    }</style><span ng-if=vm.currentGroupAsset>Group Name : {{vm.currentGroupAsset.name}}</span><br><md-button class=md-accent ng-show=vm.showBtn ng-click=vm.showNewRoleField()>Create Role</md-button><md-button class=md-accent ng-if=vm.currentGroupAsset.assignGroup ng-click=vm.assignUsers(vm.currentGroupAsset)>Assign User</md-button><md-button class=md-accent ng-if=vm.currentGroupAsset.assignRole ng-click=vm.assignRoles(vm.currentGroupAsset)>Assign Group</md-button><div class="list list-inset icar-new-group" ng-class="{\'active\':vm.isdiplay}"><md-content layout=column><md-input-container flex><label>Enter Role Name</label><input type=text ng-model=vm.newRoleName></md-input-container><md-button class=md-accent ng-click=vm.createRole(); flex=66>Create Role</md-button></md-content></div><br><script type=text/ng-template id=outside-panel-header.html><div class="md-title">{{myAsset.name}}</div>\n    <div class="md-summary"></div>\n    <md-expansion-panel-icon></md-expansion-panel-icon></script><script type=text/ng-template id=outside-panel-content.html><div class="md-title">{{myAsset.name}}</div>\n\n    <a class="waves-effect waves-light btn ng-isolate-scope"\n       ng-if="myAsset.assignPermission"\n         ng-click="vm.addPermission(myAsset)">\n        Assign Permissions\n    </a></script><multi-list data=groupData></multi-list><md-expansion-panel-group md-component-id=vehicleGroup flex><md-expansion-panel md-component-id=$index ng-repeat="myAsset in vm.assets track by $index"><md-expansion-panel-collapsed ng-include="\'outside-panel-header.html\'"></md-expansion-panel-collapsed><md-expansion-panel-expanded><md-expansion-panel-header ng-click=$panel.collapse()><div style=display:inherit;width:100% ng-include="\'outside-panel-header.html\'"></div></md-expansion-panel-header><md-expansion-panel-content><div ng-include="\'outside-panel-content.html\'"></div></md-expansion-panel-content><md-expansion-panel-footer md-no-sticky=true></md-expansion-panel-footer></md-expansion-panel-expanded></md-expansion-panel></md-expansion-panel-group><div style="visibility: hidden"><div class=md-dialog-container id=myDialog></div></div>'),e.put("app/components/landingpage/management/settings/tabs/settings.html",'<!DOCTYPE html><div layout=column class=demo><!--<md-toolbar>--><!--<h2 class="md-toolbar-tools">--><!--<span>Settings</span>--><!--</h2>--><!--</md-toolbar>--><!--<md-tabs md-stretch-tabs md-selected="selectedIndex">--><!--&lt;!&ndash;<md-tab md-on-select="$state.transitionTo(home.management.vehicle, params1)"><md-tab-label>Label1</md-tab-label></md-tab>&ndash;&gt;--><!--&lt;!&ndash;<md-tab ui-sref="home.management.vehicle" label="vehicle"></md-tab>&ndash;&gt;--><!--<md-tab>--><!--<md-tab-label><span ui-sref="home.management.vehicle">vehicle</span></md-tab-label>--><!--</md-tab>--><!--<md-tab>--><!--<md-tab-label><span ui-sref="home.management.group">group</span></md-tab-label>--><!--</md-tab>--><!--<md-tab>--><!--<md-tab-label><span ui-sref="home.management.user">user</span></md-tab-label>--><!--</md-tab>--><!--</md-tabs>--><!--<md-tabs>--><!--<md-tab md-on-select="transitionTo(\'home.management.vehicle\')">--><!--<md-tab-label>Vehicle</md-tab-label>--><!--</md-tab>--><!--<md-tab md-on-select="transitionTo(\'home.management.group\')">--><!--<md-tab-label>Group</md-tab-label>--><!--</md-tab>--><!--<md-tab md-on-select="transitionTo(\'home.management.user\')">--><!--<md-tab-label>User</md-tab-label>--><!--</md-tab>--><!--</md-tabs>--><md-tabs md-selected=vm.selectedTab><md-tab ng-click=vm.tabClick(assetType) ng-repeat="assetType in vm.tabs"><md-tab-label>{{assetType}}</md-tab-label></md-tab></md-tabs><div id=mytabcontent ui-view=mgmttab flex></div><!--<div class="row">--><!--<div class="col s12">--><!--<ul class="tabs">--><!--<li class="tab col s3" ng-click="vm.tabClick(assetType)"--><!--ng-repeat="assetType in vm.tabs track by $index">--><!--<a href="#mytabcontent" ng-class="{true: \'active\', false:\'inactive\'}[vm.selectedTab == $index]">--><!--{{assetType}}--><!--</a>--><!--</li>--><!--</ul>--><!--</div>--><!--{{vm.selectedTab}}--><!--<div id="mytabcontent" class="col s12" ui-view="mgmttab" flex>Test 1</div>--><!--</div>--></div><script>$(document).ready(function(){\n\n\n    })</script>'),e.put("app/components/landingpage/management/settings/user/user_mgmt.html",'<!DOCTYPE html><style>.icar-new-group {\n        border: 1px solid #ccc;\n        display:none;\n    }\n    .icar-new-group.active {\n        display:block;\n    }</style><span ng-if=vm.currentGroupAsset>Group Name : {{vm.currentGroupAsset.name}}</span><br><md-button class=md-accent ng-show=vm.showBtn ng-click=vm.showNewUserField()>Create User</md-button><md-button class=md-accent ng-if=vm.currentGroupAsset.assignGroup ng-click=vm.assignUsers(vm.currentGroupAsset)>Assign Group</md-button><md-button class=md-accent ng-if=vm.currentGroupAsset.assignRole ng-click=vm.assignRoles(vm.currentGroupAsset)>Assign Role</md-button><div class="list list-inset icar-new-group" ng-class="{\'active\':vm.isdiplay}"><md-content layout=column><br><div class=error ng-show=vm.errorMsg style=color:red>{{vm.errorMsg}}</div><md-input-container flex><div layout=row><label>Username</label><input type=text ng-model=vm.newUser.name></div></md-input-container><md-input-container flex><div layout=row><label>Password</label><input type=password ng-model=vm.newUser.password autocomplete=off></div></md-input-container><md-input-container flex><div layout=row><label>Confirm Password</label><input type=password ng-model=vm.confirmPassword autocomplete=off></div></md-input-container><md-button class=md-accent ng-click=vm.createUser() flex=66>Create User</md-button></md-content></div><br><script type=text/ng-template id=outside-panel-header.html><div class="md-title">{{myAsset.name}}</div>\n    <div class="md-summary"></div>\n    <md-expansion-panel-icon></md-expansion-panel-icon></script><script type=text/ng-template id=outside-panel-content.html><div class="md-title">{{myAsset.name}}</div>\n    <!--<icar-expanel ng-repeat="item in vm.vehicleinfo track by $index"-->\n    <!--details="item" schema="item.schema" layout></icar-expanel>-->\n    <div class="waves-effect waves-light btn ng-isolate-scope" ng-if="myAsset.assignGroup"\n         ng-click="vm.assignGroups(myAsset)">\n        Assign Group\n    </div>\n    <a class="waves-effect waves-light btn ng-isolate-scope"\n       ng-if="myAsset.assignRole"\n       ng-click="vm.assignRoles(myAsset)">Assign Role</a></script><multi-list data=groupData></multi-list><style>.expansion-panel {\n        height: 500px;\n        overflow: auto;\n        display: block;\n    }</style><md-expansion-panel-group class=expansion-panel md-component-id=vehicleGroup flex><md-expansion-panel md-component-id=$index ng-repeat="myAsset in vm.assets track by $index"><md-expansion-panel-collapsed ng-include="\'outside-panel-header.html\'"></md-expansion-panel-collapsed><md-expansion-panel-expanded><md-expansion-panel-header ng-click=$panel.collapse()><div style=display:inherit;width:100% ng-include="\'outside-panel-header.html\'"></div></md-expansion-panel-header><md-expansion-panel-content><div ng-include="\'outside-panel-content.html\'"></div></md-expansion-panel-content><md-expansion-panel-footer md-no-sticky=true></md-expansion-panel-footer></md-expansion-panel-expanded></md-expansion-panel></md-expansion-panel-group>'),e.put("app/components/landingpage/management/settings/vehicle/vehicle_mgmt.html",'<!DOCTYPE html><style>.icar-new-group {\n        border: 1px solid #ccc;\n        display:none;\n    }\n    .icar-new-group.active {\n        display:block;\n    }</style><span ng-if=vm.currentGroupAsset>Group Name : {{vm.currentGroupAsset.name}}</span><br><md-button class=md-accent ng-show=vm.showBtn ng-click=vm.showNewVehicleField()>Add Vehicle</md-button><div class="list list-inset icar-new-group" ng-class="{\'active\':vm.isdiplay}"><div class=error ng-show=vm.msg style=color:red><span>{{vm.msg}}</span></div></div><br><script type=text/ng-template id=outside-panel-header.html><div class="md-title">{{myAsset.name}}</div>\n    <div class="md-summary"></div>\n    <md-expansion-panel-icon></md-expansion-panel-icon></script><script type=text/ng-template id=outside-panel-content.html><div class="md-title">{{myAsset.name}}</div>\n    <!--<icar-expanel ng-repeat="item in vm.vehicleinfo track by $index"-->\n    <!--details="item" schema="item.schema" layout></icar-expanel>--></script><style>.expansion-panel {\n        height: 500px;\n        overflow: auto;\n        display: block;\n    }</style><md-expansion-panel-group class=expansion-panel md-component-id=vehicleGroup flex><md-expansion-panel md-component-id=$index ng-repeat="myAsset in vm.assets track by $index"><md-expansion-panel-collapsed ng-include="\'outside-panel-header.html\'"></md-expansion-panel-collapsed><md-expansion-panel-expanded><md-expansion-panel-header ng-click=$panel.collapse()><div style=display:inherit;width:100% ng-include="\'outside-panel-header.html\'"></div></md-expansion-panel-header><md-expansion-panel-content><div ng-include="\'outside-panel-content.html\'"></div></md-expansion-panel-content><md-expansion-panel-footer md-no-sticky=true></md-expansion-panel-footer></md-expansion-panel-expanded></md-expansion-panel></md-expansion-panel-group>'),e.put("app/components/landingpage/dashboard/map/test/multimarker/map.html",'<!DOCTYPE html><div><ui-gmap-google-map center=vm.inMap.center zoom=vm.inMap.zoom draggable=true options=vm.options bounds=vm.inMap.bounds><!--<ui-gmap-marker coords="vm.marker.coords" options="vm.marker.options"--><!--events="vm.marker.events" idkey="vm.marker.id"></ui-gmap-marker>--><ui-gmap-markers models=vm.randomMarkers coords="\'self\'" icon="\'icon\'"></ui-gmap-markers></ui-gmap-google-map></div>'),e.put("app/components/landingpage/dashboard/map/test/singlemarker/map.html","<!DOCTYPE html><div><ui-gmap-google-map center=vm.inMap.center zoom=vm.inMap.zoom><ui-gmap-marker coords=vm.marker.coords options=vm.marker.options events=vm.marker.events idkey=vm.marker.id></ui-gmap-marker></ui-gmap-google-map></div>")}]);
//# sourceMappingURL=../maps/scripts/app-475311afec.js.map
